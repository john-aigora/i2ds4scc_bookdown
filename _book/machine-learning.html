<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Machine Learning | Data Science for Sensory and Consumer Scientists</title>
  <meta name="description" content="Open development of data science book for sensory and consumer scientists." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Machine Learning | Data Science for Sensory and Consumer Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Open development of data science book for sensory and consumer scientists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Machine Learning | Data Science for Sensory and Consumer Scientists" />
  
  <meta name="twitter:description" content="Open development of data science book for sensory and consumer scientists." />
  

<meta name="author" content="John Ennis, Julien Delarue, and Thierry Worch" />


<meta name="date" content="2022-03-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="value-delivery.html"/>
<link rel="next" href="text-analysis.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Sensory and Consumer Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-read-this-book"><i class="fa fa-check"></i>Who Should Read This Book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to Use This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="bienvenue.html"><a href="bienvenue.html"><i class="fa fa-check"></i><b>1</b> Bienvenue!</a>
<ul>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#why-data-science-for-sensory-and-consumer-science"><i class="fa fa-check"></i>Why Data Science for Sensory and Consumer Science?</a>
<ul>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#core-principles-in-sensory-and-consumer-science"><i class="fa fa-check"></i>Core principles in Sensory and Consumer Science</a></li>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#computational-sensory-science"><i class="fa fa-check"></i>Computational Sensory Science</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Apéritifs</b></span></li>
<li class="chapter" data-level="2" data-path="start-R.html"><a href="start-R.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="start-R.html"><a href="start-R.html#r"><i class="fa fa-check"></i><b>2.1</b> R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="start-R.html"><a href="start-R.html#why-learn-a-programming-language"><i class="fa fa-check"></i><b>2.1.1</b> Why Learn a Programming Language?</a></li>
<li class="chapter" data-level="2.1.2" data-path="start-R.html"><a href="start-R.html#why-r"><i class="fa fa-check"></i><b>2.1.2</b> Why R?</a></li>
<li class="chapter" data-level="2.1.3" data-path="start-R.html"><a href="start-R.html#steps-to-install-r"><i class="fa fa-check"></i><b>2.1.3</b> Steps to Install R</a></li>
<li class="chapter" data-level="2.1.4" data-path="start-R.html"><a href="start-R.html#introduction-to-the-magrittr-and-the-notion-of-pipes"><i class="fa fa-check"></i><b>2.1.4</b> Introduction to the <code>{magrittr}</code> and the notion of <em>pipes</em></a></li>
<li class="chapter" data-level="2.1.5" data-path="start-R.html"><a href="start-R.html#tips-on-how-to-read-this-book"><i class="fa fa-check"></i><b>2.1.5</b> Tips on <em>how to read this book?</em></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="start-R.html"><a href="start-R.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> RStudio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> Steps to Install RStudio</a></li>
<li class="chapter" data-level="2.2.2" data-path="start-R.html"><a href="start-R.html#create-a-local-project"><i class="fa fa-check"></i><b>2.2.2</b> Create a Local Project</a></li>
<li class="chapter" data-level="2.2.3" data-path="start-R.html"><a href="start-R.html#install-and-load-packages"><i class="fa fa-check"></i><b>2.2.3</b> Install and Load Packages</a></li>
<li class="chapter" data-level="2.2.4" data-path="start-R.html"><a href="start-R.html#run-sample-code"><i class="fa fa-check"></i><b>2.2.4</b> Run Sample Code</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="start-R.html"><a href="start-R.html#git-and-github"><i class="fa fa-check"></i><b>2.3</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="start-R.html"><a href="start-R.html#git"><i class="fa fa-check"></i><b>2.3.1</b> Git</a></li>
<li class="chapter" data-level="2.3.2" data-path="start-R.html"><a href="start-R.html#github"><i class="fa fa-check"></i><b>2.3.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="start-R.html"><a href="start-R.html#raw-material"><i class="fa fa-check"></i><b>2.4</b> RAW MATERIAL</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="start-R.html"><a href="start-R.html#principles"><i class="fa fa-check"></i><b>2.4.1</b> Principles</a></li>
<li class="chapter" data-level="2.4.2" data-path="start-R.html"><a href="start-R.html#tools"><i class="fa fa-check"></i><b>2.4.2</b> Tools</a></li>
<li class="chapter" data-level="2.4.3" data-path="start-R.html"><a href="start-R.html#documentation"><i class="fa fa-check"></i><b>2.4.3</b> Documentation</a></li>
<li class="chapter" data-level="2.4.4" data-path="start-R.html"><a href="start-R.html#version-control"><i class="fa fa-check"></i><b>2.4.4</b> Version control</a></li>
<li class="chapter" data-level="2.4.5" data-path="start-R.html"><a href="start-R.html#online-repositories-for-team-collaboration"><i class="fa fa-check"></i><b>2.4.5</b> Online repositories for team collaboration</a></li>
<li class="chapter" data-level="2.4.6" data-path="start-R.html"><a href="start-R.html#building-a-code-base"><i class="fa fa-check"></i><b>2.4.6</b> Building a code base</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Hors d’Oeuvres</b></span></li>
<li class="chapter" data-level="3" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>3</b> Why Data Science?</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-science.html"><a href="data-science.html#history-and-definition"><i class="fa fa-check"></i><b>3.1</b> History and Definition</a></li>
<li class="chapter" data-level="3.2" data-path="data-science.html"><a href="data-science.html#benefits-of-data-science"><i class="fa fa-check"></i><b>3.2</b> Benefits of Data Science</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-science.html"><a href="data-science.html#reproducible-research"><i class="fa fa-check"></i><b>3.2.1</b> Reproducible Research</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-science.html"><a href="data-science.html#standardized-reporting"><i class="fa fa-check"></i><b>3.2.2</b> Standardized Reporting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-science.html"><a href="data-science.html#data-scientific-workflow"><i class="fa fa-check"></i><b>3.3</b> Data Scientific Workflow</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-science.html"><a href="data-science.html#data-collection2"><i class="fa fa-check"></i><b>3.3.1</b> Data Collection</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-science.html"><a href="data-science.html#data-preparation"><i class="fa fa-check"></i><b>3.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-science.html"><a href="data-science.html#data-analysis2"><i class="fa fa-check"></i><b>3.3.3</b> Data Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-science.html"><a href="data-science.html#value-delivery2"><i class="fa fa-check"></i><b>3.3.4</b> Value Delivery</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-science.html"><a href="data-science.html#how-to-learn-data-science"><i class="fa fa-check"></i><b>3.4</b> How to Learn Data Science</a></li>
<li class="chapter" data-level="3.5" data-path="data-science.html"><a href="data-science.html#cautions-dont-that-everybody-does"><i class="fa fa-check"></i><b>3.5</b> Cautions: Don’t that Everybody Does</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manip.html"><a href="data-manip.html#chapter-overview"><i class="fa fa-check"></i><b>4.1</b> Chapter Overview</a></li>
<li class="chapter" data-level="4.2" data-path="data-manip.html"><a href="data-manip.html#why-manipulating-data"><i class="fa fa-check"></i><b>4.2</b> Why Manipulating Data?</a></li>
<li class="chapter" data-level="4.3" data-path="data-manip.html"><a href="data-manip.html#tidy-data"><i class="fa fa-check"></i><b>4.3</b> Tidying Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-manip.html"><a href="data-manip.html#simple-manipulations"><i class="fa fa-check"></i><b>4.3.1</b> Simple Manipulations</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-manip.html"><a href="data-manip.html#reshaping-the-data"><i class="fa fa-check"></i><b>4.3.2</b> Reshaping the Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-manip.html"><a href="data-manip.html#transformation-that-alters-the-data"><i class="fa fa-check"></i><b>4.3.3</b> Transformation that Alters the Data</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-manip.html"><a href="data-manip.html#combining-data-from-different-sources"><i class="fa fa-check"></i><b>4.3.4</b> Combining Data from Different Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-viz.html"><a href="data-viz.html#design-principles"><i class="fa fa-check"></i><b>5.1</b> Design Principles</a></li>
<li class="chapter" data-level="5.2" data-path="data-viz.html"><a href="data-viz.html#table-making"><i class="fa fa-check"></i><b>5.2</b> Table Making</a></li>
<li class="chapter" data-level="5.3" data-path="data-viz.html"><a href="data-viz.html#chart-making"><i class="fa fa-check"></i><b>5.3</b> Chart Making</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-viz.html"><a href="data-viz.html#philosophy-of-ggplot2"><i class="fa fa-check"></i><b>5.3.1</b> Philosophy of <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="data-viz.html"><a href="data-viz.html#getting-started-with-ggplot2"><i class="fa fa-check"></i><b>5.3.2</b> Getting started with <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="data-viz.html"><a href="data-viz.html#common-charts"><i class="fa fa-check"></i><b>5.3.3</b> Common Charts</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-viz.html"><a href="data-viz.html#miscealleneous"><i class="fa fa-check"></i><b>5.3.4</b> Miscealleneous</a></li>
<li class="chapter" data-level="5.3.5" data-path="data-viz.html"><a href="data-viz.html#few-tips-and-tricks"><i class="fa fa-check"></i><b>5.3.5</b> Few Tips and Tricks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="auto-report.html"><a href="auto-report.html"><i class="fa fa-check"></i><b>6</b> Automated Reporting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="auto-report.html"><a href="auto-report.html#what-and-why-automated-reporting"><i class="fa fa-check"></i><b>6.1</b> What and why Automated Reporting?</a></li>
<li class="chapter" data-level="6.2" data-path="auto-report.html"><a href="auto-report.html#integrating-reports-within-analyses-scripts"><i class="fa fa-check"></i><b>6.2</b> Integrating reports within analyses scripts</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="auto-report.html"><a href="auto-report.html#excel"><i class="fa fa-check"></i><b>6.2.1</b> Excel</a></li>
<li class="chapter" data-level="6.2.2" data-path="auto-report.html"><a href="auto-report.html#powerpoint"><i class="fa fa-check"></i><b>6.2.2</b> PowerPoint</a></li>
<li class="chapter" data-level="6.2.3" data-path="auto-report.html"><a href="auto-report.html#word"><i class="fa fa-check"></i><b>6.2.3</b> Word</a></li>
<li class="chapter" data-level="6.2.4" data-path="auto-report.html"><a href="auto-report.html#notes-on-applying-corporate-branding"><i class="fa fa-check"></i><b>6.2.4</b> Notes on applying corporate branding</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="auto-report.html"><a href="auto-report.html#integrating-analyses-scripts-within-your-reporting-tool"><i class="fa fa-check"></i><b>6.3</b> Integrating analyses scripts within your reporting tool</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="auto-report.html"><a href="auto-report.html#what-is-rmarkdown"><i class="fa fa-check"></i><b>6.3.1</b> What is <code>{rmarkdown}</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="auto-report.html"><a href="auto-report.html#starting-with-rmarkdown"><i class="fa fa-check"></i><b>6.3.2</b> Starting with {rmarkdown}</a></li>
<li class="chapter" data-level="6.3.3" data-path="auto-report.html"><a href="auto-report.html#rmarkdown-through-a-simple-example"><i class="fa fa-check"></i><b>6.3.3</b> <code>{rmarkdown}</code> through a Simple Example</a></li>
<li class="chapter" data-level="6.3.4" data-path="auto-report.html"><a href="auto-report.html#creating-a-document-using-knitr"><i class="fa fa-check"></i><b>6.3.4</b> Creating a document using <code>{knitr}</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="auto-report.html"><a href="auto-report.html#example-of-applications"><i class="fa fa-check"></i><b>6.3.5</b> Example of applications</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="auto-report.html"><a href="auto-report.html#to-go-further"><i class="fa fa-check"></i><b>6.4</b> To go further…</a></li>
</ul></li>
<li class="part"><span><b>Bon Appétit</b></span></li>
<li class="chapter" data-level="7" data-path="example-projects.html"><a href="example-projects.html"><i class="fa fa-check"></i><b>7</b> Example Project: The Biscuit Study</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example-projects.html"><a href="example-projects.html#products"><i class="fa fa-check"></i><b>7.1</b> Products</a></li>
<li class="chapter" data-level="7.2" data-path="example-projects.html"><a href="example-projects.html#consumer-test"><i class="fa fa-check"></i><b>7.2</b> Consumer test</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="example-projects.html"><a href="example-projects.html#participants"><i class="fa fa-check"></i><b>7.2.1</b> Participants</a></li>
<li class="chapter" data-level="7.2.2" data-path="example-projects.html"><a href="example-projects.html#test-design"><i class="fa fa-check"></i><b>7.2.2</b> Test design</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="example-projects.html"><a href="example-projects.html#sensory-descriptive-analysis-data"><i class="fa fa-check"></i><b>7.3</b> Sensory descriptive analysis data</a></li>
<li class="chapter" data-level="7.4" data-path="example-projects.html"><a href="example-projects.html#summary-of-the-datasets"><i class="fa fa-check"></i><b>7.4</b> Summary of the datasets</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>8</b> Data Collection</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-collection.html"><a href="data-collection.html#design-1"><i class="fa fa-check"></i><b>8.1</b> Design</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="data-collection.html"><a href="data-collection.html#designs-of-sensory-experiments"><i class="fa fa-check"></i><b>8.1.1</b> Designs of sensory experiments</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-collection.html"><a href="data-collection.html#product-related-designs"><i class="fa fa-check"></i><b>8.1.2</b> Product-related designs</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-collection.html"><a href="data-collection.html#execute-1"><i class="fa fa-check"></i><b>8.2</b> Execute</a></li>
<li class="chapter" data-level="8.3" data-path="data-collection.html"><a href="data-collection.html#data-import"><i class="fa fa-check"></i><b>8.3</b> Import</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-collection.html"><a href="data-collection.html#importing-structured-excel-file"><i class="fa fa-check"></i><b>8.3.1</b> Importing Structured Excel File</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-collection.html"><a href="data-collection.html#importing-unstructured-excel-file"><i class="fa fa-check"></i><b>8.3.2</b> Importing Unstructured Excel File</a></li>
<li class="chapter" data-level="8.3.3" data-path="data-collection.html"><a href="data-collection.html#import-mult-sheet"><i class="fa fa-check"></i><b>8.3.3</b> Importing Data Stored in Multiple Sheets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>9</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-prep.html"><a href="data-prep.html#inspect"><i class="fa fa-check"></i><b>9.1</b> Inspect</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-prep.html"><a href="data-prep.html#data-inspection"><i class="fa fa-check"></i><b>9.1.1</b> Data Inspection</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-prep.html"><a href="data-prep.html#design-inspection"><i class="fa fa-check"></i><b>9.1.2</b> Design Inspection</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-prep.html"><a href="data-prep.html#missing-data-inspection"><i class="fa fa-check"></i><b>9.1.3</b> Missing Data Inspection</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-prep.html"><a href="data-prep.html#checks-for-consistency-and-reliability"><i class="fa fa-check"></i><b>9.1.4</b> Checks for Consistency and Reliability</a></li>
<li class="chapter" data-level="9.1.5" data-path="data-prep.html"><a href="data-prep.html#preliminary-tables-and-charts"><i class="fa fa-check"></i><b>9.1.5</b> Preliminary Tables and Charts</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-prep.html"><a href="data-prep.html#clean"><i class="fa fa-check"></i><b>9.2</b> Clean</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-prep.html"><a href="data-prep.html#renaming-variables-1"><i class="fa fa-check"></i><b>9.2.1</b> Renaming Variables</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-prep.html"><a href="data-prep.html#handling-data-type"><i class="fa fa-check"></i><b>9.2.2</b> Handling Data Type</a></li>
<li class="chapter" data-level="9.2.3" data-path="data-prep.html"><a href="data-prep.html#converting-between-types"><i class="fa fa-check"></i><b>9.2.3</b> Converting between Types</a></li>
<li class="chapter" data-level="9.2.4" data-path="data-prep.html"><a href="data-prep.html#handling-missing-values"><i class="fa fa-check"></i><b>9.2.4</b> Handling Missing Values</a></li>
<li class="chapter" data-level="9.2.5" data-path="data-prep.html"><a href="data-prep.html#restructuring-data"><i class="fa fa-check"></i><b>9.2.5</b> Restructuring Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>10</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-analysis.html"><a href="data-analysis.html#chapter-overview-1"><i class="fa fa-check"></i><b>10.1</b> Chapter Overview</a></li>
<li class="chapter" data-level="10.2" data-path="data-analysis.html"><a href="data-analysis.html#sensory-data"><i class="fa fa-check"></i><b>10.2</b> Sensory Data</a></li>
<li class="chapter" data-level="10.3" data-path="data-analysis.html"><a href="data-analysis.html#demographic-and-questionnaire-data"><i class="fa fa-check"></i><b>10.3</b> Demographic and Questionnaire Data</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="data-analysis.html"><a href="data-analysis.html#demographic-data-frequency-and-proportion"><i class="fa fa-check"></i><b>10.3.1</b> Demographic Data: Frequency and Proportion</a></li>
<li class="chapter" data-level="10.3.2" data-path="data-analysis.html"><a href="data-analysis.html#personality-traits-and-eating-behavior-tfeq-data"><i class="fa fa-check"></i><b>10.3.2</b> Personality traits and eating behavior: TFEQ data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="data-analysis.html"><a href="data-analysis.html#consumer-data"><i class="fa fa-check"></i><b>10.4</b> Consumer Data</a></li>
<li class="chapter" data-level="10.5" data-path="data-analysis.html"><a href="data-analysis.html#combining-sensory-and-consumer-data"><i class="fa fa-check"></i><b>10.5</b> Combining Sensory and Consumer Data</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="data-analysis.html"><a href="data-analysis.html#internal-preference-mapping"><i class="fa fa-check"></i><b>10.5.1</b> Internal Preference Mapping</a></li>
<li class="chapter" data-level="10.5.2" data-path="data-analysis.html"><a href="data-analysis.html#consumers-clustering"><i class="fa fa-check"></i><b>10.5.2</b> Consumers Clustering</a></li>
<li class="chapter" data-level="10.5.3" data-path="data-analysis.html"><a href="data-analysis.html#drivers-of-liking"><i class="fa fa-check"></i><b>10.5.3</b> Drivers of Liking</a></li>
<li class="chapter" data-level="10.5.4" data-path="data-analysis.html"><a href="data-analysis.html#external-preference-mapping"><i class="fa fa-check"></i><b>10.5.4</b> External Preference Mapping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="value-delivery.html"><a href="value-delivery.html"><i class="fa fa-check"></i><b>11</b> Value Delivery</a>
<ul>
<li class="chapter" data-level="11.1" data-path="value-delivery.html"><a href="value-delivery.html#communicate2"><i class="fa fa-check"></i><b>11.1</b> Communicate</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="value-delivery.html"><a href="value-delivery.html#exploratory-explanatory-and-predictive-analysis"><i class="fa fa-check"></i><b>11.1.1</b> Exploratory, Explanatory and Predictive Analysis</a></li>
<li class="chapter" data-level="11.1.2" data-path="value-delivery.html"><a href="value-delivery.html#audience-awareness"><i class="fa fa-check"></i><b>11.1.2</b> Audience Awareness</a></li>
<li class="chapter" data-level="11.1.3" data-path="value-delivery.html"><a href="value-delivery.html#method-to-communicate"><i class="fa fa-check"></i><b>11.1.3</b> Method to Communicate</a></li>
<li class="chapter" data-level="11.1.4" data-path="value-delivery.html"><a href="value-delivery.html#storytelling"><i class="fa fa-check"></i><b>11.1.4</b> Storytelling</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="value-delivery.html"><a href="value-delivery.html#reformulate2"><i class="fa fa-check"></i><b>11.2</b> Reformulate</a></li>
<li class="chapter" data-level="11.3" data-path="value-delivery.html"><a href="value-delivery.html#to-go-further-1"><i class="fa fa-check"></i><b>11.3</b> To go further…</a></li>
</ul></li>
<li class="part"><span><b>Haute Cuisine</b></span></li>
<li class="chapter" data-level="12" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>12</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="machine-learning.html"><a href="machine-learning.html#methods-overview"><i class="fa fa-check"></i><b>12.1</b> Methods Overview</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="machine-learning.html"><a href="machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>12.1.1</b> Supervised learning</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="machine-learning.html"><a href="machine-learning.html#key-topics"><i class="fa fa-check"></i><b>12.2</b> Key Topics</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="machine-learning.html"><a href="machine-learning.html#model-validation"><i class="fa fa-check"></i><b>12.2.1</b> Model Validation</a></li>
<li class="chapter" data-level="12.2.2" data-path="machine-learning.html"><a href="machine-learning.html#interpretability"><i class="fa fa-check"></i><b>12.2.2</b> Interpretability</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="machine-learning.html"><a href="machine-learning.html#common-applications"><i class="fa fa-check"></i><b>12.3</b> Common Applications</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="machine-learning.html"><a href="machine-learning.html#predicting-sensory-profiles-from-instrumental-data"><i class="fa fa-check"></i><b>12.3.1</b> Predicting sensory profiles from instrumental data</a></li>
<li class="chapter" data-level="12.3.2" data-path="machine-learning.html"><a href="machine-learning.html#predicting-consumer-response-from-sensory-profiles"><i class="fa fa-check"></i><b>12.3.2</b> Predicting consumer response from sensory profiles</a></li>
<li class="chapter" data-level="12.3.3" data-path="machine-learning.html"><a href="machine-learning.html#characterizing-consumer-clusters"><i class="fa fa-check"></i><b>12.3.3</b> Characterizing consumer clusters</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="machine-learning.html"><a href="machine-learning.html#code"><i class="fa fa-check"></i><b>12.4</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>13</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="text-analysis.html"><a href="text-analysis.html#application-of-text-analysis-in-sensory-and-consumer-science"><i class="fa fa-check"></i><b>13.1</b> Application of Text Analysis in Sensory and Consumer Science</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="text-analysis.html"><a href="text-analysis.html#text-analysis-as-way-to-describe-products"><i class="fa fa-check"></i><b>13.1.1</b> Text analysis as way to describe products</a></li>
<li class="chapter" data-level="13.1.2" data-path="text-analysis.html"><a href="text-analysis.html#objectives-of-text-analysis"><i class="fa fa-check"></i><b>13.1.2</b> Objectives of Text Analysis</a></li>
<li class="chapter" data-level="13.1.3" data-path="text-analysis.html"><a href="text-analysis.html#warnings"><i class="fa fa-check"></i><b>13.1.3</b> Warnings</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="text-analysis.html"><a href="text-analysis.html#illustration-using-sorting-task-data"><i class="fa fa-check"></i><b>13.2</b> Illustration using Sorting Task Data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="text-analysis.html"><a href="text-analysis.html#data-pre-processing"><i class="fa fa-check"></i><b>13.2.1</b> Data Pre-processing</a></li>
<li class="chapter" data-level="13.2.2" data-path="text-analysis.html"><a href="text-analysis.html#introduction-to-working-with-strings-stringr"><i class="fa fa-check"></i><b>13.2.2</b> Introduction to working with strings (<code>{stringr}</code>)</a></li>
<li class="chapter" data-level="13.2.3" data-path="text-analysis.html"><a href="text-analysis.html#tokenization"><i class="fa fa-check"></i><b>13.2.3</b> Tokenization</a></li>
<li class="chapter" data-level="13.2.4" data-path="text-analysis.html"><a href="text-analysis.html#simple-transformation-lowercase"><i class="fa fa-check"></i><b>13.2.4</b> Simple Transformation (lowercase)</a></li>
<li class="chapter" data-level="13.2.5" data-path="text-analysis.html"><a href="text-analysis.html#stopwords"><i class="fa fa-check"></i><b>13.2.5</b> Stopwords</a></li>
<li class="chapter" data-level="13.2.6" data-path="text-analysis.html"><a href="text-analysis.html#stemming-and-lemmatization"><i class="fa fa-check"></i><b>13.2.6</b> Stemming and Lemmatization</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="text-analysis.html"><a href="text-analysis.html#text-analysis-1"><i class="fa fa-check"></i><b>13.3</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="text-analysis.html"><a href="text-analysis.html#raw-frequencies-and-visualization"><i class="fa fa-check"></i><b>13.3.1</b> Raw Frequencies and Visualization</a></li>
<li class="chapter" data-level="13.3.2" data-path="text-analysis.html"><a href="text-analysis.html#bigrams-n-grams"><i class="fa fa-check"></i><b>13.3.2</b> Bigrams, <em>n</em>-grams</a></li>
<li class="chapter" data-level="13.3.3" data-path="text-analysis.html"><a href="text-analysis.html#word-embedding"><i class="fa fa-check"></i><b>13.3.3</b> Word Embedding</a></li>
<li class="chapter" data-level="13.3.4" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>13.3.4</b> Sentiment Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="text-analysis.html"><a href="text-analysis.html#to-go-further-2"><i class="fa fa-check"></i><b>13.4</b> To go further…</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>14</b> Dashboards</a>
<ul>
<li class="chapter" data-level="14.1" data-path="dashboards.html"><a href="dashboards.html#objectives"><i class="fa fa-check"></i><b>14.1</b> Objectives</a></li>
<li class="chapter" data-level="14.2" data-path="dashboards.html"><a href="dashboards.html#introduction-to-shiny-through-an-example"><i class="fa fa-check"></i><b>14.2</b> Introduction to Shiny through an Example</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="dashboards.html"><a href="dashboards.html#what-is-a-shiny-application"><i class="fa fa-check"></i><b>14.2.1</b> What is a Shiny application?</a></li>
<li class="chapter" data-level="14.2.2" data-path="dashboards.html"><a href="dashboards.html#starting-with-shiny"><i class="fa fa-check"></i><b>14.2.2</b> Starting with Shiny</a></li>
<li class="chapter" data-level="14.2.3" data-path="dashboards.html"><a href="dashboards.html#deploying-the-application"><i class="fa fa-check"></i><b>14.2.3</b> Deploying the Application</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="dashboards.html"><a href="dashboards.html#to-go-further-3"><i class="fa fa-check"></i><b>14.3</b> To go further…</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="dashboards.html"><a href="dashboards.html#personalizing-and-tuning-your-application"><i class="fa fa-check"></i><b>14.3.1</b> Personalizing and Tuning your application</a></li>
<li class="chapter" data-level="14.3.2" data-path="dashboards.html"><a href="dashboards.html#upgrading-tables"><i class="fa fa-check"></i><b>14.3.2</b> Upgrading Tables</a></li>
<li class="chapter" data-level="14.3.3" data-path="dashboards.html"><a href="dashboards.html#building-dashboard"><i class="fa fa-check"></i><b>14.3.3</b> Building Dashboard</a></li>
<li class="chapter" data-level="14.3.4" data-path="dashboards.html"><a href="dashboards.html#interactive-graphics"><i class="fa fa-check"></i><b>14.3.4</b> Interactive Graphics</a></li>
<li class="chapter" data-level="14.3.5" data-path="dashboards.html"><a href="dashboards.html#interactive-documents"><i class="fa fa-check"></i><b>14.3.5</b> Interactive Documents</a></li>
<li class="chapter" data-level="14.3.6" data-path="dashboards.html"><a href="dashboards.html#documentation-and-books"><i class="fa fa-check"></i><b>14.3.6</b> Documentation and Books</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Digestifs</b></span></li>
<li class="chapter" data-level="15" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>15</b> Conclusion and Next Steps</a>
<ul>
<li class="chapter" data-level="15.1" data-path="next-steps.html"><a href="next-steps.html#sensory-analysis-in-r"><i class="fa fa-check"></i><b>15.1</b> Sensory Analysis in R</a></li>
<li class="chapter" data-level="15.2" data-path="next-steps.html"><a href="next-steps.html#other-recommended-resources"><i class="fa fa-check"></i><b>15.2</b> Other Recommended Resources</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="next-steps.html"><a href="next-steps.html#r-for-data-science"><i class="fa fa-check"></i><b>15.2.1</b> R for Data Science</a></li>
<li class="chapter" data-level="15.2.2" data-path="next-steps.html"><a href="next-steps.html#hands-on-machine-learning-with-r"><i class="fa fa-check"></i><b>15.2.2</b> Hands-On Machine Learning with R</a></li>
<li class="chapter" data-level="15.2.3" data-path="next-steps.html"><a href="next-steps.html#factoextra"><i class="fa fa-check"></i><b>15.2.3</b> FactoExtra</a></li>
<li class="chapter" data-level="15.2.4" data-path="next-steps.html"><a href="next-steps.html#r-graphics-cookbook"><i class="fa fa-check"></i><b>15.2.4</b> R Graphics Cookbook</a></li>
<li class="chapter" data-level="15.2.5" data-path="next-steps.html"><a href="next-steps.html#storytelling-with-data"><i class="fa fa-check"></i><b>15.2.5</b> Storytelling with Data</a></li>
<li class="chapter" data-level="15.2.6" data-path="next-steps.html"><a href="next-steps.html#text-mining-wtih-r"><i class="fa fa-check"></i><b>15.2.6</b> Text Mining wtih R</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="next-steps.html"><a href="next-steps.html#databases-graph-and-otherwise"><i class="fa fa-check"></i><b>15.3</b> Databases (Graph and Otherwise)</a></li>
<li class="chapter" data-level="15.4" data-path="next-steps.html"><a href="next-steps.html#python-and-other-languages"><i class="fa fa-check"></i><b>15.4</b> Python and Other Languages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Sensory and Consumer Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="machine-learning" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> Machine Learning</h1>
<div id="methods-overview" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Methods Overview</h2>
<!-- ### Unsupervised learning -->
<!-- #### Cluster analysis -->
<!-- Aim of cluster analysis is to discover in high-dimensional data groups of  -->
<!-- observations that are similar to each other in the group and significantly -->
<!-- different from the rest of observations. Common application in consumer science  -->
<!-- is to cluster consumers based on their taste preference to understand and target -->
<!-- specific segments. -->
<!-- #### Factor analysis -->
<!-- #### Principle components analysis -->
<!-- #### t-SNE -->
<!-- ### Semisupervised learning -->
<!-- #### PLS regression -->
<!-- #### Cluster Characterization -->
<div id="supervised-learning" class="section level3" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Supervised learning</h3>
<div id="regression" class="section level4" number="12.1.1.1">
<h4><span class="header-section-number">12.1.1.1</span> Regression</h4>
<p>Regression methods approximate the target variable<a href="#fn36" class="footnote-ref" id="fnref36"><sup>36</sup></a>
with (usually linear) combination of predictor variables.</p>
<p>There are multiple regression algorithms varying by type of data they can handle,
type of target variable and additional aspects like ability to perform
dimensionality reduction. We will take a walk through the ones most relevant for
sensory and consumer science.</p>
<div id="linear-regression" class="section level5" number="12.1.1.1.1">
<h5><span class="header-section-number">12.1.1.1.1</span> Linear regression</h5>
<p>The simplest and most popular variant is linear regression in which continuous
target variable is approximated as linear combination of predictors in a way that
minimizes sum of squared estimates of errors (SSE). It can be for example used to
predict consumer liking of a product based on it’s sensory profile, but user has
to keep in mind that linear regression can in some cases return value outside
reasonable range of target values. This can be addressed by capping predictions
to desired range. Functions in R to apply linear regression are: <code>lm()</code> and <code>glm()</code>
or <code>parsnip::linear_reg() %&gt;% parsnip::set_engine("lm")</code> when using <code>tidymodels</code> workflow.</p>
</div>
<div id="logistic-regression" class="section level5" number="12.1.1.1.2">
<h5><span class="header-section-number">12.1.1.1.2</span> Logistic regression</h5>
<p>Logistic regression is an algorithm which by use of logistic transformation allows
to apply the same approach as linear regression to cases with binary target variables.
It can be used in R with <code>glm(family = "binomial")</code> or
<code>parsnip::logistic_reg() %&gt;% parsnip::set_engine("glm")</code> when using <code>tidymodels</code> workflow.</p>
</div>
<div id="penalized-regression" class="section level5" number="12.1.1.1.3">
<h5><span class="header-section-number">12.1.1.1.3</span> Penalized regression</h5>
<p>It is often that the data we want to use for modeling have a lot of predictor
variables, possibly with lot of high correlations. In such cases linear/logistic
regression may become unstable and produce unreasonable predictions. This can be
addressed by use of so called penalized regression. It is a special case where
instead of minimizing pure error term, algorithm minimizes both error and regression
coefficients at the same time. This leads to more stable predictions.</p>
<p>There are three variations of penalized regression and all of them can be accessed
via function <code>glmnet::glmnet()</code> (<span class="math inline">\(\beta\)</span> is set of regression coefficients and
<span class="math inline">\(\lambda\)</span> is a parameter to be set by user or determined from cross-validation):</p>
<ul>
<li>Ridge regression (L2 penalty) minimizes <span class="math inline">\(SSE + \lambda \sum|\beta|^2\)</span> and drives
the coefficients to smaller values</li>
<li>Lasso regression (L1 penalty) <span class="math inline">\(SSE + \lambda \sum|\beta|\)</span> and forces some of the
coefficients to vanish what can be used for variable selection</li>
<li>Elastic-net regression is a combination of the two previous variants
<span class="math inline">\(SSE + \lambda_1 \sum|\beta| + \lambda_2 \sum|\beta|^2\)</span>.</li>
</ul>
<p>Penalized regression can be also runned in <code>tidymodels</code> workflow with
or <code>parsnip::linear_reg() %&gt;% parsnip::set_engine("glmnet")</code>.</p>
</div>
<div id="mars" class="section level5" number="12.1.1.1.4">
<h5><span class="header-section-number">12.1.1.1.4</span> MARS</h5>
<p>One limitation of all mentioned so far methods is that they assume linear relationship
between predictor and target variables. Multivariate adaptive regression spline (MARS)
addresses this by modeling nonlinearities with piecewise linear function. This
gives a nice balance between simplicity and ability to fit complex data, for example
<span class="math inline">\(\Lambda\)</span>-shaped once where there is a maximal point from which function decreases
in both directions. In R this model can be accesed via <code>earth::earth()</code> function.</p>
</div>
<div id="pls" class="section level5" number="12.1.1.1.5">
<h5><span class="header-section-number">12.1.1.1.5</span> PLS</h5>
<p>In case of multiple target variables one can apply partial least squares (PLS) regression
which, similarly to PCA looks for components that maximizes explained variance of
the predictors, but at the same time also maximizes their correlation to target variables.
PLS can be applied with <code>lm()</code> specifying multiple targets or in <code>tidymodels</code> workflow
with <code>plsmod::pls() %&gt;% parsnip::set_engine("mixOmics")</code>.</p>
</div>
</div>
<div id="k-nearest-neighbors" class="section level4" number="12.1.1.2">
<h4><span class="header-section-number">12.1.1.2</span> K-nearest neighbors</h4>
<p>A very simple, yet useful and robust algorithm that works for both numeric and nominal
target variables is K-nearest neighbors. The idea is that for every new observation
we want to predict the algorithms finds K closest points in training set and use
either their mean value (for numeric targets) or most frequent value (for nominal targets)
as prediction. This algorithm can be used with <code>kknn::kknn()</code> function or in <code>tidymodels</code> workflow
with <code>parsnip::nearest_neighbor() %&gt;% parsnip::set_engine("kknn")</code>.</p>
</div>
<div id="decision-trees" class="section level4" number="12.1.1.3">
<h4><span class="header-section-number">12.1.1.3</span> Decision trees</h4>
<p>Decision tree models the data by splitting the training set in smaller subsets
in a way that each split is done by a predictor variable so that it maximizes
the difference in target variable between the subsets. One important advantage
of decision trees is that they can model complex relationships and interactions
between predictors. To use decision tree in R one can use <code>rpart::rpart()</code> or
in <code>tidymodels</code> workflow with <code>parsnip::decision_tree() %&gt;% parsnip::set_engine("rpart")</code>.</p>
</div>
<div id="black-boxes" class="section level4" number="12.1.1.4">
<h4><span class="header-section-number">12.1.1.4</span> Black boxes</h4>
<p>So called black boxes are class of models that have too complex structure to directly
interpret relationship between predictor variables and a value predicted by the model.
Their advantage usually is ability to model more complicated data than in case of
interpretable models, but they have greater risk of overfitting (fitting to
noise in training data). Also, lack of clear interpretation may be not acceptable
in some business specific use cases. The later problem can be addressed by use of
explanation algorithms that will be discussed in later part of this chapter.</p>
<div id="random-forests" class="section level5" number="12.1.1.4.1">
<h5><span class="header-section-number">12.1.1.4.1</span> Random forests</h5>
<p>A random forest is a set of decision trees, each one trained on random subset
of observations and/or predictors. The final prediction is an average of individual
trees’ predictions. This way</p>
</div>
<div id="svms" class="section level5" number="12.1.1.4.2">
<h5><span class="header-section-number">12.1.1.4.2</span> SVMs</h5>
</div>
<div id="neural-networks" class="section level5" number="12.1.1.4.3">
<h5><span class="header-section-number">12.1.1.4.3</span> Neural networks</h5>
</div>
<div id="computer-vision" class="section level5" number="12.1.1.4.4">
<h5><span class="header-section-number">12.1.1.4.4</span> Computer vision</h5>
</div>
</div>
</div>
</div>
<div id="key-topics" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Key Topics</h2>
<div id="model-validation" class="section level3" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Model Validation</h3>
</div>
<div id="interpretability" class="section level3" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> Interpretability</h3>
<div id="lime" class="section level4" number="12.2.2.1">
<h4><span class="header-section-number">12.2.2.1</span> LIME</h4>
</div>
<div id="dalex" class="section level4" number="12.2.2.2">
<h4><span class="header-section-number">12.2.2.2</span> DALEX</h4>
</div>
<div id="iml" class="section level4" number="12.2.2.3">
<h4><span class="header-section-number">12.2.2.3</span> IML</h4>
</div>
</div>
</div>
<div id="common-applications" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Common Applications</h2>
<div id="predicting-sensory-profiles-from-instrumental-data" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Predicting sensory profiles from instrumental data</h3>
</div>
<div id="predicting-consumer-response-from-sensory-profiles" class="section level3" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Predicting consumer response from sensory profiles</h3>
</div>
<div id="characterizing-consumer-clusters" class="section level3" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Characterizing consumer clusters</h3>
</div>
</div>
<div id="code" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Code</h2>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="machine-learning.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load libraries ----------------------------------------------</span></span>
<span id="cb192-2"><a href="machine-learning.html#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="machine-learning.html#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c(&quot;tidyverse&quot;, &quot;tidymodels&quot;, &quot;rattle&quot;,</span></span>
<span id="cb192-4"><a href="machine-learning.html#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                    &quot;ggplot2&quot;, &quot; factoextra&quot;, &quot;ranger&quot;,</span></span>
<span id="cb192-5"><a href="machine-learning.html#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                    &quot;ggfortify&quot;, &quot;cluster&quot;))</span></span>
<span id="cb192-6"><a href="machine-learning.html#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb192-7"><a href="machine-learning.html#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># wine dataset</span></span>
<span id="cb192-8"><a href="machine-learning.html#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb192-9"><a href="machine-learning.html#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(factoextra)</span>
<span id="cb192-10"><a href="machine-learning.html#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb192-11"><a href="machine-learning.html#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb192-12"><a href="machine-learning.html#cb192-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify) <span class="co"># PCA visualization</span></span>
<span id="cb192-13"><a href="machine-learning.html#cb192-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb192-14"><a href="machine-learning.html#cb192-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-15"><a href="machine-learning.html#cb192-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data ----------------------------------------------</span></span>
<span id="cb192-16"><a href="machine-learning.html#cb192-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-17"><a href="machine-learning.html#cb192-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb192-18"><a href="machine-learning.html#cb192-18" aria-hidden="true" tabindex="-1"></a>wine_dataset <span class="ot">&lt;-</span> <span class="fu">tibble</span>(wine) <span class="sc">%&gt;%</span> </span>
<span id="cb192-19"><a href="machine-learning.html#cb192-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Type) <span class="co"># We drop type, to present possibility of generating the target using unsupervised methods</span></span>
<span id="cb192-20"><a href="machine-learning.html#cb192-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-21"><a href="machine-learning.html#cb192-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-22"><a href="machine-learning.html#cb192-22" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA without scaling -----------------------------------------------------</span></span>
<span id="cb192-23"><a href="machine-learning.html#cb192-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-24"><a href="machine-learning.html#cb192-24" aria-hidden="true" tabindex="-1"></a>pca_results_ws <span class="ot">&lt;-</span> wine_dataset <span class="sc">%&gt;%</span></span>
<span id="cb192-25"><a href="machine-learning.html#cb192-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prcomp</span>()</span>
<span id="cb192-26"><a href="machine-learning.html#cb192-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-27"><a href="machine-learning.html#cb192-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_results_ws)</span>
<span id="cb192-28"><a href="machine-learning.html#cb192-28" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca_results_ws)</span>
<span id="cb192-29"><a href="machine-learning.html#cb192-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-30"><a href="machine-learning.html#cb192-30" aria-hidden="true" tabindex="-1"></a>pca_ws_plot <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(pca_results_ws, <span class="at">data =</span> wine_dataset,,</span>
<span id="cb192-31"><a href="machine-learning.html#cb192-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">loadings =</span> <span class="cn">TRUE</span>, <span class="at">loadings.colour =</span> <span class="st">&#39;red&#39;</span>,</span>
<span id="cb192-32"><a href="machine-learning.html#cb192-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, <span class="at">loadings.label.size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb192-33"><a href="machine-learning.html#cb192-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb192-34"><a href="machine-learning.html#cb192-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-35"><a href="machine-learning.html#cb192-35" aria-hidden="true" tabindex="-1"></a>pca_ws_plot</span>
<span id="cb192-36"><a href="machine-learning.html#cb192-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(&quot;output/pca_without_scaling.jpg&quot;, pca_ws_plot)</span></span>
<span id="cb192-37"><a href="machine-learning.html#cb192-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-38"><a href="machine-learning.html#cb192-38" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling data + PCA -----------------------------------------------------------</span></span>
<span id="cb192-39"><a href="machine-learning.html#cb192-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-40"><a href="machine-learning.html#cb192-40" aria-hidden="true" tabindex="-1"></a>pca_results <span class="ot">&lt;-</span> wine_dataset <span class="sc">%&gt;%</span></span>
<span id="cb192-41"><a href="machine-learning.html#cb192-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prcomp</span>(<span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb192-42"><a href="machine-learning.html#cb192-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-43"><a href="machine-learning.html#cb192-43" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_results)</span>
<span id="cb192-44"><a href="machine-learning.html#cb192-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_results)</span>
<span id="cb192-45"><a href="machine-learning.html#cb192-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-46"><a href="machine-learning.html#cb192-46" aria-hidden="true" tabindex="-1"></a>pca_plot <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(pca_results, <span class="at">data =</span> wine_dataset,,</span>
<span id="cb192-47"><a href="machine-learning.html#cb192-47" aria-hidden="true" tabindex="-1"></a>               <span class="at">loadings =</span> <span class="cn">TRUE</span>, <span class="at">loadings.colour =</span> <span class="st">&#39;red&#39;</span>,</span>
<span id="cb192-48"><a href="machine-learning.html#cb192-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, <span class="at">loadings.label.size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb192-49"><a href="machine-learning.html#cb192-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb192-50"><a href="machine-learning.html#cb192-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-51"><a href="machine-learning.html#cb192-51" aria-hidden="true" tabindex="-1"></a>pca_plot</span>
<span id="cb192-52"><a href="machine-learning.html#cb192-52" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(&quot;output/pca.jpg&quot;, pca_plot)</span></span>
<span id="cb192-53"><a href="machine-learning.html#cb192-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-54"><a href="machine-learning.html#cb192-54" aria-hidden="true" tabindex="-1"></a>reduced_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pca_results<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb192-55"><a href="machine-learning.html#cb192-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
<span id="cb192-56"><a href="machine-learning.html#cb192-56" aria-hidden="true" tabindex="-1"></a><span class="co"># we can see that clustering should be easy</span></span>
<span id="cb192-57"><a href="machine-learning.html#cb192-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-58"><a href="machine-learning.html#cb192-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Clustering  -------------------------------------------------------------</span></span>
<span id="cb192-59"><a href="machine-learning.html#cb192-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-60"><a href="machine-learning.html#cb192-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding number of clusters - Elbow method</span></span>
<span id="cb192-61"><a href="machine-learning.html#cb192-61" aria-hidden="true" tabindex="-1"></a>wcss <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb192-62"><a href="machine-learning.html#cb192-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb192-63"><a href="machine-learning.html#cb192-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-64"><a href="machine-learning.html#cb192-64" aria-hidden="true" tabindex="-1"></a>  wcss <span class="ot">&lt;-</span> wcss <span class="sc">%&gt;%</span> </span>
<span id="cb192-65"><a href="machine-learning.html#cb192-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">n_clusters =</span> i,</span>
<span id="cb192-66"><a href="machine-learning.html#cb192-66" aria-hidden="true" tabindex="-1"></a>                     <span class="at">wcss =</span> <span class="fu">kmeans</span>(reduced_dataset, i)<span class="sc">$</span>tot.withinss))</span>
<span id="cb192-67"><a href="machine-learning.html#cb192-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-68"><a href="machine-learning.html#cb192-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-69"><a href="machine-learning.html#cb192-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-70"><a href="machine-learning.html#cb192-70" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>wcss, <span class="fu">aes</span>(<span class="at">x=</span>n_clusters, <span class="at">y=</span>wcss, <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb192-71"><a href="machine-learning.html#cb192-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb192-72"><a href="machine-learning.html#cb192-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="at">color=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb192-73"><a href="machine-learning.html#cb192-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb192-74"><a href="machine-learning.html#cb192-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Number of clusters&quot;</span>) <span class="sc">+</span></span>
<span id="cb192-75"><a href="machine-learning.html#cb192-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total within-cluster sum of squares&quot;</span>)</span>
<span id="cb192-76"><a href="machine-learning.html#cb192-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-77"><a href="machine-learning.html#cb192-77" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(&quot;output/n_clusters_decision_Elbow.jpg&quot;)</span></span>
<span id="cb192-78"><a href="machine-learning.html#cb192-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-79"><a href="machine-learning.html#cb192-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding number of clusters - silhouette method</span></span>
<span id="cb192-80"><a href="machine-learning.html#cb192-80" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(reduced_dataset, kmeans, <span class="at">method =</span> <span class="st">&quot;silhouette&quot;</span>)</span>
<span id="cb192-81"><a href="machine-learning.html#cb192-81" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(&quot;output/n_clusters_decision_silhouette.jpg&quot;)</span></span>
<span id="cb192-82"><a href="machine-learning.html#cb192-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-83"><a href="machine-learning.html#cb192-83" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 clusters seems to be good fit</span></span>
<span id="cb192-84"><a href="machine-learning.html#cb192-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-85"><a href="machine-learning.html#cb192-85" aria-hidden="true" tabindex="-1"></a>km_dw <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(reduced_dataset, <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">20</span>)</span>
<span id="cb192-86"><a href="machine-learning.html#cb192-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-87"><a href="machine-learning.html#cb192-87" aria-hidden="true" tabindex="-1"></a>km_dw</span>
<span id="cb192-88"><a href="machine-learning.html#cb192-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-89"><a href="machine-learning.html#cb192-89" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(</span>
<span id="cb192-90"><a href="machine-learning.html#cb192-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">data =</span> reduced_dataset, <span class="at">cluster =</span> km_dw<span class="sc">$</span>cluster),</span>
<span id="cb192-91"><a href="machine-learning.html#cb192-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.type =</span> <span class="st">&quot;norm&quot;</span>,</span>
<span id="cb192-92"><a href="machine-learning.html#cb192-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb192-93"><a href="machine-learning.html#cb192-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">stand =</span> <span class="cn">FALSE</span></span>
<span id="cb192-94"><a href="machine-learning.html#cb192-94" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb192-95"><a href="machine-learning.html#cb192-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-96"><a href="machine-learning.html#cb192-96" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(&quot;output/clustered_data.jpg&quot;)</span></span>
<span id="cb192-97"><a href="machine-learning.html#cb192-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-98"><a href="machine-learning.html#cb192-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification ----------------------------------------------------------</span></span>
<span id="cb192-99"><a href="machine-learning.html#cb192-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-100"><a href="machine-learning.html#cb192-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset preparation</span></span>
<span id="cb192-101"><a href="machine-learning.html#cb192-101" aria-hidden="true" tabindex="-1"></a>wine_classification_dataset <span class="ot">&lt;-</span> reduced_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb192-102"><a href="machine-learning.html#cb192-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">tibble</span>(<span class="at">Wine_type =</span> km_dw<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span> <span class="co"># Our classification label is the clustering output</span></span>
<span id="cb192-103"><a href="machine-learning.html#cb192-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Wine_type =</span> <span class="fu">as.factor</span>(Wine_type))</span>
<span id="cb192-104"><a href="machine-learning.html#cb192-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-105"><a href="machine-learning.html#cb192-105" aria-hidden="true" tabindex="-1"></a>initial_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(<span class="at">data =</span> wine_classification_dataset, <span class="at">strata =</span> <span class="st">&quot;Wine_type&quot;</span>, <span class="at">prop =</span> <span class="fl">0.7</span>)</span>
<span id="cb192-106"><a href="machine-learning.html#cb192-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-107"><a href="machine-learning.html#cb192-107" aria-hidden="true" tabindex="-1"></a>wine_train <span class="ot">&lt;-</span> <span class="fu">training</span>(initial_split)</span>
<span id="cb192-108"><a href="machine-learning.html#cb192-108" aria-hidden="true" tabindex="-1"></a>wine_testing <span class="ot">&lt;-</span> <span class="fu">testing</span>(initial_split)</span>
<span id="cb192-109"><a href="machine-learning.html#cb192-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-110"><a href="machine-learning.html#cb192-110" aria-hidden="true" tabindex="-1"></a>wine_cv <span class="ot">&lt;-</span> wine_train <span class="sc">%&gt;%</span> <span class="fu">vfold_cv</span>(<span class="dv">5</span>,<span class="at">strata =</span> Wine_type)</span>
<span id="cb192-111"><a href="machine-learning.html#cb192-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-112"><a href="machine-learning.html#cb192-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Random forest model definition</span></span>
<span id="cb192-113"><a href="machine-learning.html#cb192-113" aria-hidden="true" tabindex="-1"></a>model_recipe <span class="ot">&lt;-</span> wine_train <span class="sc">%&gt;%</span> </span>
<span id="cb192-114"><a href="machine-learning.html#cb192-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(Wine_type <span class="sc">~</span> .)</span>
<span id="cb192-115"><a href="machine-learning.html#cb192-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-116"><a href="machine-learning.html#cb192-116" aria-hidden="true" tabindex="-1"></a>rf_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(</span>
<span id="cb192-117"><a href="machine-learning.html#cb192-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">tune</span>(),</span>
<span id="cb192-118"><a href="machine-learning.html#cb192-118" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees =</span> <span class="fu">tune</span>(),</span>
<span id="cb192-119"><a href="machine-learning.html#cb192-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb192-120"><a href="machine-learning.html#cb192-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb192-121"><a href="machine-learning.html#cb192-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&quot;ranger&quot;</span>)</span>
<span id="cb192-122"><a href="machine-learning.html#cb192-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-123"><a href="machine-learning.html#cb192-123" aria-hidden="true" tabindex="-1"></a>rf_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-124"><a href="machine-learning.html#cb192-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(model_recipe) <span class="sc">%&gt;%</span> </span>
<span id="cb192-125"><a href="machine-learning.html#cb192-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rf_spec)</span>
<span id="cb192-126"><a href="machine-learning.html#cb192-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-127"><a href="machine-learning.html#cb192-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-128"><a href="machine-learning.html#cb192-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Best parameters searching</span></span>
<span id="cb192-129"><a href="machine-learning.html#cb192-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-130"><a href="machine-learning.html#cb192-130" aria-hidden="true" tabindex="-1"></a>params_grid <span class="ot">&lt;-</span> rf_spec <span class="sc">%&gt;%</span></span>
<span id="cb192-131"><a href="machine-learning.html#cb192-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-132"><a href="machine-learning.html#cb192-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(<span class="at">mtry =</span> <span class="fu">mtry</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)),</span>
<span id="cb192-133"><a href="machine-learning.html#cb192-133" aria-hidden="true" tabindex="-1"></a>         <span class="at">trees =</span> <span class="fu">trees</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">200</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb192-134"><a href="machine-learning.html#cb192-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_regular</span>(<span class="at">levels =</span> <span class="dv">5</span>)</span>
<span id="cb192-135"><a href="machine-learning.html#cb192-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-136"><a href="machine-learning.html#cb192-136" aria-hidden="true" tabindex="-1"></a>tuning <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb192-137"><a href="machine-learning.html#cb192-137" aria-hidden="true" tabindex="-1"></a>  rf_wf,</span>
<span id="cb192-138"><a href="machine-learning.html#cb192-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> wine_cv,</span>
<span id="cb192-139"><a href="machine-learning.html#cb192-139" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> params_grid</span>
<span id="cb192-140"><a href="machine-learning.html#cb192-140" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb192-141"><a href="machine-learning.html#cb192-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-142"><a href="machine-learning.html#cb192-142" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tuning)</span>
<span id="cb192-143"><a href="machine-learning.html#cb192-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-144"><a href="machine-learning.html#cb192-144" aria-hidden="true" tabindex="-1"></a>params_best <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tuning, <span class="st">&quot;roc_auc&quot;</span>)</span>
<span id="cb192-145"><a href="machine-learning.html#cb192-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-146"><a href="machine-learning.html#cb192-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Finalize model </span></span>
<span id="cb192-147"><a href="machine-learning.html#cb192-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-148"><a href="machine-learning.html#cb192-148" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> rf_wf <span class="sc">%&gt;%</span></span>
<span id="cb192-149"><a href="machine-learning.html#cb192-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(params_best) <span class="sc">%&gt;%</span></span>
<span id="cb192-150"><a href="machine-learning.html#cb192-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(wine_train)</span>
<span id="cb192-151"><a href="machine-learning.html#cb192-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-152"><a href="machine-learning.html#cb192-152" aria-hidden="true" tabindex="-1"></a>validation_data_pred <span class="ot">&lt;-</span> wine_testing <span class="sc">%&gt;%</span></span>
<span id="cb192-153"><a href="machine-learning.html#cb192-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(final_model, .))</span>
<span id="cb192-154"><a href="machine-learning.html#cb192-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-155"><a href="machine-learning.html#cb192-155" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">conf_mat</span>(validation_data_pred, Wine_type, .pred_class)</span>
<span id="cb192-156"><a href="machine-learning.html#cb192-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-157"><a href="machine-learning.html#cb192-157" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(cm, <span class="at">type =</span> <span class="st">&quot;heatmap&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="machine-learning.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb193-2"><a href="machine-learning.html#cb193-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-3"><a href="machine-learning.html#cb193-3" aria-hidden="true" tabindex="-1"></a>n_rows <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb193-4"><a href="machine-learning.html#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="machine-learning.html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">set.seed</span>(<span class="dv">1</span>),</span>
<span id="cb193-6"><a href="machine-learning.html#cb193-6" aria-hidden="true" tabindex="-1"></a>     data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb193-7"><a href="machine-learning.html#cb193-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">id =</span> <span class="fu">sprintf</span>(<span class="st">&quot;product_%d&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_rows)</span>
<span id="cb193-8"><a href="machine-learning.html#cb193-8" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">%&gt;%</span></span>
<span id="cb193-9"><a href="machine-learning.html#cb193-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(</span>
<span id="cb193-10"><a href="machine-learning.html#cb193-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">sensory_1 =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb193-11"><a href="machine-learning.html#cb193-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">sensory_2 =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">4</span>, <span class="dv">8</span>),</span>
<span id="cb193-12"><a href="machine-learning.html#cb193-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">sensory_3 =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">10</span>, <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">6</span>, <span class="fl">1.5</span>))),</span>
<span id="cb193-13"><a href="machine-learning.html#cb193-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">sensory_4 =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb193-14"><a href="machine-learning.html#cb193-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">sensory_5 =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb193-15"><a href="machine-learning.html#cb193-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">sensory_6 =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(<span class="dv">10</span>, <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">3</span>, <span class="dv">1</span>))),</span>
<span id="cb193-16"><a href="machine-learning.html#cb193-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">sensory_7 =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb193-17"><a href="machine-learning.html#cb193-17" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">%&gt;%</span></span>
<span id="cb193-18"><a href="machine-learning.html#cb193-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(</span>
<span id="cb193-19"><a href="machine-learning.html#cb193-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">liking =</span> </span>
<span id="cb193-20"><a href="machine-learning.html#cb193-20" aria-hidden="true" tabindex="-1"></a>           <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">abs</span>(sensory_1<span class="fl">-2.5</span>)</span>
<span id="cb193-21"><a href="machine-learning.html#cb193-21" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span> <span class="fl">0.6</span> <span class="sc">*</span> sensory_2</span>
<span id="cb193-22"><a href="machine-learning.html#cb193-22" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> sensory_3</span>
<span id="cb193-23"><a href="machine-learning.html#cb193-23" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">abs</span>(sensory_4<span class="dv">-1</span>)</span>
<span id="cb193-24"><a href="machine-learning.html#cb193-24" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> sensory_5</span>
<span id="cb193-25"><a href="machine-learning.html#cb193-25" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> sensory_6</span>
<span id="cb193-26"><a href="machine-learning.html#cb193-26" aria-hidden="true" tabindex="-1"></a>         <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> sensory_7</span>
<span id="cb193-27"><a href="machine-learning.html#cb193-27" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">%&gt;%</span></span>
<span id="cb193-28"><a href="machine-learning.html#cb193-28" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(<span class="at">liking =</span> <span class="fu">pmin</span>(<span class="fl">9.74</span>, <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">1</span>, <span class="fl">0.1</span>) <span class="sc">*</span> liking))</span>
<span id="cb193-29"><a href="machine-learning.html#cb193-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb193-30"><a href="machine-learning.html#cb193-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-31"><a href="machine-learning.html#cb193-31" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span>
<span id="cb193-32"><a href="machine-learning.html#cb193-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-33"><a href="machine-learning.html#cb193-33" aria-hidden="true" tabindex="-1"></a><span class="co"># write_rds(data, &quot;data/regression_data.rds&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="machine-learning.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tutorial content:</span></span>
<span id="cb194-2"><a href="machine-learning.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   1. Split data</span></span>
<span id="cb194-3"><a href="machine-learning.html#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   2. Define model</span></span>
<span id="cb194-4"><a href="machine-learning.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   3. Tune hyperparameters</span></span>
<span id="cb194-5"><a href="machine-learning.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   4. Visualize results</span></span>
<span id="cb194-6"><a href="machine-learning.html#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   5. Explore model with DALEX and modelStudio</span></span>
<span id="cb194-7"><a href="machine-learning.html#cb194-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-8"><a href="machine-learning.html#cb194-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-9"><a href="machine-learning.html#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load libraries ----------------------------------------------</span></span>
<span id="cb194-10"><a href="machine-learning.html#cb194-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-11"><a href="machine-learning.html#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c(&quot;tidyverse&quot;, &quot;tidymodels&quot;, &quot;remotes&quot;,</span></span>
<span id="cb194-12"><a href="machine-learning.html#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                    &quot;DALEXtra&quot;, &quot; modelStudio&quot;, &quot;r2d3&quot;))</span></span>
<span id="cb194-13"><a href="machine-learning.html#cb194-13" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;aigorahub/aigoraOpen&quot;)</span></span>
<span id="cb194-14"><a href="machine-learning.html#cb194-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb194-15"><a href="machine-learning.html#cb194-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb194-16"><a href="machine-learning.html#cb194-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aigoraOpen)</span>
<span id="cb194-17"><a href="machine-learning.html#cb194-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-18"><a href="machine-learning.html#cb194-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-19"><a href="machine-learning.html#cb194-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data ---------------------------------------------------------------</span></span>
<span id="cb194-20"><a href="machine-learning.html#cb194-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-21"><a href="machine-learning.html#cb194-21" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- read_rds(&quot;data/regression_data.rds&quot;)</span></span>
<span id="cb194-22"><a href="machine-learning.html#cb194-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-23"><a href="machine-learning.html#cb194-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb194-24"><a href="machine-learning.html#cb194-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-25"><a href="machine-learning.html#cb194-25" aria-hidden="true" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(data)</span>
<span id="cb194-26"><a href="machine-learning.html#cb194-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-27"><a href="machine-learning.html#cb194-27" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split)</span>
<span id="cb194-28"><a href="machine-learning.html#cb194-28" aria-hidden="true" tabindex="-1"></a>validation_data <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split)</span>
<span id="cb194-29"><a href="machine-learning.html#cb194-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-30"><a href="machine-learning.html#cb194-30" aria-hidden="true" tabindex="-1"></a>resampling <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(training_data, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb194-31"><a href="machine-learning.html#cb194-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-32"><a href="machine-learning.html#cb194-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model ------------------------------------------------------------</span></span>
<span id="cb194-33"><a href="machine-learning.html#cb194-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-34"><a href="machine-learning.html#cb194-34" aria-hidden="true" tabindex="-1"></a>model_recipe <span class="ot">&lt;-</span> training_data <span class="sc">%&gt;%</span></span>
<span id="cb194-35"><a href="machine-learning.html#cb194-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id) <span class="sc">%&gt;%</span> <span class="co"># id shouldn&#39;t be used by the model</span></span>
<span id="cb194-36"><a href="machine-learning.html#cb194-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(liking <span class="sc">~</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb194-37"><a href="machine-learning.html#cb194-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_earth</span>(<span class="fu">all_predictors</span>(), <span class="at">outcome =</span> <span class="st">&quot;liking&quot;</span>)</span>
<span id="cb194-38"><a href="machine-learning.html#cb194-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-39"><a href="machine-learning.html#cb194-39" aria-hidden="true" tabindex="-1"></a>model_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(</span>
<span id="cb194-40"><a href="machine-learning.html#cb194-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">penalty =</span> <span class="fu">tune</span>(),</span>
<span id="cb194-41"><a href="machine-learning.html#cb194-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="fu">tune</span>()</span>
<span id="cb194-42"><a href="machine-learning.html#cb194-42" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb194-43"><a href="machine-learning.html#cb194-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-44"><a href="machine-learning.html#cb194-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb194-45"><a href="machine-learning.html#cb194-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-46"><a href="machine-learning.html#cb194-46" aria-hidden="true" tabindex="-1"></a>model_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb194-47"><a href="machine-learning.html#cb194-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(model_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb194-48"><a href="machine-learning.html#cb194-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(model_spec)</span>
<span id="cb194-49"><a href="machine-learning.html#cb194-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-50"><a href="machine-learning.html#cb194-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-51"><a href="machine-learning.html#cb194-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Tune model hyperparameters (grid search) ---------------------------------</span></span>
<span id="cb194-52"><a href="machine-learning.html#cb194-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-53"><a href="machine-learning.html#cb194-53" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb194-54"><a href="machine-learning.html#cb194-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-55"><a href="machine-learning.html#cb194-55" aria-hidden="true" tabindex="-1"></a>params_grid <span class="ot">&lt;-</span> model_spec <span class="sc">%&gt;%</span></span>
<span id="cb194-56"><a href="machine-learning.html#cb194-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">%&gt;%</span></span>
<span id="cb194-57"><a href="machine-learning.html#cb194-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_regular</span>(<span class="at">levels =</span> <span class="dv">10</span>)</span>
<span id="cb194-58"><a href="machine-learning.html#cb194-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-59"><a href="machine-learning.html#cb194-59" aria-hidden="true" tabindex="-1"></a>tuning <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb194-60"><a href="machine-learning.html#cb194-60" aria-hidden="true" tabindex="-1"></a>  model_workflow,</span>
<span id="cb194-61"><a href="machine-learning.html#cb194-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> resampling,</span>
<span id="cb194-62"><a href="machine-learning.html#cb194-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> params_grid</span>
<span id="cb194-63"><a href="machine-learning.html#cb194-63" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-64"><a href="machine-learning.html#cb194-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-65"><a href="machine-learning.html#cb194-65" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tuning)</span>
<span id="cb194-66"><a href="machine-learning.html#cb194-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-67"><a href="machine-learning.html#cb194-67" aria-hidden="true" tabindex="-1"></a>params_best <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tuning, <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb194-68"><a href="machine-learning.html#cb194-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-69"><a href="machine-learning.html#cb194-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-70"><a href="machine-learning.html#cb194-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Zoom in grid search -----------------------------------------------------</span></span>
<span id="cb194-71"><a href="machine-learning.html#cb194-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-72"><a href="machine-learning.html#cb194-72" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">125</span>)</span>
<span id="cb194-73"><a href="machine-learning.html#cb194-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-74"><a href="machine-learning.html#cb194-74" aria-hidden="true" tabindex="-1"></a>penalty_levels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(params_grid<span class="sc">$</span>penalty))</span>
<span id="cb194-75"><a href="machine-learning.html#cb194-75" aria-hidden="true" tabindex="-1"></a>mixture_levels <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(params_grid<span class="sc">$</span>mixture))</span>
<span id="cb194-76"><a href="machine-learning.html#cb194-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-77"><a href="machine-learning.html#cb194-77" aria-hidden="true" tabindex="-1"></a>penalty_new_range <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb194-78"><a href="machine-learning.html#cb194-78" aria-hidden="true" tabindex="-1"></a>  penalty_levels[<span class="fu">lead</span>(penalty_levels, <span class="at">default =</span> <span class="dv">0</span>) <span class="sc">==</span> params_best<span class="sc">$</span>penalty],</span>
<span id="cb194-79"><a href="machine-learning.html#cb194-79" aria-hidden="true" tabindex="-1"></a>  penalty_levels[<span class="fu">lag</span>(penalty_levels, <span class="at">default =</span> <span class="dv">0</span>) <span class="sc">==</span> params_best<span class="sc">$</span>penalty]</span>
<span id="cb194-80"><a href="machine-learning.html#cb194-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-81"><a href="machine-learning.html#cb194-81" aria-hidden="true" tabindex="-1"></a>mixture_new_range <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb194-82"><a href="machine-learning.html#cb194-82" aria-hidden="true" tabindex="-1"></a>  mixture_levels[<span class="fu">lead</span>(mixture_levels, <span class="at">default =</span> <span class="dv">0</span>) <span class="sc">==</span> params_best<span class="sc">$</span>mixture],</span>
<span id="cb194-83"><a href="machine-learning.html#cb194-83" aria-hidden="true" tabindex="-1"></a>  mixture_levels[<span class="fu">lag</span>(mixture_levels, <span class="at">default =</span> <span class="dv">0</span>) <span class="sc">==</span> params_best<span class="sc">$</span>mixture]</span>
<span id="cb194-84"><a href="machine-learning.html#cb194-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-85"><a href="machine-learning.html#cb194-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-86"><a href="machine-learning.html#cb194-86" aria-hidden="true" tabindex="-1"></a>params_grid_2 <span class="ot">&lt;-</span> model_spec <span class="sc">%&gt;%</span></span>
<span id="cb194-87"><a href="machine-learning.html#cb194-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">%&gt;%</span></span>
<span id="cb194-88"><a href="machine-learning.html#cb194-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(</span>
<span id="cb194-89"><a href="machine-learning.html#cb194-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">penalty =</span> <span class="fu">penalty</span>(<span class="fu">log10</span>(penalty_new_range)),</span>
<span id="cb194-90"><a href="machine-learning.html#cb194-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">mixture =</span> <span class="fu">mixture</span>(mixture_new_range)</span>
<span id="cb194-91"><a href="machine-learning.html#cb194-91" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb194-92"><a href="machine-learning.html#cb194-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_regular</span>(<span class="at">levels =</span> <span class="dv">10</span>)</span>
<span id="cb194-93"><a href="machine-learning.html#cb194-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-94"><a href="machine-learning.html#cb194-94" aria-hidden="true" tabindex="-1"></a>tuning_2 <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb194-95"><a href="machine-learning.html#cb194-95" aria-hidden="true" tabindex="-1"></a>  model_workflow,</span>
<span id="cb194-96"><a href="machine-learning.html#cb194-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> resampling,</span>
<span id="cb194-97"><a href="machine-learning.html#cb194-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> params_grid_2</span>
<span id="cb194-98"><a href="machine-learning.html#cb194-98" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-99"><a href="machine-learning.html#cb194-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-100"><a href="machine-learning.html#cb194-100" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(tuning_2)</span>
<span id="cb194-101"><a href="machine-learning.html#cb194-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-102"><a href="machine-learning.html#cb194-102" aria-hidden="true" tabindex="-1"></a>params_best_2 <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tuning_2, <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb194-103"><a href="machine-learning.html#cb194-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-104"><a href="machine-learning.html#cb194-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-105"><a href="machine-learning.html#cb194-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Finalize model ----------------------------------------------------------</span></span>
<span id="cb194-106"><a href="machine-learning.html#cb194-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-107"><a href="machine-learning.html#cb194-107" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> model_workflow <span class="sc">%&gt;%</span></span>
<span id="cb194-108"><a href="machine-learning.html#cb194-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(params_best_2) <span class="sc">%&gt;%</span></span>
<span id="cb194-109"><a href="machine-learning.html#cb194-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(training_data)</span>
<span id="cb194-110"><a href="machine-learning.html#cb194-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-111"><a href="machine-learning.html#cb194-111" aria-hidden="true" tabindex="-1"></a>validation_data_pred <span class="ot">&lt;-</span> validation_data <span class="sc">%&gt;%</span></span>
<span id="cb194-112"><a href="machine-learning.html#cb194-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(final_model, .))</span>
<span id="cb194-113"><a href="machine-learning.html#cb194-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-114"><a href="machine-learning.html#cb194-114" aria-hidden="true" tabindex="-1"></a><span class="fu">metric_set</span>(rmse, rsq)(validation_data_pred, liking, .pred)</span>
<span id="cb194-115"><a href="machine-learning.html#cb194-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-116"><a href="machine-learning.html#cb194-116" aria-hidden="true" tabindex="-1"></a>validation_data_pred <span class="sc">%&gt;%</span></span>
<span id="cb194-117"><a href="machine-learning.html#cb194-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(liking, .pred)) <span class="sc">+</span></span>
<span id="cb194-118"><a href="machine-learning.html#cb194-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb194-119"><a href="machine-learning.html#cb194-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb194-120"><a href="machine-learning.html#cb194-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-121"><a href="machine-learning.html#cb194-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-122"><a href="machine-learning.html#cb194-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Studio ------------------------------------------------------------</span></span>
<span id="cb194-123"><a href="machine-learning.html#cb194-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-124"><a href="machine-learning.html#cb194-124" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DALEXtra)</span>
<span id="cb194-125"><a href="machine-learning.html#cb194-125" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelStudio)</span>
<span id="cb194-126"><a href="machine-learning.html#cb194-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-127"><a href="machine-learning.html#cb194-127" aria-hidden="true" tabindex="-1"></a>explainer <span class="ot">&lt;-</span> <span class="fu">explain_tidymodels</span>(</span>
<span id="cb194-128"><a href="machine-learning.html#cb194-128" aria-hidden="true" tabindex="-1"></a>  final_model, </span>
<span id="cb194-129"><a href="machine-learning.html#cb194-129" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> training_data <span class="sc">%&gt;%</span> </span>
<span id="cb194-130"><a href="machine-learning.html#cb194-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-131"><a href="machine-learning.html#cb194-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>liking),</span>
<span id="cb194-132"><a href="machine-learning.html#cb194-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> training_data<span class="sc">$</span>liking</span>
<span id="cb194-133"><a href="machine-learning.html#cb194-133" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-134"><a href="machine-learning.html#cb194-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-135"><a href="machine-learning.html#cb194-135" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(explainer)</span>
<span id="cb194-136"><a href="machine-learning.html#cb194-136" aria-hidden="true" tabindex="-1"></a>resid</span>
<span id="cb194-137"><a href="machine-learning.html#cb194-137" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid)</span>
<span id="cb194-138"><a href="machine-learning.html#cb194-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-139"><a href="machine-learning.html#cb194-139" aria-hidden="true" tabindex="-1"></a>var_imp <span class="ot">&lt;-</span> <span class="fu">variable_importance</span>(explainer)</span>
<span id="cb194-140"><a href="machine-learning.html#cb194-140" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(var_imp)</span>
<span id="cb194-141"><a href="machine-learning.html#cb194-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-142"><a href="machine-learning.html#cb194-142" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">modelStudio</span>(</span>
<span id="cb194-143"><a href="machine-learning.html#cb194-143" aria-hidden="true" tabindex="-1"></a>  explainer,</span>
<span id="cb194-144"><a href="machine-learning.html#cb194-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_observation =</span> validation_data <span class="sc">%&gt;%</span></span>
<span id="cb194-145"><a href="machine-learning.html#cb194-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-146"><a href="machine-learning.html#cb194-146" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>liking),</span>
<span id="cb194-147"><a href="machine-learning.html#cb194-147" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_observation_y =</span> <span class="fu">round</span>(validation_data<span class="sc">$</span>liking, <span class="dv">3</span>)</span>
<span id="cb194-148"><a href="machine-learning.html#cb194-148" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-149"><a href="machine-learning.html#cb194-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-150"><a href="machine-learning.html#cb194-150" aria-hidden="true" tabindex="-1"></a><span class="co"># r2d3::save_d3_html(ms, &quot;output/modelstudio.html&quot;)</span></span></code></pre></div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="36">
<li id="fn36"><p>This is a bit of simplification.
In some cases it is some transformation of combination of predictors that
approximates target variable. An example of this is logistic regression.<a href="machine-learning.html#fnref36" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="value-delivery.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="text-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["i2ds4scc_bookdown.pdf", "i2ds4scc_bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
