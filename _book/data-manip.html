<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Manipulation | Data Science for Sensory and Consumer Scientists</title>
  <meta name="description" content="Open development of data science book for sensory and consumer scientists.." />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Manipulation | Data Science for Sensory and Consumer Scientists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Open development of data science book for sensory and consumer scientists.." />
  <meta name="github-repo" content="john-aigora/i2ds4scc_bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Manipulation | Data Science for Sensory and Consumer Scientists" />
  
  <meta name="twitter:description" content="Open development of data science book for sensory and consumer scientists.." />
  

<meta name="author" content="Thierry Worch, Julien Delarue, Vanessa Rios de Souza, and John Ennis" />


<meta name="date" content="2022-12-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data_science.html"/>
<link rel="next" href="data-viz.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<link href="libs/tabwid/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Sensory and Consumer Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-read-this-book"><i class="fa fa-check"></i>Who Should Read This Book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-is-this-book-structured"><i class="fa fa-check"></i>How Is This Book Structured</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How To Use This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="bienvenue.html"><a href="bienvenue.html"><i class="fa fa-check"></i><b>1</b> Bienvenue!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="bienvenue.html"><a href="bienvenue.html#why-data-science-for-sensory-and-consumer-science"><i class="fa fa-check"></i><b>1.1</b> Why Data Science for Sensory and Consumer Science?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="bienvenue.html"><a href="bienvenue.html#core-principles-in-sensory-and-consumer-science"><i class="fa fa-check"></i><b>1.1.1</b> Core principles in Sensory and Consumer Science</a></li>
<li class="chapter" data-level="1.1.2" data-path="bienvenue.html"><a href="bienvenue.html#computational-sensory-science"><i class="fa fa-check"></i><b>1.1.2</b> Computational Sensory Science</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start-R.html"><a href="start-R.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="start-R.html"><a href="start-R.html#introduction-to-r"><i class="fa fa-check"></i><b>2.1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="start-R.html"><a href="start-R.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
<li class="chapter" data-level="2.1.2" data-path="start-R.html"><a href="start-R.html#why-learning-r-or-any-programming-language"><i class="fa fa-check"></i><b>2.1.2</b> Why Learning R (or any Programming Language)?</a></li>
<li class="chapter" data-level="2.1.3" data-path="start-R.html"><a href="start-R.html#why-r"><i class="fa fa-check"></i><b>2.1.3</b> Why R?</a></li>
<li class="chapter" data-level="2.1.4" data-path="start-R.html"><a href="start-R.html#rstudio"><i class="fa fa-check"></i><b>2.1.4</b> Why RStudio/Posit?</a></li>
<li class="chapter" data-level="2.1.5" data-path="start-R.html"><a href="start-R.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.1.5</b> Installing R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="start-R.html"><a href="start-R.html#getting-started-in-r"><i class="fa fa-check"></i><b>2.2</b> Getting Started in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="start-R.html"><a href="start-R.html#packages"><i class="fa fa-check"></i><b>2.2.1</b> Conventions</a></li>
<li class="chapter" data-level="2.2.2" data-path="start-R.html"><a href="start-R.html#install-and-load-packages"><i class="fa fa-check"></i><b>2.2.2</b> Install and Load Packages</a></li>
<li class="chapter" data-level="2.2.3" data-path="start-R.html"><a href="start-R.html#first-analysis-in-r"><i class="fa fa-check"></i><b>2.2.3</b> First Analysis in R</a></li>
<li class="chapter" data-level="2.2.4" data-path="start-R.html"><a href="start-R.html#scripts"><i class="fa fa-check"></i><b>2.2.4</b> R Scripts</a></li>
<li class="chapter" data-level="2.2.5" data-path="start-R.html"><a href="start-R.html#rprojects"><i class="fa fa-check"></i><b>2.2.5</b> Create a Local Project</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="start-R.html"><a href="start-R.html#further-tips-on-how-to-read-this-book"><i class="fa fa-check"></i><b>2.3</b> Further tips on <em>how to read this book?</em></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="start-R.html"><a href="start-R.html#pipes"><i class="fa fa-check"></i><b>2.3.1</b> Introduction to the <code>{magrittr}</code> and the notion of <em>pipes</em></a></li>
<li class="chapter" data-level="2.3.2" data-path="start-R.html"><a href="start-R.html#tibbles"><i class="fa fa-check"></i><b>2.3.2</b> Tibbles</a></li>
<li class="chapter" data-level="2.3.3" data-path="start-R.html"><a href="start-R.html#calling-variables"><i class="fa fa-check"></i><b>2.3.3</b> Calling Variables</a></li>
<li class="chapter" data-level="2.3.4" data-path="start-R.html"><a href="start-R.html#print-save"><i class="fa fa-check"></i><b>2.3.4</b> Printing vs. Saving results</a></li>
<li class="chapter" data-level="2.3.5" data-path="start-R.html"><a href="start-R.html#running-code-and-handling-errors"><i class="fa fa-check"></i><b>2.3.5</b> Running code and handling errors</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="start-R.html"><a href="start-R.html#git-and-github"><i class="fa fa-check"></i><b>2.4</b> Version Control / Git and GitHub</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="start-R.html"><a href="start-R.html#git"><i class="fa fa-check"></i><b>2.4.1</b> Git</a></li>
<li class="chapter" data-level="2.4.2" data-path="start-R.html"><a href="start-R.html#github"><i class="fa fa-check"></i><b>2.4.2</b> GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data_science.html"><a href="data_science.html"><i class="fa fa-check"></i><b>3</b> Why Data Science?</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data_science.html"><a href="data_science.html#history-and-definition"><i class="fa fa-check"></i><b>3.1</b> History and Definition</a></li>
<li class="chapter" data-level="3.2" data-path="data_science.html"><a href="data_science.html#benefits-of-data-science"><i class="fa fa-check"></i><b>3.2</b> Benefits of Data Science</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data_science.html"><a href="data_science.html#reproducible-research"><i class="fa fa-check"></i><b>3.2.1</b> Reproducible Research</a></li>
<li class="chapter" data-level="3.2.2" data-path="data_science.html"><a href="data_science.html#standardized-reporting"><i class="fa fa-check"></i><b>3.2.2</b> Standardized Reporting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data_science.html"><a href="data_science.html#data-scientific-workflow"><i class="fa fa-check"></i><b>3.3</b> Data Scientific Workflow</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data_science.html"><a href="data_science.html#data-collection2"><i class="fa fa-check"></i><b>3.3.1</b> Data Collection</a></li>
<li class="chapter" data-level="3.3.2" data-path="data_science.html"><a href="data_science.html#data-preparation"><i class="fa fa-check"></i><b>3.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="3.3.3" data-path="data_science.html"><a href="data_science.html#data-analysis2"><i class="fa fa-check"></i><b>3.3.3</b> Data Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="data_science.html"><a href="data_science.html#value-delivery2"><i class="fa fa-check"></i><b>3.3.4</b> Value Delivery</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data_science.html"><a href="data_science.html#how-to-learn-data-science"><i class="fa fa-check"></i><b>3.4</b> How to Learn Data Science</a></li>
<li class="chapter" data-level="3.5" data-path="data_science.html"><a href="data_science.html#cautions-dont-that-everybody-does"><i class="fa fa-check"></i><b>3.5</b> Cautions: Don’t that Everybody Does</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manip.html"><a href="data-manip.html#why-manipulating-data"><i class="fa fa-check"></i><b>4.1</b> Why Manipulating Data?</a></li>
<li class="chapter" data-level="4.2" data-path="data-manip.html"><a href="data-manip.html#tidy-data"><i class="fa fa-check"></i><b>4.2</b> Tidying Data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-manip.html"><a href="data-manip.html#simple-manipulations"><i class="fa fa-check"></i><b>4.2.1</b> Simple Manipulations</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-manip.html"><a href="data-manip.html#pivots"><i class="fa fa-check"></i><b>4.2.2</b> Reshaping Data</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-manip.html"><a href="data-manip.html#transformation-that-alters-the-data"><i class="fa fa-check"></i><b>4.2.3</b> Transformation that Alters the Data</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-manip.html"><a href="data-manip.html#combining-data-from-different-sources"><i class="fa fa-check"></i><b>4.2.4</b> Combining Data from Different Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-viz.html"><a href="data-viz.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="data-viz.html"><a href="data-viz.html#design-principles"><i class="fa fa-check"></i><b>5.2</b> Design Principles</a></li>
<li class="chapter" data-level="5.3" data-path="data-viz.html"><a href="data-viz.html#table_making"><i class="fa fa-check"></i><b>5.3</b> Table Making</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-viz.html"><a href="data-viz.html#flextable"><i class="fa fa-check"></i><b>5.3.1</b> Introduction to <code>{flextable}</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="data-viz.html"><a href="data-viz.html#introdution-to-gt"><i class="fa fa-check"></i><b>5.3.2</b> Introdution to <code>{gt}</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-viz.html"><a href="data-viz.html#chart-making"><i class="fa fa-check"></i><b>5.4</b> Chart Making</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-viz.html"><a href="data-viz.html#philosophy-of-ggplot2"><i class="fa fa-check"></i><b>5.4.1</b> Philosophy of <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="data-viz.html"><a href="data-viz.html#getting-started-with-ggplot2"><i class="fa fa-check"></i><b>5.4.2</b> Getting started with <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="5.4.3" data-path="data-viz.html"><a href="data-viz.html#common-charts"><i class="fa fa-check"></i><b>5.4.3</b> Common Charts</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-viz.html"><a href="data-viz.html#miscealleneous"><i class="fa fa-check"></i><b>5.4.4</b> Miscealleneous</a></li>
<li class="chapter" data-level="5.4.5" data-path="data-viz.html"><a href="data-viz.html#few-additional-tips-and-tricks"><i class="fa fa-check"></i><b>5.4.5</b> Few Additional Tips and Tricks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="auto-report.html"><a href="auto-report.html"><i class="fa fa-check"></i><b>6</b> Automated Reporting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="auto-report.html"><a href="auto-report.html#what-and-why-automated-reporting"><i class="fa fa-check"></i><b>6.1</b> What and why Automated Reporting?</a></li>
<li class="chapter" data-level="6.2" data-path="auto-report.html"><a href="auto-report.html#integrating-reports-within-analyses-scripts"><i class="fa fa-check"></i><b>6.2</b> Integrating reports within analyses scripts</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="auto-report.html"><a href="auto-report.html#excel"><i class="fa fa-check"></i><b>6.2.1</b> Excel</a></li>
<li class="chapter" data-level="6.2.2" data-path="auto-report.html"><a href="auto-report.html#powerpoint"><i class="fa fa-check"></i><b>6.2.2</b> PowerPoint</a></li>
<li class="chapter" data-level="6.2.3" data-path="auto-report.html"><a href="auto-report.html#word"><i class="fa fa-check"></i><b>6.2.3</b> Word</a></li>
<li class="chapter" data-level="6.2.4" data-path="auto-report.html"><a href="auto-report.html#notes-on-applying-corporate-branding"><i class="fa fa-check"></i><b>6.2.4</b> Notes on applying corporate branding</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="auto-report.html"><a href="auto-report.html#integrating-analyses-scripts-within-your-reporting-tool"><i class="fa fa-check"></i><b>6.3</b> Integrating analyses scripts within your reporting tool</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="auto-report.html"><a href="auto-report.html#what-is-rmarkdown"><i class="fa fa-check"></i><b>6.3.1</b> What is <code>{rmarkdown}</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="auto-report.html"><a href="auto-report.html#starting-with-rmarkdown"><i class="fa fa-check"></i><b>6.3.2</b> Starting with {rmarkdown}</a></li>
<li class="chapter" data-level="6.3.3" data-path="auto-report.html"><a href="auto-report.html#rmarkdown-through-a-simple-example"><i class="fa fa-check"></i><b>6.3.3</b> <code>{rmarkdown}</code> through a Simple Example</a></li>
<li class="chapter" data-level="6.3.4" data-path="auto-report.html"><a href="auto-report.html#creating-a-document-using-knitr"><i class="fa fa-check"></i><b>6.3.4</b> Creating a document using <code>{knitr}</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="auto-report.html"><a href="auto-report.html#example-of-applications"><i class="fa fa-check"></i><b>6.3.5</b> Example of applications</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="auto-report.html"><a href="auto-report.html#to-go-further"><i class="fa fa-check"></i><b>6.4</b> To go further…</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="example-projects.html"><a href="example-projects.html"><i class="fa fa-check"></i><b>7</b> Example Project: The Biscuit Study</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example-projects.html"><a href="example-projects.html#objective-of-the-test"><i class="fa fa-check"></i><b>7.1</b> Objective of the Test</a></li>
<li class="chapter" data-level="7.2" data-path="example-projects.html"><a href="example-projects.html#products"><i class="fa fa-check"></i><b>7.2</b> Products</a></li>
<li class="chapter" data-level="7.3" data-path="example-projects.html"><a href="example-projects.html#consumer-test"><i class="fa fa-check"></i><b>7.3</b> Consumer test</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="example-projects.html"><a href="example-projects.html#participants"><i class="fa fa-check"></i><b>7.3.1</b> Participants</a></li>
<li class="chapter" data-level="7.3.2" data-path="example-projects.html"><a href="example-projects.html#test-design"><i class="fa fa-check"></i><b>7.3.2</b> Test design</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="example-projects.html"><a href="example-projects.html#sensory-descriptive-analysis-data"><i class="fa fa-check"></i><b>7.4</b> Sensory descriptive analysis data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>8</b> Data Collection</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-collection.html"><a href="data-collection.html#designs-of-sensory-doe-experiments"><i class="fa fa-check"></i><b>8.1</b> Designs of sensory (DoE) experiments</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="data-collection.html"><a href="data-collection.html#general-approach"><i class="fa fa-check"></i><b>8.1.1</b> General approach</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-collection.html"><a href="data-collection.html#Crossover"><i class="fa fa-check"></i><b>8.1.2</b> Crossover designs</a></li>
<li class="chapter" data-level="8.1.3" data-path="data-collection.html"><a href="data-collection.html#BIBD"><i class="fa fa-check"></i><b>8.1.3</b> Balanced incomplete block designs (BIBD)</a></li>
<li class="chapter" data-level="8.1.4" data-path="data-collection.html"><a href="data-collection.html#incomplete-designs-for-hedonic-tests-sensory-informed-designs"><i class="fa fa-check"></i><b>8.1.4</b> Incomplete designs for hedonic tests: Sensory informed designs</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-collection.html"><a href="data-collection.html#product-related-designs"><i class="fa fa-check"></i><b>8.2</b> Product-related designs</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="data-collection.html"><a href="data-collection.html#factorial-designs"><i class="fa fa-check"></i><b>8.2.1</b> Factorial designs</a></li>
<li class="chapter" data-level="8.2.2" data-path="data-collection.html"><a href="data-collection.html#mixture-designs"><i class="fa fa-check"></i><b>8.2.2</b> Mixture designs</a></li>
<li class="chapter" data-level="8.2.3" data-path="data-collection.html"><a href="data-collection.html#screening-designs"><i class="fa fa-check"></i><b>8.2.3</b> Screening designs</a></li>
<li class="chapter" data-level="8.2.4" data-path="data-collection.html"><a href="data-collection.html#sensory-informed-designs"><i class="fa fa-check"></i><b>8.2.4</b> Sensory informed designs</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="data-collection.html"><a href="data-collection.html#execute-1"><i class="fa fa-check"></i><b>8.3</b> Execute</a></li>
<li class="chapter" data-level="8.4" data-path="data-collection.html"><a href="data-collection.html#data-import"><i class="fa fa-check"></i><b>8.4</b> Import</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="data-collection.html"><a href="data-collection.html#importing-structured-excel-file"><i class="fa fa-check"></i><b>8.4.1</b> Importing Structured Excel File</a></li>
<li class="chapter" data-level="8.4.2" data-path="data-collection.html"><a href="data-collection.html#importing-unstructured-excel-file"><i class="fa fa-check"></i><b>8.4.2</b> Importing Unstructured Excel File</a></li>
<li class="chapter" data-level="8.4.3" data-path="data-collection.html"><a href="data-collection.html#import-mult-sheet"><i class="fa fa-check"></i><b>8.4.3</b> Importing Data Stored in Multiple Sheets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>9</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-prep.html"><a href="data-prep.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="data-prep.html"><a href="data-prep.html#inspect"><i class="fa fa-check"></i><b>9.2</b> Inspect</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-prep.html"><a href="data-prep.html#data-inspection"><i class="fa fa-check"></i><b>9.2.1</b> Data Inspection</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-prep.html"><a href="data-prep.html#missing-data"><i class="fa fa-check"></i><b>9.2.2</b> Missing Data</a></li>
<li class="chapter" data-level="9.2.3" data-path="data-prep.html"><a href="data-prep.html#design-inspection"><i class="fa fa-check"></i><b>9.2.3</b> Design Inspection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-prep.html"><a href="data-prep.html#clean"><i class="fa fa-check"></i><b>9.3</b> Clean</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="data-prep.html"><a href="data-prep.html#handling-data-type"><i class="fa fa-check"></i><b>9.3.1</b> Handling Data Type</a></li>
<li class="chapter" data-level="9.3.2" data-path="data-prep.html"><a href="data-prep.html#converting-between-types"><i class="fa fa-check"></i><b>9.3.2</b> Converting between Types</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>10</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-analysis.html"><a href="data-analysis.html#sensory-analysis"><i class="fa fa-check"></i><b>10.1</b> Sensory Data</a></li>
<li class="chapter" data-level="10.2" data-path="data-analysis.html"><a href="data-analysis.html#demographic-and-questionnaire-data"><i class="fa fa-check"></i><b>10.2</b> Demographic and Questionnaire Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-analysis.html"><a href="data-analysis.html#demographic-data-frequency-and-proportion"><i class="fa fa-check"></i><b>10.2.1</b> Demographic Data: Frequency and Proportion</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-analysis.html"><a href="data-analysis.html#eating-behavior-traits-tfeq-data"><i class="fa fa-check"></i><b>10.2.2</b> Eating behavior traits: TFEQ data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-analysis.html"><a href="data-analysis.html#tibble-use"><i class="fa fa-check"></i><b>10.3</b> Consumer Data</a></li>
<li class="chapter" data-level="10.4" data-path="data-analysis.html"><a href="data-analysis.html#combining-sensory-and-consumer-data"><i class="fa fa-check"></i><b>10.4</b> Combining Sensory and Consumer Data</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="data-analysis.html"><a href="data-analysis.html#internal-preference-mapping"><i class="fa fa-check"></i><b>10.4.1</b> Internal Preference Mapping</a></li>
<li class="chapter" data-level="10.4.2" data-path="data-analysis.html"><a href="data-analysis.html#hac"><i class="fa fa-check"></i><b>10.4.2</b> Consumers Clustering</a></li>
<li class="chapter" data-level="10.4.3" data-path="data-analysis.html"><a href="data-analysis.html#drivers-of-liking"><i class="fa fa-check"></i><b>10.4.3</b> Drivers of Liking</a></li>
<li class="chapter" data-level="10.4.4" data-path="data-analysis.html"><a href="data-analysis.html#prefmap"><i class="fa fa-check"></i><b>10.4.4</b> External Preference Mapping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="value-delivery.html"><a href="value-delivery.html"><i class="fa fa-check"></i><b>11</b> Value Delivery</a>
<ul>
<li class="chapter" data-level="11.1" data-path="value-delivery.html"><a href="value-delivery.html#how-to-communicate"><i class="fa fa-check"></i><b>11.1</b> How to Communicate?</a></li>
<li class="chapter" data-level="11.2" data-path="value-delivery.html"><a href="value-delivery.html#exploratory-explanatory-and-predictive-analysis"><i class="fa fa-check"></i><b>11.2</b> Exploratory, Explanatory and Predictive Analysis</a></li>
<li class="chapter" data-level="11.3" data-path="value-delivery.html"><a href="value-delivery.html#audience-awareness"><i class="fa fa-check"></i><b>11.3</b> Audience Awareness</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="value-delivery.html"><a href="value-delivery.html#technical-audience"><i class="fa fa-check"></i><b>11.3.1</b> Technical Audience</a></li>
<li class="chapter" data-level="11.3.2" data-path="value-delivery.html"><a href="value-delivery.html#management"><i class="fa fa-check"></i><b>11.3.2</b> Management</a></li>
<li class="chapter" data-level="11.3.3" data-path="value-delivery.html"><a href="value-delivery.html#general-interest"><i class="fa fa-check"></i><b>11.3.3</b> General Interest</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="value-delivery.html"><a href="value-delivery.html#methods-to-communicate"><i class="fa fa-check"></i><b>11.4</b> Methods to Communicate</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="value-delivery.html"><a href="value-delivery.html#consider-the-mechanism"><i class="fa fa-check"></i><b>11.4.1</b> Consider the Mechanism</a></li>
<li class="chapter" data-level="11.4.2" data-path="value-delivery.html"><a href="value-delivery.html#pick-the-correct-format"><i class="fa fa-check"></i><b>11.4.2</b> Pick the Correct Format</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="value-delivery.html"><a href="value-delivery.html#storytelling"><i class="fa fa-check"></i><b>11.5</b> Storytelling</a></li>
<li class="chapter" data-level="11.6" data-path="value-delivery.html"><a href="value-delivery.html#reformulate2"><i class="fa fa-check"></i><b>11.6</b> Reformulate</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>12</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="machine-learning.html"><a href="machine-learning.html#introduction-2"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="machine-learning.html"><a href="machine-learning.html#introduction-of-the-data"><i class="fa fa-check"></i><b>12.2</b> Introduction of the Data</a></li>
<li class="chapter" data-level="12.3" data-path="machine-learning.html"><a href="machine-learning.html#machine-learning-methods"><i class="fa fa-check"></i><b>12.3</b> Machine Learning Methods</a></li>
<li class="chapter" data-level="12.4" data-path="machine-learning.html"><a href="machine-learning.html#unsupervised-machine-learning"><i class="fa fa-check"></i><b>12.4</b> Unsupervised Machine learning</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="machine-learning.html"><a href="machine-learning.html#dimensionality-reduction"><i class="fa fa-check"></i><b>12.4.1</b> Dimensionality Reduction</a></li>
<li class="chapter" data-level="12.4.2" data-path="machine-learning.html"><a href="machine-learning.html#clustering"><i class="fa fa-check"></i><b>12.4.2</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="machine-learning.html"><a href="machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>12.5</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="machine-learning.html"><a href="machine-learning.html#workflow"><i class="fa fa-check"></i><b>12.5.1</b> Workflow</a></li>
<li class="chapter" data-level="12.5.2" data-path="machine-learning.html"><a href="machine-learning.html#regression"><i class="fa fa-check"></i><b>12.5.2</b> Regression</a></li>
<li class="chapter" data-level="12.5.3" data-path="machine-learning.html"><a href="machine-learning.html#other-common-supervised-ml-algorithms"><i class="fa fa-check"></i><b>12.5.3</b> Other common Supervised ML algorithms</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="machine-learning.html"><a href="machine-learning.html#practical-guide-to-supervised-machine-learning"><i class="fa fa-check"></i><b>12.6</b> Practical Guide to Supervised Machine Learning</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="machine-learning.html"><a href="machine-learning.html#introduction-to-the-tidymodels-framework"><i class="fa fa-check"></i><b>12.6.1</b> Introduction to the <code>{tidymodels}</code> framework</a></li>
<li class="chapter" data-level="12.6.2" data-path="machine-learning.html"><a href="machine-learning.html#sampling-the-data"><i class="fa fa-check"></i><b>12.6.2</b> Sampling the data</a></li>
<li class="chapter" data-level="12.6.3" data-path="machine-learning.html"><a href="machine-learning.html#cross-validation"><i class="fa fa-check"></i><b>12.6.3</b> Cross Validation</a></li>
<li class="chapter" data-level="12.6.4" data-path="machine-learning.html"><a href="machine-learning.html#data-preprocessing-recipes"><i class="fa fa-check"></i><b>12.6.4</b> Data Preprocessing <code>{recipes}</code></a></li>
<li class="chapter" data-level="12.6.5" data-path="machine-learning.html"><a href="machine-learning.html#model-definition"><i class="fa fa-check"></i><b>12.6.5</b> Model definition</a></li>
<li class="chapter" data-level="12.6.6" data-path="machine-learning.html"><a href="machine-learning.html#set-the-whole-process-into-a-workflow"><i class="fa fa-check"></i><b>12.6.6</b> Set the whole Process into a workflow</a></li>
<li class="chapter" data-level="12.6.7" data-path="machine-learning.html"><a href="machine-learning.html#tuning-the-parameters"><i class="fa fa-check"></i><b>12.6.7</b> Tuning the parameters</a></li>
<li class="chapter" data-level="12.6.8" data-path="machine-learning.html"><a href="machine-learning.html#model-training"><i class="fa fa-check"></i><b>12.6.8</b> Model training</a></li>
<li class="chapter" data-level="12.6.9" data-path="machine-learning.html"><a href="machine-learning.html#model-evaluation"><i class="fa fa-check"></i><b>12.6.9</b> Model evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>13</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="text-analysis.html"><a href="text-analysis.html#introduction-to-natural-language-processing"><i class="fa fa-check"></i><b>13.1</b> Introduction to Natural Language Processing</a></li>
<li class="chapter" data-level="13.2" data-path="text-analysis.html"><a href="text-analysis.html#application-of-text-analysis-in-sensory-and-consumer-science"><i class="fa fa-check"></i><b>13.2</b> Application of Text Analysis in Sensory and Consumer Science</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="text-analysis.html"><a href="text-analysis.html#text-analysis-as-way-to-describe-products"><i class="fa fa-check"></i><b>13.2.1</b> Text analysis as way to describe products</a></li>
<li class="chapter" data-level="13.2.2" data-path="text-analysis.html"><a href="text-analysis.html#objectives-of-text-analysis"><i class="fa fa-check"></i><b>13.2.2</b> Objectives of Text Analysis</a></li>
<li class="chapter" data-level="13.2.3" data-path="text-analysis.html"><a href="text-analysis.html#classical-text-analysis-workflow"><i class="fa fa-check"></i><b>13.2.3</b> Classical <em>text analysis</em> workflow</a></li>
<li class="chapter" data-level="13.2.4" data-path="text-analysis.html"><a href="text-analysis.html#warnings"><i class="fa fa-check"></i><b>13.2.4</b> Warnings</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="text-analysis.html"><a href="text-analysis.html#illustration-using-sorting-task-data"><i class="fa fa-check"></i><b>13.3</b> Illustration using Sorting Task Data</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="text-analysis.html"><a href="text-analysis.html#data-pre-processing"><i class="fa fa-check"></i><b>13.3.1</b> Data Pre-processing</a></li>
<li class="chapter" data-level="13.3.2" data-path="text-analysis.html"><a href="text-analysis.html#introduction-to-working-with-strings-stringr"><i class="fa fa-check"></i><b>13.3.2</b> Introduction to working with strings (<code>{stringr}</code>)</a></li>
<li class="chapter" data-level="13.3.3" data-path="text-analysis.html"><a href="text-analysis.html#tokenization"><i class="fa fa-check"></i><b>13.3.3</b> Tokenization</a></li>
<li class="chapter" data-level="13.3.4" data-path="text-analysis.html"><a href="text-analysis.html#simple-transformations"><i class="fa fa-check"></i><b>13.3.4</b> Simple Transformations</a></li>
<li class="chapter" data-level="13.3.5" data-path="text-analysis.html"><a href="text-analysis.html#splitting-further-the-tokens"><i class="fa fa-check"></i><b>13.3.5</b> Splitting further the tokens</a></li>
<li class="chapter" data-level="13.3.6" data-path="text-analysis.html"><a href="text-analysis.html#stopwords"><i class="fa fa-check"></i><b>13.3.6</b> Stopwords</a></li>
<li class="chapter" data-level="13.3.7" data-path="text-analysis.html"><a href="text-analysis.html#stemming-and-lemmatization"><i class="fa fa-check"></i><b>13.3.7</b> Stemming and Lemmatization</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="text-analysis.html"><a href="text-analysis.html#text-analysis-1"><i class="fa fa-check"></i><b>13.4</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="text-analysis.html"><a href="text-analysis.html#raw-frequencies-and-visualization"><i class="fa fa-check"></i><b>13.4.1</b> Raw Frequencies and Visualization</a></li>
<li class="chapter" data-level="13.4.2" data-path="text-analysis.html"><a href="text-analysis.html#bigrams-n-grams"><i class="fa fa-check"></i><b>13.4.2</b> Bigrams, <em>n</em>-grams</a></li>
<li class="chapter" data-level="13.4.3" data-path="text-analysis.html"><a href="text-analysis.html#word-embedding"><i class="fa fa-check"></i><b>13.4.3</b> Word Embedding</a></li>
<li class="chapter" data-level="13.4.4" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>13.4.4</b> Sentiment Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="text-analysis.html"><a href="text-analysis.html#to-go-further-1"><i class="fa fa-check"></i><b>13.5</b> To go further…</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>14</b> Dashboards</a>
<ul>
<li class="chapter" data-level="14.1" data-path="dashboards.html"><a href="dashboards.html#objectives"><i class="fa fa-check"></i><b>14.1</b> Objectives</a></li>
<li class="chapter" data-level="14.2" data-path="dashboards.html"><a href="dashboards.html#introduction-to-shiny-through-an-example"><i class="fa fa-check"></i><b>14.2</b> Introduction to Shiny through an Example</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="dashboards.html"><a href="dashboards.html#what-is-a-shiny-application"><i class="fa fa-check"></i><b>14.2.1</b> What is a Shiny application?</a></li>
<li class="chapter" data-level="14.2.2" data-path="dashboards.html"><a href="dashboards.html#starting-with-shiny"><i class="fa fa-check"></i><b>14.2.2</b> Starting with Shiny</a></li>
<li class="chapter" data-level="14.2.3" data-path="dashboards.html"><a href="dashboards.html#illustration"><i class="fa fa-check"></i><b>14.2.3</b> Illustration</a></li>
<li class="chapter" data-level="14.2.4" data-path="dashboards.html"><a href="dashboards.html#deploying-the-application"><i class="fa fa-check"></i><b>14.2.4</b> Deploying the Application</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="dashboards.html"><a href="dashboards.html#to-go-further-2"><i class="fa fa-check"></i><b>14.3</b> To go further…</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="dashboards.html"><a href="dashboards.html#personalizing-and-tuning-your-application"><i class="fa fa-check"></i><b>14.3.1</b> Personalizing and Tuning your application</a></li>
<li class="chapter" data-level="14.3.2" data-path="dashboards.html"><a href="dashboards.html#upgrading-tables"><i class="fa fa-check"></i><b>14.3.2</b> Upgrading Tables</a></li>
<li class="chapter" data-level="14.3.3" data-path="dashboards.html"><a href="dashboards.html#building-dashboard"><i class="fa fa-check"></i><b>14.3.3</b> Building Dashboard</a></li>
<li class="chapter" data-level="14.3.4" data-path="dashboards.html"><a href="dashboards.html#interactive-graphics"><i class="fa fa-check"></i><b>14.3.4</b> Interactive Graphics</a></li>
<li class="chapter" data-level="14.3.5" data-path="dashboards.html"><a href="dashboards.html#interactive-documents"><i class="fa fa-check"></i><b>14.3.5</b> Interactive Documents</a></li>
<li class="chapter" data-level="14.3.6" data-path="dashboards.html"><a href="dashboards.html#documentation-and-books"><i class="fa fa-check"></i><b>14.3.6</b> Documentation and Books</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>15</b> Conclusion and Next Steps</a>
<ul>
<li class="chapter" data-level="15.1" data-path="next-steps.html"><a href="next-steps.html#other-recommended-resources"><i class="fa fa-check"></i><b>15.1</b> Other Recommended Resources</a></li>
<li class="chapter" data-level="15.2" data-path="next-steps.html"><a href="next-steps.html#useful-r-packages"><i class="fa fa-check"></i><b>15.2</b> Useful R Packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Sensory and Consumer Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-manip" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Manipulation<a href="data-manip.html#data-manip" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>This chapter aims in introducing the <code>{tidyverse}</code> as you’ll learn how to manipulate and transform your data by exploring simple (e.g. renaming columns, sorting tables, relocating variables, etc.) to complex transformations (e.g. transposing parts of the table, combining/merging tables, etc.)<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>. Such transformations are done through simple examples that are relevant to Sensory and Consumer Science.</p>
</blockquote>
<div id="why-manipulating-data" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Why Manipulating Data?<a href="data-manip.html#why-manipulating-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before starting, for this chapter, most functions used are from the <code>{tidyverse}</code>. Also many transformations proposed are not being saved. If you want to apply these changes to your data set, please visit <a href="start-R.html#print-save">2.3.4</a>. Let’s start with loading this package:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data-manip.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>In sensory science, different data collection tools (e.g. different devices, software, methodologies, etc.) may provide the same data in different ways. Also, different statistical analyses may require having the data structured differently.</p>
<p>A simple example to illustrate this latter point is the analysis of liking data.</p>
<p>Let <em>C</em> consumers provide their hedonic assessments on <em>P</em> samples. To evaluate if samples have received different mean liking scores at the population level, an ANOVA is performed on a long thin table with 3 columns (consumer, sample, and the liking scores), where the combination of <em>CxP</em> is spread in rows.</p>
<template id="fcdbabc1-dded-4345-b329-1baf557d75c8"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b2f280f2{}.cl-b2e44c80{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b2ea100c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b2ea383e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b2ea3848{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b2ea3849{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b2f280f2'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b2ea383e"><p class="cl-b2ea100c"><span class="cl-b2e44c80">Consumer</span></p></th><th class="cl-b2ea383e"><p class="cl-b2ea100c"><span class="cl-b2e44c80">Product</span></p></th><th class="cl-b2ea383e"><p class="cl-b2ea100c"><span class="cl-b2e44c80">Liking</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">C1</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">P1</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">C1</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">P2</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">C1</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">P</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">C2</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">P1</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">c</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">p</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">L(c,p)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td><td class="cl-b2ea3848"><p class="cl-b2ea100c"><span class="cl-b2e44c80">...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b2ea3849"><p class="cl-b2ea100c"><span class="cl-b2e44c80">C</span></p></td><td class="cl-b2ea3849"><p class="cl-b2ea100c"><span class="cl-b2e44c80">P</span></p></td><td class="cl-b2ea3849"><p class="cl-b2ea100c"><span class="cl-b2e44c80">L(C,P)</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="eaaa0412-fb86-4b98-86b3-b9f119d57786"></div>
<script>
var dest = document.getElementById("eaaa0412-fb86-4b98-86b3-b9f119d57786");
var template = document.getElementById("fcdbabc1-dded-4345-b329-1baf557d75c8");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>However, to assess whether consumers have the same preference patterns at the individual level, internal preference mapping or cluster analysis is performed. Both these analyses require as input a short and large table with the <em>P</em> products in rows and the <em>C</em> consumers in columns.</p>
<template id="286b1f49-b9b2-4d95-bac4-9a4b5f01c165"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b3179f7c{}.cl-b30abe60{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b3100974{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b3102972{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3102986{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3102987{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b3179f7c'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b3102972"><p class="cl-b3100974"><span class="cl-b30abe60">Product</span></p></th><th class="cl-b3102972"><p class="cl-b3100974"><span class="cl-b30abe60">C1</span></p></th><th class="cl-b3102972"><p class="cl-b3100974"><span class="cl-b30abe60">C2</span></p></th><th class="cl-b3102972"><p class="cl-b3100974"><span class="cl-b30abe60"> ...</span></p></th><th class="cl-b3102972"><p class="cl-b3100974"><span class="cl-b30abe60">c</span></p></th><th class="cl-b3102972"><p class="cl-b3100974"><span class="cl-b30abe60">... </span></p></th><th class="cl-b3102972"><p class="cl-b3100974"><span class="cl-b30abe60">C</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">P1</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">6</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">8</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">P2</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">8</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">4</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">...</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">...</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">...</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">p</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">3</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">7</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">L(p,c)</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">L(p,C)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">...</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">...</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">...</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102986"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3102987"><p class="cl-b3100974"><span class="cl-b30abe60">P</span></p></td><td class="cl-b3102987"><p class="cl-b3100974"><span class="cl-b30abe60">5</span></p></td><td class="cl-b3102987"><p class="cl-b3100974"><span class="cl-b30abe60">6</span></p></td><td class="cl-b3102987"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102987"><p class="cl-b3100974"><span class="cl-b30abe60">L(P,c)</span></p></td><td class="cl-b3102987"><p class="cl-b3100974"><span class="cl-b30abe60">.</span></p></td><td class="cl-b3102987"><p class="cl-b3100974"><span class="cl-b30abe60">L(P,C)</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="acff25bd-bf70-4822-afb4-ceab79353af2"></div>
<script>
var dest = document.getElementById("acff25bd-bf70-4822-afb4-ceab79353af2");
var template = document.getElementById("286b1f49-b9b2-4d95-bac4-9a4b5f01c165");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>Another example of data manipulation consists in summarizing data, by for instance computing the mean by product of the liking scores, or by generating frequency tables (e.g. distribution of the liking scores by product etc.). In this case, the transformation alters the data as the individual differences are lost. Ultimately, the output table is smaller as it would contain here only <em>P</em> rows and 2 columns:</p>
<template id="5ca9884c-7713-402e-84f8-5be9f306be2b"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b3345932{}.cl-b325eafa{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b32bc6f0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b32bf18e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b32bf1a2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b32bf1a3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b3345932'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b32bf18e"><p class="cl-b32bc6f0"><span class="cl-b325eafa">Product</span></p></th><th class="cl-b32bf18e"><p class="cl-b32bc6f0"><span class="cl-b325eafa">Liking</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">P1</span></p></td><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">6.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">P2</span></p></td><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">8.2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">...</span></p></td><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">p</span></p></td><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">7.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">...</span></p></td><td class="cl-b32bf1a2"><p class="cl-b32bc6f0"><span class="cl-b325eafa">...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b32bf1a3"><p class="cl-b32bc6f0"><span class="cl-b325eafa">P</span></p></td><td class="cl-b32bf1a3"><p class="cl-b32bc6f0"><span class="cl-b325eafa">6.1</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="b4a642b2-f781-4a69-ae86-98257e87a2f2"></div>
<script>
var dest = document.getElementById("b4a642b2-f781-4a69-ae86-98257e87a2f2");
var template = document.getElementById("5ca9884c-7713-402e-84f8-5be9f306be2b");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>For these reasons, it is essential to learn to manipulate data and transition from one structure to another (when possible).</p>
</div>
<div id="tidy-data" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Tidying Data<a href="data-manip.html#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hadley Wickham (<span class="citation">Wickham (<a href="#ref-Wickham2014" role="doc-biblioref">2014</a>)</span>) defined <em>tidy data</em> as “data sets that are arranged such that each variable is a column and each observation (or case) is a row.” Depending on the statistical unit to consider and the analyses to perform, data may need to be manipulated to be presented in a tidy form.</p>
<div id="simple-manipulations" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Simple Manipulations<a href="data-manip.html#simple-manipulations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We define here as <em>simple manipulations</em> any data transformations that can easily be performed in other software such as Excel (using copy-paste, sorting and filtering, creating a pivot table, etc.). However, we strongly recommend performing any sorts of transformation in R as this will reduce the risk of errors, typically be faster, more reliable, and will be reusable if you need to perform the same operations on similar data in the future (including updated versions of the current data set). Moreover, these operations will become easier and more natural for you to use as you get familiar with them. Most importantly, performing these transformations in R do not alter the original data, meaning that changes can be reverted (which is not possible when you alter the raw data directly).</p>
<div id="handling-columns" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Handling Columns<a href="data-manip.html#handling-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="renaming" class="section level5 hasAnchor" number="4.2.1.1.1">
<h5><span class="header-section-number">4.2.1.1.1</span> Renaming Variables<a href="data-manip.html#renaming" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Before starting transforming any data, we need data. So let’s start with importing the <em>biscuits_sensory_profile.xlsx</em> file<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>. For importing the data, the packages <code>{here}</code> and <code>{readxl}</code> are being used. Here, the data are being saved in the object called <code>sensory</code>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="data-manip.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb42-2"><a href="data-manip.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb42-3"><a href="data-manip.html#cb42-3" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;biscuits_sensory_profile.xlsx&quot;</span>)</span>
<span id="cb42-4"><a href="data-manip.html#cb42-4" aria-hidden="true" tabindex="-1"></a>sensory <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet =</span> <span class="st">&quot;Data&quot;</span>)</span></code></pre></div>
<p>The first simple transformation we consider consists of renaming one or multiple variables. This procedure can easily be done using the <code>rename()</code> function from <code>{dplyr}</code>. In each of the examples below, we use the <code>names()</code> function to show just the names of the resulting data set.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data-manip.html#cb43-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="data-manip.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Judge&quot;                   
## [2] &quot;Product&quot;                 
## [3] &quot;Shiny&quot;                   
## [4] &quot;External color intensity&quot;
## [5] &quot;Color evenness&quot;</code></pre>
<p>In <code>sensory</code>, let’s rename <code>Judge</code> into <code>Panellist</code>, and <code>Product</code> into <code>Sample</code> (here we apply transformations without saving the results, so the original data set remains unchanged).</p>
<p>To do so, we indicate in <code>rename()</code> that <em>new_name</em> is replacing <em>old_name</em> as following <code>rename(newname = oldname)</code>. Additionally, we can apply multiple changes by simply separating them with a <code>,</code>:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data-manip.html#cb45-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="data-manip.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Panellist =</span> Judge, <span class="at">Sample =</span> Product) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="data-manip.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Panellist&quot;               
## [2] &quot;Sample&quot;                  
## [3] &quot;Shiny&quot;                   
## [4] &quot;External color intensity&quot;
## [5] &quot;Color evenness&quot;</code></pre>
<p>Alternatively, it is also possible to rename a column using its position:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="data-manip.html#cb47-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="data-manip.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Consumer =</span> <span class="dv">1</span>, <span class="at">Biscuit =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="data-manip.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Consumer&quot;                
## [2] &quot;Biscuit&quot;                 
## [3] &quot;Shiny&quot;                   
## [4] &quot;External color intensity&quot;
## [5] &quot;Color evenness&quot;</code></pre>
<p>If this procedure of renaming variables should be applied on many variables following a structured form (e.g. transforming names into snake_case, CamelCase, …, see <a href="https://en.wikipedia.org/wiki/Letter_case#Use_within_programming_languages">https://en.wikipedia.org/wiki/Letter_case#Use_within_programming_languages</a> for more information), the use of the <code>{janitor}</code> package comes handy thanks to its <code>clean_names()</code> function and the <code>case</code> parameter:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data-manip.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb49-2"><a href="data-manip.html#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="data-manip.html#cb49-3" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="data-manip.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>(<span class="at">case =</span> <span class="st">&quot;snake&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="data-manip.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code></pre></div>
<pre><code>## [1] &quot;judge&quot;                   
## [2] &quot;product&quot;                 
## [3] &quot;shiny&quot;                   
## [4] &quot;external_color_intensity&quot;
## [5] &quot;color_evenness&quot;</code></pre>
<p>Note that the <code>{janitor}</code> package offers many options, and although the transformation is performed here on all the variables, it is possible to apply it on certain variables only.</p>
</div>
<div id="re-organizing-columns" class="section level5 hasAnchor" number="4.2.1.1.2">
<h5><span class="header-section-number">4.2.1.1.2</span> Re-Organizing Columns<a href="data-manip.html#re-organizing-columns" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Another simple transformation consists in re-organizing the data set, either by re-ordering, adding, and/or removing columns.</p>
<p>For re-ordering columns, <code>relocate()</code> is being used. This function allows re-positioning a (set of) variable(s) before or after another variable. By re-using the <code>sensory</code> data set, let’s position all the variables starting with ‘Qty’ between <code>Product</code> and <code>Shiny</code>. This can be specified in two different ways, either by positioning them after <code>Product</code> or before <code>Shiny</code>:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="data-manip.html#cb51-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="data-manip.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Qty&quot;</span>), <span class="at">.after =</span> Product) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="data-manip.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span>
<span id="cb51-4"><a href="data-manip.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="data-manip.html#cb51-5" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="data-manip.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Qty&quot;</span>), <span class="at">.before =</span> Shiny) <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="data-manip.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Judge&quot;                     
## [2] &quot;Product&quot;                   
## [3] &quot;Qty of inclusions&quot;         
## [4] &quot;Qty of inclusions in mouth&quot;
## [5] &quot;Shiny&quot;</code></pre>
<pre><code>## [1] &quot;Judge&quot;                     
## [2] &quot;Product&quot;                   
## [3] &quot;Qty of inclusions&quot;         
## [4] &quot;Qty of inclusions in mouth&quot;
## [5] &quot;Shiny&quot;</code></pre>
</div>
<div id="removingselecting-columns" class="section level5 hasAnchor" number="4.2.1.1.3">
<h5><span class="header-section-number">4.2.1.1.3</span> Removing/Selecting Columns<a href="data-manip.html#removingselecting-columns" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Another very important function regarding columns transformation is the <code>select()</code> function from <code>{dplyr}</code> (see Section <a href="start-R.html#packages">2.2.1</a> for a justification of the particular writing <code>dplyr::select()</code>) which allows selecting a set of variables, by simply informing the variables that should be kept in the data. Let’s limit ourselves in selecting <code>Judge</code>, <code>Product</code>, and <code>Shiny</code>:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="data-manip.html#cb54-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="data-manip.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, Shiny)</span></code></pre></div>
<pre><code>## # A tibble: 99 × 3
##    Judge Product Shiny
##    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1 J01   P01      52.8
##  2 J01   P02      48.6
##  3 J01   P03      48  
##  4 J01   P04      46.2
##  5 J01   P05       0  
##  6 J01   P06       0  
##  7 J01   P07       5.4
##  8 J01   P08       0  
##  9 J01   P09       0  
## 10 J01   P10      53.4
## # … with 89 more rows</code></pre>
<p>When a long series of variables should be kept in the same order, the use of the <code>:</code> is used.</p>
<p>Let’s keep all the variables going from <code>Cereal flavor</code> to <code>Dairy flavor</code>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="data-manip.html#cb56-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="data-manip.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, <span class="st">`</span><span class="at">Cereal flavor</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">Dairy flavor</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tibble: 99 × 6
##    Judge Product Cereal flavo…¹ RawDo…² Fatty…³ Dairy…⁴
##    &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 J01   P01               24.6    28.2    13.8       0
##  2 J01   P02               25.8    28.8     7.2       0
##  3 J01   P03               30      26.4     0         0
##  4 J01   P04               16.2    28.2     0         0
##  5 J01   P05               21.6    27.6     6.6       0
##  6 J01   P06               28.8    27.6     0         0
##  7 J01   P07               18      21       6         0
##  8 J01   P08               23.4    27       7.2       0
##  9 J01   P09               28.8    26.4     7.2       0
## 10 J01   P10               32.4    27.6    12        21
## # … with 89 more rows, and abbreviated variable names
## #   ¹​`Cereal flavor`, ²​`RawDough flavor`,
## #   ³​`Fatty flavor`, ⁴​`Dairy flavor`</code></pre>
<p>However, when only one (or few) variable needs to be removed, it is easier to specify which one to remove rather than informing all the ones to keep. Such solution is then done using the <code>-</code> sign. The previous example can then be obtained using the following code:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="data-manip.html#cb58-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="data-manip.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Shiny, Melting))</span></code></pre></div>
<p>The selection process of variables can be further informed through functions such as <code>starts_with()</code>, <code>ends_with()</code>, and <code>contains()</code>, which all select variables that either starts, ends, or contains a certain character or sequence of character. To illustrate this, let’s only keep the variables that starts with ‘Qty’:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data-manip.html#cb59-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="data-manip.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Qty&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 99 × 2
##    `Qty of inclusions` `Qty of inclusions in mouth`
##                  &lt;dbl&gt;                        &lt;dbl&gt;
##  1                 9.6                         27.6
##  2                10.8                         22.2
##  3                 7.8                         10.2
##  4                 0                           13.2
##  5                 0                           18  
##  6                27.6                         26.4
##  7                 0                            9  
##  8                23.4                         25.8
##  9                21                           29.4
## 10                18                           30  
## # … with 89 more rows</code></pre>
<p>Rather than selecting variables based on their names, we can also select them based on their position (e.g. <code>dplyr::select(2:5)</code> to keep the variables that are at position 2 to 5).</p>
<p>Selection of variables can also be done using some <em>rules</em> thanks to the <code>where()</code> function. Let’s consider the situation in which we only want to keep the variables that are nominal (or <em>character</em> in R), which automatically keeps <code>Judge</code> and <code>Product</code>:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data-manip.html#cb61-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="data-manip.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.character))</span></code></pre></div>
<pre><code>## # A tibble: 99 × 2
##    Judge Product
##    &lt;chr&gt; &lt;chr&gt;  
##  1 J01   P01    
##  2 J01   P02    
##  3 J01   P03    
##  4 J01   P04    
##  5 J01   P05    
##  6 J01   P06    
##  7 J01   P07    
##  8 J01   P08    
##  9 J01   P09    
## 10 J01   P10    
## # … with 89 more rows</code></pre>
<p><code>dplyr::select()</code> is a very powerful function that facilitates the selection of complex variables through very intuitive functions. Ultimately, it can also be used to <code>relocate()</code> and even <code>rename()</code> variables, as shown in the example below:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="data-manip.html#cb63-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="data-manip.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Panellist =</span> Judge, <span class="at">Sample =</span> Product, Shiny<span class="sc">:</span>Thickness, <span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;olor&quot;</span>))</span></code></pre></div>
<p>More examples illustrating the use of <code>dplyr::select()</code> are provided throughout the book. In particular, in the next session, another important function called <code>across()</code> will be introduced. This function can also be associated with <code>dplyr::select()</code> to give even more freedom in our selection. An example of such application is given in …</p>
</div>
<div id="creating-columns" class="section level5 hasAnchor" number="4.2.1.1.4">
<h5><span class="header-section-number">4.2.1.1.4</span> Creating Columns<a href="data-manip.html#creating-columns" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In some cases, new variables need to be created from existing ones. Examples of such situations include taking the quadratic term of a sensory attribute to test for curvature, or simply considering a new variables as the sum or the subtraction between two (or more) others. Such creation of a variable is processed through the <code>mutate()</code> function from the <code>{dplyr}</code> package. This function takes as inputs the name of the variable to create, and the <em>formula</em> that defines that variable.</p>
<p>Let’s create two new variables, one called <code>Shiny2</code> which corresponds to <code>Shiny</code> squared up, and one called <code>StiMelt</code> which corresponds to <code>Sticky</code> + <code>Melting.</code> Since we only use these three variables, let’s first reduce the data set to these three variables with <code>select()</code> to improve readability:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="data-manip.html#cb64-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="data-manip.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Shiny, Sticky, Melting) <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="data-manip.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb64-4"><a href="data-manip.html#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Shiny2 =</span> Shiny<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb64-5"><a href="data-manip.html#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">StiMelt =</span> Sticky <span class="sc">+</span> Melting</span>
<span id="cb64-6"><a href="data-manip.html#cb64-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 99 × 5
##    Shiny Sticky Melting Shiny2 StiMelt
##    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1  52.8   37.2    33.6 2788.     70.8
##  2  48.6   35.4    36   2362.     71.4
##  3  48     37.2     8.4 2304      45.6
##  4  46.2   21.6    34.2 2134.     55.8
##  5   0     39      34.8    0      73.8
##  6   0     36      21.6    0      57.6
##  7   5.4   22.8    34.8   29.2    57.6
##  8   0     36.6    19.2    0      55.8
##  9   0     37.2    19.8    0      57  
## 10  53.4   35.4    32.4 2852.     67.8
## # … with 89 more rows</code></pre>
<blockquote>
<p>If you want to transform a variable, say by changing its type, or re-writing its content, you can use <code>mutate()</code> and assign to the new variable the same name as the original one. This will overwrite the existing column with the new one. To illustrate this, let’s transform <code>Product</code> from upper case to lower case only. This can be done by mutating <code>Product</code> into the lowercase version of <code>Product</code> (<code>tolower(Product)</code>):</p>
</blockquote>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="data-manip.html#cb66-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="data-manip.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Product =</span> <span class="fu">tolower</span>(Product))</span></code></pre></div>
<pre><code>## # A tibble: 99 × 34
##    Judge Product Shiny Extern…¹ Color…² Qty o…³ Surfa…⁴
##    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 J01   p01      52.8     30      22.8     9.6    22.8
##  2 J01   p02      48.6     30      13.2    10.8    13.2
##  3 J01   p03      48       45.6    17.4     7.8    14.4
##  4 J01   p04      46.2     45.6    37.8     0      48.6
##  5 J01   p05       0       23.4    49.2     0      12.6
##  6 J01   p06       0       50.4    24      27.6    39.6
##  7 J01   p07       5.4      6.6    17.4     0      36  
##  8 J01   p08       0       51.6    48.6    23.4    18  
##  9 J01   p09       0       42.6    18      21      36  
## 10 J01   p10      53.4     36.6    11.4    18      10.8
## # … with 89 more rows, 27 more variables:
## #   `Print quality` &lt;dbl&gt;, Thickness &lt;dbl&gt;,
## #   `Color contrast` &lt;dbl&gt;,
## #   `Overall odor intensity` &lt;dbl&gt;,
## #   `Fatty odor` &lt;dbl&gt;, `Roasted odor` &lt;dbl&gt;,
## #   `Cereal flavor` &lt;dbl&gt;, `RawDough flavor` &lt;dbl&gt;,
## #   `Fatty flavor` &lt;dbl&gt;, `Dairy flavor` &lt;dbl&gt;, …</code></pre>
<blockquote>
<p><code>mutate()</code> being one of the most important function from the <code>{dplyr}</code> package, more examples of its use are presented throughout this book.</p>
</blockquote>
<p>Since performing mathematical computations on non-numerical columns is not possible, conditions can easily be added through <code>mutate()</code> combined with <code>across()</code>. Let’s imagine we want to round all variables to 0 decimal, which can only be applied to numerical variables.
To do so, we <code>mutate()</code> <code>across()</code> all variables that are considered <code>as.numeric()</code> (using <code>where()</code>):</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="data-manip.html#cb68-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="data-manip.html#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="at">digits =</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>## # A tibble: 99 × 34
##    Judge Product Shiny Extern…¹ Color…² Qty o…³ Surfa…⁴
##    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 J01   P01        53       30      23      10      23
##  2 J01   P02        49       30      13      11      13
##  3 J01   P03        48       46      17       8      14
##  4 J01   P04        46       46      38       0      49
##  5 J01   P05         0       23      49       0      13
##  6 J01   P06         0       50      24      28      40
##  7 J01   P07         5        7      17       0      36
##  8 J01   P08         0       52      49      23      18
##  9 J01   P09         0       43      18      21      36
## 10 J01   P10        53       37      11      18      11
## # … with 89 more rows, 27 more variables:
## #   `Print quality` &lt;dbl&gt;, Thickness &lt;dbl&gt;,
## #   `Color contrast` &lt;dbl&gt;,
## #   `Overall odor intensity` &lt;dbl&gt;,
## #   `Fatty odor` &lt;dbl&gt;, `Roasted odor` &lt;dbl&gt;,
## #   `Cereal flavor` &lt;dbl&gt;, `RawDough flavor` &lt;dbl&gt;,
## #   `Fatty flavor` &lt;dbl&gt;, `Dairy flavor` &lt;dbl&gt;, …</code></pre>
<p>In case only a selection of numerical variables should be rounded, we could also replace <code>where(is.numeric)</code> by a vector (using <code>c()</code>) with the names of the variables to round.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="data-manip.html#cb70-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="data-manip.html#cb70-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Shiny, Sticky, Melting) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="data-manip.html#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;Shiny&quot;</span>, <span class="st">&quot;Sticky&quot;</span>), round, <span class="at">digits =</span> <span class="dv">0</span>))</span></code></pre></div>
</div>
<div id="merging-and-separating-columns" class="section level5 hasAnchor" number="4.2.1.1.5">
<h5><span class="header-section-number">4.2.1.1.5</span> Merging and Separating columns<a href="data-manip.html#merging-and-separating-columns" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>It can happen that some columns of a data set contain information (strings) that cover different types of information. For instance, we could imagine coding the name of our panelists as <em>FirstName_LastName</em> or <em>Gender_Name</em>, and we would want to separate them into two columns to make the distinction between the different information (i.e. <em>FirstName</em> and <em>LastName</em>, or <em>Gender</em> and <em>Name</em> respectively). In other situations, we may want to merge information present in multiple columns into one.</p>
<p>For illustration, let’s consider the information stored in the <em>Product Info</em> sheet from <em>biscuits_sensory_profile.xlsx</em>. This table includes information regarding the biscuits, and more precisely their Protein and Fiber content (Low or High).</p>
<p>After importing the data, let’s merge these two columns so that both information is stored in one column called <code>ProtFib</code>.
To do so, <code>unite()</code> (from <code>{tidyr}</code>) is used. This function takes as first element the name of the new variables, followed by all the columns to <em>unite</em>, and by providing the separation key to use between these elements (here <em>-</em>):</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="data-manip.html#cb71-1" aria-hidden="true" tabindex="-1"></a>(prod_info <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet =</span> <span class="st">&quot;Product Info&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="data-manip.html#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(ProtFib, Protein, Fiber, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 11 × 3
##    Product ProtFib   Type              
##    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;             
##  1 P01     Low-Low   Trial             
##  2 P02     Low-High  Trial             
##  3 P03     High-High Trial             
##  4 P04     High-High Trial             
##  5 P05     High-Low  Trial             
##  6 P06     High-Low  Trial             
##  7 P07     Low-High  Trial             
##  8 P08     High-Low  Trial             
##  9 P09     High-High Trial             
## 10 P10     Low-Low   Commercial product
## 11 POpt    High-Low  Optimized trial</code></pre>
<p>By default, <code>unite()</code> removes from the data set the individual variables that have been merged. To keep these original variables, the parameter <code>remove = FALSE</code> can be used.</p>
<blockquote>
<p>Although it is not relevant for combining columns, it is interesting to mention an additional package that can be used to combine elements together. This package is called <code>{glue}</code> and provides interesting alternatives to the usual <code>paste()</code> and <code>paste0()</code> functions.</p>
</blockquote>
<p>To reverse the changes (saved here in <code>prod_info</code>) and to separate a column into different variables, <code>separate()</code> (from <code>{tidyr}</code>) is used. Similarly to <code>unite()</code>, <code>separate()</code> takes as first parameter the name of the variable to split, followed by the names for the different segments generated, and of course the separator defined by <code>sep</code>.</p>
<p>In our example, this would be done as following:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="data-manip.html#cb73-1" aria-hidden="true" tabindex="-1"></a>prod_info <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="data-manip.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(ProtFib, <span class="fu">c</span>(<span class="st">&quot;Protein&quot;</span>, <span class="st">&quot;Fiber&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 11 × 4
##    Product Protein Fiber Type              
##    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;             
##  1 P01     Low     Low   Trial             
##  2 P02     Low     High  Trial             
##  3 P03     High    High  Trial             
##  4 P04     High    High  Trial             
##  5 P05     High    Low   Trial             
##  6 P06     High    Low   Trial             
##  7 P07     Low     High  Trial             
##  8 P08     High    Low   Trial             
##  9 P09     High    High  Trial             
## 10 P10     Low     Low   Commercial product
## 11 POpt    High    Low   Optimized trial</code></pre>
</div>
<div id="conditions" class="section level5 hasAnchor" number="4.2.1.1.6">
<h5><span class="header-section-number">4.2.1.1.6</span> Conditions<a href="data-manip.html#conditions" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In some cases, the new column to create depend directly on the value(s) of one or more columns present in the data.
An examples of such situations consists in categorizing a continuous variable into groups by converting the age (in year) of the participants into age groups. For such simple examples, some pre-existing functions (e.g. <code>cut()</code> in this situation) can be used.
However, in other situations, pre-defined functions do not exist and the transformation should be done <em>manually</em> using conditions.</p>
<p>Let’s illustrate this by converting the <code>Shiny</code> variable (from <code>sensory</code>) from numeric to classes.
Since the scale used is a 60pt scale, let’s start by creating a class called <em>Low</em> if the score is lower than 30, and <em>High</em> otherwise.</p>
<p>Here, pre-defined functions (e.g. <code>cut()</code>) are not being used intentionally as a manual transformation is preferred. Instead, <code>mutate()</code> is associated to <code>ifelse()</code>, which works as following: <code>ifelse(condition, results if condition is TRUE, results if condition is not TRUE)</code></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="data-manip.html#cb75-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="data-manip.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Shiny) <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="data-manip.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ShinyGroup =</span> <span class="fu">ifelse</span>(Shiny <span class="sc">&lt;</span> <span class="dv">30</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 99 × 2
##    Shiny ShinyGroup
##    &lt;dbl&gt; &lt;chr&gt;     
##  1  52.8 High      
##  2  48.6 High      
##  3  48   High      
##  4  46.2 High      
##  5   0   Low       
##  6   0   Low       
##  7   5.4 Low       
##  8   0   Low       
##  9   0   Low       
## 10  53.4 High      
## # … with 89 more rows</code></pre>
<p>Let’s imagine the same variable should now be split into three levels: <em>Low</em>, <em>Medium</em>, and <em>High</em>. Such additional group could be obtained by adding an <code>ifelse()</code> condition within the existing <code>ifelse()</code> condition (we use 48 instead of 40 for the upper limit to <code>Medium</code> so that results are displayed on screen):</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="data-manip.html#cb77-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="data-manip.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Shiny) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="data-manip.html#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ShinyGroup =</span> <span class="fu">ifelse</span>(Shiny <span class="sc">&lt;</span> <span class="dv">20</span>, <span class="st">&quot;Low&quot;</span>,</span>
<span id="cb77-4"><a href="data-manip.html#cb77-4" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(Shiny <span class="sc">&lt;</span> <span class="dv">48</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;High&quot;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 99 × 2
##    Shiny ShinyGroup
##    &lt;dbl&gt; &lt;chr&gt;     
##  1  52.8 High      
##  2  48.6 High      
##  3  48   High      
##  4  46.2 Medium    
##  5   0   Low       
##  6   0   Low       
##  7   5.4 Low       
##  8   0   Low       
##  9   0   Low       
## 10  53.4 High      
## # … with 89 more rows</code></pre>
<p>Since there are only 3 conditions in total here, only two entangled <code>ifelse()</code> are required. This makes the code still manageable. However, in more complex situations (say 10 different conditions are required), such solution quickly becomes tedious to read, to track, and to debug if errors are being made. Instead, the use of an alternative function called <code>case_when()</code> is preferred. In the previous case, the same conditions would be written as follow:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="data-manip.html#cb79-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="data-manip.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Shiny) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="data-manip.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ShinyGroup =</span> <span class="fu">case_when</span>(</span>
<span id="cb79-4"><a href="data-manip.html#cb79-4" aria-hidden="true" tabindex="-1"></a>    Shiny <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">&quot;Low&quot;</span>,</span>
<span id="cb79-5"><a href="data-manip.html#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(Shiny, <span class="dv">20</span>, <span class="dv">48</span>) <span class="sc">~</span> <span class="st">&quot;Medium&quot;</span>,</span>
<span id="cb79-6"><a href="data-manip.html#cb79-6" aria-hidden="true" tabindex="-1"></a>    Shiny <span class="sc">&gt;</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">&quot;High&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 99 × 2
##    Shiny ShinyGroup
##    &lt;dbl&gt; &lt;chr&gt;     
##  1  52.8 High      
##  2  48.6 High      
##  3  48   Medium    
##  4  46.2 Medium    
##  5   0   Low       
##  6   0   Low       
##  7   5.4 Low       
##  8   0   Low       
##  9   0   Low       
## 10  53.4 High      
## # … with 89 more rows</code></pre>
<p>This provides the same results as previously, except for the exact value 48 which was assigned as <em>High</em> in the <code>ifelse()</code> example and to <em>Medium</em> in the <code>case_when()</code> example. This is due to the way <code>between()</code><a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> considers its borders.</p>
</div>
</div>
<div id="handling-rows" class="section level4 hasAnchor" number="4.2.1.2">
<h4><span class="header-section-number">4.2.1.2</span> Handling Rows<a href="data-manip.html#handling-rows" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After manipulating columns, the next logical step is to manipulate rows. Such operations include three aspects:</p>
<ol style="list-style-type: decimal">
<li>Re-arranging the rows in a logical way;</li>
<li>Selecting certain rows;</li>
<li>Filtering entries based on given variables;</li>
<li>Splitting the data in sub-groups based on the entries of a given variable.</li>
</ol>
<div id="re-arranging-rows" class="section level5 hasAnchor" number="4.2.1.2.1">
<h5><span class="header-section-number">4.2.1.2.1</span> Re-arranging Rows<a href="data-manip.html#re-arranging-rows" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The first step of re-arranging rows is done through the <code>arrange()</code> function from the <code>{dplyr}</code> package. This function allows sorting the data in the ascending order<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>. To arrange them in a descending order, the function <code>desc()</code> is then required.</p>
<p>Let’s re-arrange the data by <code>Judge</code> and <code>Product</code>, <code>Judge</code> being sorted in an ascending order whereas <code>Product</code> is being sorted in a descending order:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="data-manip.html#cb81-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="data-manip.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Judge, <span class="fu">desc</span>(Product))</span></code></pre></div>
<pre><code>## # A tibble: 99 × 34
##    Judge Product Shiny Extern…¹ Color…² Qty o…³ Surfa…⁴
##    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 J01   POpt      4.8     33.6    15.6    32.4    13.8
##  2 J01   P10      53.4     36.6    11.4    18      10.8
##  3 J01   P09       0       42.6    18      21      36  
##  4 J01   P08       0       51.6    48.6    23.4    18  
##  5 J01   P07       5.4      6.6    17.4     0      36  
##  6 J01   P06       0       50.4    24      27.6    39.6
##  7 J01   P05       0       23.4    49.2     0      12.6
##  8 J01   P04      46.2     45.6    37.8     0      48.6
##  9 J01   P03      48       45.6    17.4     7.8    14.4
## 10 J01   P02      48.6     30      13.2    10.8    13.2
## # … with 89 more rows, 27 more variables:
## #   `Print quality` &lt;dbl&gt;, Thickness &lt;dbl&gt;,
## #   `Color contrast` &lt;dbl&gt;,
## #   `Overall odor intensity` &lt;dbl&gt;,
## #   `Fatty odor` &lt;dbl&gt;, `Roasted odor` &lt;dbl&gt;,
## #   `Cereal flavor` &lt;dbl&gt;, `RawDough flavor` &lt;dbl&gt;,
## #   `Fatty flavor` &lt;dbl&gt;, `Dairy flavor` &lt;dbl&gt;, …</code></pre>
</div>
<div id="selecting-rows" class="section level5 hasAnchor" number="4.2.1.2.2">
<h5><span class="header-section-number">4.2.1.2.2</span> Selecting Rows<a href="data-manip.html#selecting-rows" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The next step is to select a subset of the data by keeping certain rows only. If the position of the rows to keep is know, this information can be used directly using the <code>slice()</code> function. Let’s select from <code>sensory</code> all the data that is related to <code>P01</code>. A quick look at the data informs us that it corresponds to rows 1 to 89, with a step of 11:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="data-manip.html#cb83-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="data-manip.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">89</span>, <span class="dv">11</span>))</span></code></pre></div>
<pre><code>## # A tibble: 9 × 34
##   Judge Product Shiny Externa…¹ Color…² Qty o…³ Surfa…⁴
##   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 J01   P01      52.8      30      22.8     9.6    22.8
## 2 J02   P01      44.4      34.2    14.4    18.6    43.2
## 3 J03   P01      40.2      23.4     9       7.8    49.8
## 4 J04   P01      37.8      26.4    15      23.4    15.6
## 5 J05   P01      43.8      30      12.9     0      20.4
## 6 J06   P01      43.2      27      22.8    31.2    34.2
## 7 J07   P01      44.4      18.6    10.8    25.8    28.8
## 8 J08   P01      25.2      28.2     6.6    16.8    15  
## 9 J09   P01      45.6      18      28.2     6.6    19.8
## # … with 27 more variables: `Print quality` &lt;dbl&gt;,
## #   Thickness &lt;dbl&gt;, `Color contrast` &lt;dbl&gt;,
## #   `Overall odor intensity` &lt;dbl&gt;,
## #   `Fatty odor` &lt;dbl&gt;, `Roasted odor` &lt;dbl&gt;,
## #   `Cereal flavor` &lt;dbl&gt;, `RawDough flavor` &lt;dbl&gt;,
## #   `Fatty flavor` &lt;dbl&gt;, `Dairy flavor` &lt;dbl&gt;,
## #   `Roasted flavor` &lt;dbl&gt;, …</code></pre>
<p>This is a manual way to select data. However, this procedure may generate an erroneous subset in the case that the row order in the data changes. To avoid mistakes, a more <em>stable</em> procedure of filtering data is proposed in the next section.</p>
</div>
<div id="filtering-data" class="section level5 hasAnchor" number="4.2.1.2.3">
<h5><span class="header-section-number">4.2.1.2.3</span> Filtering Data<a href="data-manip.html#filtering-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To define sub-set of data, the <code>filter()</code> function is being used. This function requires providing an argument that is expressed as a <em>test</em>, meaning that the outcome should either be TRUE (keep the value) or FALSE (discard the value) when the condition is verified or not respectively. In R, this is expressed by the double ‘=’ sign <code>==</code>.</p>
<p>Let’s filter the data to only keep the data related to sample <code>P02</code>:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="data-manip.html#cb85-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="data-manip.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Product <span class="sc">==</span> <span class="st">&quot;P02&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 34
##   Judge Product Shiny Externa…¹ Color…² Qty o…³ Surfa…⁴
##   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 J01   P02      48.6      30      13.2    10.8    13.2
## 2 J02   P02      39.6      32.4    18      19.8    25.2
## 3 J03   P02      39        18.6    13.2     9      28.8
## 4 J04   P02      39.6      41.4    33      25.2    10.2
## 5 J05   P02      33.6      30.6    22.8     0      25.2
## 6 J06   P02      38.4      30.6    25.8    36      34.8
## 7 J07   P02      25.8      22.2    12.6    19.8    17.4
## 8 J08   P02      47.4      29.4    18       5.4    11.4
## 9 J09   P02      40.2      30.6    26.4     0      18.6
## # … with 27 more variables: `Print quality` &lt;dbl&gt;,
## #   Thickness &lt;dbl&gt;, `Color contrast` &lt;dbl&gt;,
## #   `Overall odor intensity` &lt;dbl&gt;,
## #   `Fatty odor` &lt;dbl&gt;, `Roasted odor` &lt;dbl&gt;,
## #   `Cereal flavor` &lt;dbl&gt;, `RawDough flavor` &lt;dbl&gt;,
## #   `Fatty flavor` &lt;dbl&gt;, `Dairy flavor` &lt;dbl&gt;,
## #   `Roasted flavor` &lt;dbl&gt;, …</code></pre>
<p>Other relevant test characters are the following:</p>
<ul>
<li><code>!Product == "P02"</code> or <code>Product != "P02"</code> means different from, and will keep all samples except <code>P02</code>;</li>
<li><code>%in% my_vector</code> keeps any value included within the vector <code>my_vector</code> (e.g. <code>Product %in% c("P01","P02","P03")</code> keeps all data from <code>P01</code>, <code>P02</code>, and <code>P03</code>)</li>
</ul>
<p>In some cases, the tests to perform are more complex as they require multiple conditions.
There are two forms of conditions:</p>
<ul>
<li><code>&amp;</code> (read <em>and</em>) is multiplicative, meaning that all the conditions need to be true (<code>Product == "P02" &amp; Shiny &gt; 40</code>);</li>
<li><code>|</code> (read <em>or</em>) is additive, meaning that only one of the conditions needs to be true (<code>Product == "P03" | Shiny &gt; 40</code>)</li>
</ul>
<p>This system of condition is particularly useful when you have missing values as you could remove all the rows that contain missing values for a given variable. Since we do not have missing values here, let’s create some by replacing all the evaluations for <code>Shiny</code> that are larger than 40 by missing values. This is done here using <code>ifelse()</code>, which takes three arguments (in this order): the test to perform (here <code>Shiny &gt; 40</code>), the instruction if the test passes (here replace with <code>NA</code>), and the instruction if the test doesn’t pass (here keep the value stored in <code>Shiny</code>).</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="data-manip.html#cb87-1" aria-hidden="true" tabindex="-1"></a>sensory_na <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="data-manip.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, Shiny) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="data-manip.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Shiny =</span> <span class="fu">ifelse</span>(Shiny <span class="sc">&gt;</span> <span class="dv">40</span>, <span class="cn">NA</span>, Shiny))</span></code></pre></div>
<p>In a second step, we filter out all missing values from <code>Shiny</code>. In practice, this is done by keeping all the values that are not missing:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="data-manip.html#cb88-1" aria-hidden="true" tabindex="-1"></a>sensory_na <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="data-manip.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Shiny))</span></code></pre></div>
<p>This procedure removed 20 rows since the original table had 99 rows and 3 columns, whereas the filtered table only has 79 rows and 3 columns.</p>
</div>
<div id="splitting-data" class="section level5 hasAnchor" number="4.2.1.2.4">
<h5><span class="header-section-number">4.2.1.2.4</span> Splitting Data<a href="data-manip.html#splitting-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>After filtering data, the next logical step is to split data into subsets based on a given variable (e.g. by gender). For such purpose, one could consider using <code>filter()</code> by applying it to each subgroup. In a previous example, this is what we have done when we filtered data for sample <code>P02</code> only. Of course, the same procedure can be performed until all the other sub-groups are created. However, this solution becomes tedious as the number of samples increases. Instead, we prefer to use <code>split()</code> which takes as arguments the data and the column to split from:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="data-manip.html#cb89-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="data-manip.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>Product)</span></code></pre></div>
<p>This function creates a list of <em>n</em> elements (<em>n</em> being the number of samples), each element corresponding to the data related to one sample. Such list can then be used in automated analyses by performing on each sub-data through the <code>map()</code> function, as it will be illustrated in section REF.</p>
</div>
</div>
</div>
<div id="pivots" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Reshaping Data<a href="data-manip.html#pivots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Reshaping the data itself is done through pivoting which allows transitioning from a long and thin table to a short and wide table and vice-versa.</p>
<p>To illustrate this, let’s start with a fictive example in which we have 3 consumers providing their liking scores for 2 products, This table corresponds to a long and thin format:</p>
<template id="e90b1632-8f7b-4a51-a79c-8f975da83d26"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b4bd7a9a{}.cl-b4b0dfa6{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b4b5e9a6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4b5e9b0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4b60c1a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4b60c24{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4b60c25{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4b60c26{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4b60c2e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4b60c2f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b4bd7a9a'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b4b60c1a"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">Consumer</span></p></th><th class="cl-b4b60c1a"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">Product</span></p></th><th class="cl-b4b60c24"><p class="cl-b4b5e9b0"><span class="cl-b4b0dfa6">Liking</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">C1</span></p></td><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">P1</span></p></td><td class="cl-b4b60c26"><p class="cl-b4b5e9b0"><span class="cl-b4b0dfa6">8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">C1</span></p></td><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">P2</span></p></td><td class="cl-b4b60c26"><p class="cl-b4b5e9b0"><span class="cl-b4b0dfa6">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">C2</span></p></td><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">P1</span></p></td><td class="cl-b4b60c26"><p class="cl-b4b5e9b0"><span class="cl-b4b0dfa6">9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">C2</span></p></td><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">P2</span></p></td><td class="cl-b4b60c26"><p class="cl-b4b5e9b0"><span class="cl-b4b0dfa6">6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">C3</span></p></td><td class="cl-b4b60c25"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">P1</span></p></td><td class="cl-b4b60c26"><p class="cl-b4b5e9b0"><span class="cl-b4b0dfa6">7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4b60c2e"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">C3</span></p></td><td class="cl-b4b60c2e"><p class="cl-b4b5e9a6"><span class="cl-b4b0dfa6">P2</span></p></td><td class="cl-b4b60c2f"><p class="cl-b4b5e9b0"><span class="cl-b4b0dfa6">4</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="20307f46-fac8-46dc-8a62-e89bae603c5e"></div>
<script>
var dest = document.getElementById("20307f46-fac8-46dc-8a62-e89bae603c5e");
var template = document.getElementById("e90b1632-8f7b-4a51-a79c-8f975da83d26");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>Let’s imagine we need to re-structure the data where products are displayed in rows, and consumers in columns. This corresponds to the short and wide format:</p>
<template id="b972ba1b-6959-49f9-aaac-f06bbfbaeb70"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b4dd98e8{}.cl-b4d10ede{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b4d5e210{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4d5e21a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4d603a8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4d603b2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4d603bc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4d603bd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4d603c6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4d603d0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b4dd98e8'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b4d603a8"><p class="cl-b4d5e210"><span class="cl-b4d10ede">Product</span></p></th><th class="cl-b4d603b2"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">C1</span></p></th><th class="cl-b4d603b2"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">C2</span></p></th><th class="cl-b4d603b2"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">C3</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b4d603bc"><p class="cl-b4d5e210"><span class="cl-b4d10ede">P1</span></p></td><td class="cl-b4d603bd"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">8</span></p></td><td class="cl-b4d603bd"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">9</span></p></td><td class="cl-b4d603bd"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4d603c6"><p class="cl-b4d5e210"><span class="cl-b4d10ede">P2</span></p></td><td class="cl-b4d603d0"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">5</span></p></td><td class="cl-b4d603d0"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">6</span></p></td><td class="cl-b4d603d0"><p class="cl-b4d5e21a"><span class="cl-b4d10ede">4</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="9cce9595-8603-4a79-9bd6-7ffcfb2639d5"></div>
<script>
var dest = document.getElementById("9cce9595-8603-4a79-9bd6-7ffcfb2639d5");
var template = document.getElementById("b972ba1b-6959-49f9-aaac-f06bbfbaeb70");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>As we will see in the following section, it is very easy to transition from one version to another thanks to <code>pivot_longer()</code> and <code>pivot_wider()</code>, both being functions from <code>{tidyr}</code>.</p>
<div id="pivotting-longer" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Pivotting Longer<a href="data-manip.html#pivotting-longer" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Currently, our <code>sensory</code> data table is a table in which we have as many rows as Judge x Product, the different attributes being spread across multiple columns. However, in certain situations, it is relevant to have all the attributes stacked vertically, meaning that the table will have Judge x Product x Attributes rows. Such simple transformation can be done with <code>pivot_longer()</code> which takes as inputs the attributes to pivot, the name of the variables that will contain these names (<code>names_to</code>), and the name of the column that will contain their entries (<code>values_to</code>)</p>
<blockquote>
<p>With <code>pivot_longer()</code> and any other function that requires selecting variables, it is often easier to deselect variables that we do not want to include rather than selecting all the variables of interest. Throughout the book, both solutions are being considered.</p>
</blockquote>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="data-manip.html#cb90-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="data-manip.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Shiny<span class="sc">:</span>Melting, <span class="at">names_to =</span> <span class="st">&quot;Attribute&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Score&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3,168 × 4
##    Judge Product Attribute                Score
##    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;                    &lt;dbl&gt;
##  1 J01   P01     Shiny                     52.8
##  2 J01   P01     External color intensity  30  
##  3 J01   P01     Color evenness            22.8
##  4 J01   P01     Qty of inclusions          9.6
##  5 J01   P01     Surface defects           22.8
##  6 J01   P01     Print quality             48.6
##  7 J01   P01     Thickness                 38.4
##  8 J01   P01     Color contrast            37.8
##  9 J01   P01     Overall odor intensity    16.8
## 10 J01   P01     Fatty odor                 6.6
## # … with 3,158 more rows</code></pre>
<p>This transformation converts a table of 99 rows and 34 columns into a table containing 3168 (99<em>32) rows and 4 columns.
In the pivoted table, the names of the variables (stored here in </em>Attribute*) are in the same order as presented in the original table.</p>
<p>In case the attribute names are following a standard structure, say “attribute_name modality” as is the case in <code>sensory</code> for some attributes, an additional parameter of <code>pivot_longer()</code> becomes handy as it can split the <code>Attribute</code> variable just created into say <code>Attribute</code> and <code>Modality</code>.</p>
<p>To illustrate this, let’s reduce <code>sensory</code> to <code>Judge</code>, <code>Product</code>, and all the variables that end with odor or flavor (all other variables being discarded). After pivoting the subset of columns, we automatically split the attribute names into <code>Attribute</code> and <code>Modality</code> by informing the separator between names (here, a space):</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="data-manip.html#cb92-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="data-manip.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, <span class="fu">ends_with</span>(<span class="st">&quot;odor&quot;</span>), <span class="fu">ends_with</span>(<span class="st">&quot;flavor&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="data-manip.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Judge, Product), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;Attribute&quot;</span>, <span class="st">&quot;Modality&quot;</span>), <span class="at">values_to =</span> <span class="st">&quot;Score&quot;</span>, <span class="at">names_sep =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 693 × 5
##    Judge Product Attribute Modality Score
##    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;
##  1 J01   P01     Fatty     odor       6.6
##  2 J01   P01     Roasted   odor      15.6
##  3 J01   P01     Cereal    flavor    24.6
##  4 J01   P01     RawDough  flavor    28.2
##  5 J01   P01     Fatty     flavor    13.8
##  6 J01   P01     Dairy     flavor     0  
##  7 J01   P01     Roasted   flavor    24.6
##  8 J01   P02     Fatty     odor       5.4
##  9 J01   P02     Roasted   odor      20.4
## 10 J01   P02     Cereal    flavor    25.8
## # … with 683 more rows</code></pre>
<p>This parameter combines both the power of <code>pivot_longer()</code> and <code>separate()</code> in one unique process.</p>
<p>Note that more complex transformations through the use of regular expressions (and the <code>names_pattern</code> option) can be considered. More information on this topic is provided in REF CHAPTER TEXTUAL (TO CHECK IF IT IS THE CASE!).</p>
<blockquote>
<p>It can happen that with <code>pivot_longer()</code>, further transformation performed on the long and thin table may not maintain their original order (usually, the names are re-ordered alphabetically). If such re-ordering should not happen as it would impact the final results, there is a simple work around that ensure that the order is kept. The solution simply consists in transforming the newly created variable as a factor which takes as levels the order of the elements as they were in the original data (use <code>fct_inorder()</code> to maintain the order as shown in the data). To illustrate this, let’s look at the two following results:</p>
</blockquote>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="data-manip.html#cb94-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="data-manip.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, Shiny, Salty, Bitter, Light) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="data-manip.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;Judge&quot;</span>, <span class="st">&quot;Product&quot;</span>), <span class="at">names_to =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Score&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="data-manip.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>Variable) <span class="sc">%&gt;%</span></span>
<span id="cb94-5"><a href="data-manip.html#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(.)</span>
<span id="cb94-6"><a href="data-manip.html#cb94-6" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb94-7"><a href="data-manip.html#cb94-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, Shiny, Salty, Bitter, Light) <span class="sc">%&gt;%</span></span>
<span id="cb94-8"><a href="data-manip.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;Judge&quot;</span>, <span class="st">&quot;Product&quot;</span>), <span class="at">names_to =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Score&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-9"><a href="data-manip.html#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="fu">fct_inorder</span>(Variable)) <span class="sc">%&gt;%</span></span>
<span id="cb94-10"><a href="data-manip.html#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>Variable) <span class="sc">%&gt;%</span></span>
<span id="cb94-11"><a href="data-manip.html#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(.)</span></code></pre></div>
<blockquote>
<p>Other examples using this trick will be used throughout this book (e.g. see Section REF)</p>
</blockquote>
<p>As an alternative to <code>pivot_longer()</code>, the package called <code>{reshape2}</code> provides a function called <code>melt()</code> which pivots automatically the entire set of numerical variables, the qualitative variables being considered as <em>id variables</em>. If performed on a matrix with row names, the new table will have two columns containing the row and column names.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="data-manip.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb95-2"><a href="data-manip.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">melt</span>(sensory)</span></code></pre></div>
</div>
<div id="pivotting-wider" class="section level4 hasAnchor" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Pivotting Wider<a href="data-manip.html#pivotting-wider" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The complementary/opposite function to <code>pivot_longer()</code> is <code>pivot_wider()</code>. This function pivots data horizontally, hence reducing the number of rows and increasing the number of columns. In this case, the two main parameters to provide is which column will provide the new columns to create (<code>name_from</code>), and what are the values to use to fill this table (<code>values_from</code>).</p>
<p>From the previous example, we could set <code>names_from = Attribute</code> and <code>values_from = Score</code> to return to the original format of <code>sensory</code>. However, let’s reduce the data set to <code>Product</code>, <code>Judge</code>, and <code>Shiny</code> only, and let’s pivot the <code>Judge</code> and <code>Shiny</code> columns:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="data-manip.html#cb96-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="data-manip.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, Shiny) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="data-manip.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Judge, <span class="at">values_from =</span> Shiny)</span></code></pre></div>
<pre><code>## # A tibble: 11 × 10
##    Product   J01   J02   J03   J04   J05   J06   J07
##    &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 P01      52.8  44.4  40.2  37.8  43.8  43.2  44.4
##  2 P02      48.6  39.6  39    39.6  33.6  38.4  25.8
##  3 P03      48    36    35.4  15    37.2  33    16.2
##  4 P04      46.2  36    48    38.4  47.4  37.8  27  
##  5 P05       0     5.4  35.4  10.2  21    17.4   0  
##  6 P06       0    13.8   0     0     7.8  21     5.4
##  7 P07       5.4  41.4  37.2  30.6  46.2  26.4  28.2
##  8 P08       0     0    21     7.8  13.8  15     0  
##  9 P09       0     0     0     0     9.6   9     6.6
## 10 P10      53.4  13.8  34.2  16.2  36    32.4   3  
## 11 POpt      4.8  10.2  36    12    17.4  13.2  10.2
## # … with 2 more variables: J08 &lt;dbl&gt;, J09 &lt;dbl&gt;</code></pre>
<p>This procedure creates a table with as many rows as there are products, and as many columns as there are panelists (+1 since the product information is also in a column).</p>
<p>These procedures are particularly useful in consumer studies, since <code>pivot_longer()</code> and <code>pivot_wider()</code> allows restructuring the data for analysis such as ANOVA (<code>pivot_longer()</code> output) and preference mapping or clustering (<code>pivot_wider()</code> structure).</p>
<p>It is important to notice that the <code>pivot_wider()</code> format potentially contains more data. Let’s imagine the sensory test was performed following an incomplete design, meaning that each panelist did not evaluate all the samples. Although the long and thin structure would not show missing values (the entire rows without data being removed), the shorter and larger version would contain missing values for the products that panelists did not evaluate. If the user wants to automatically replace these missing values with a fixed value, say, it is possible through the parameter <code>values_fill</code> (e.g. <code>values_fill=0</code> would replace each missing value with a 0). Additionally, after pivoting the data, if multiple entries exist for a combination row-column, <code>pivot_wider()</code> will return a list of elements. In the next Section, an example illustrating such situation and how to present it will be presented.</p>
</div>
</div>
<div id="transformation-that-alters-the-data" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Transformation that Alters the Data<a href="data-manip.html#transformation-that-alters-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some cases, the final table to generate requires altering the data, by (say) computing the mean across multiple values, or counting the number of occurrences of factor levels for instance. In other words, we summarize the information, which also tend to reduce the size of the table. It is hence no surprise that the function used for such data reduction is called <code>summarise()</code> (or <code>summarize()</code>, both notation work) and belongs to the <code>{dplyr}</code> package.</p>
<div id="introduction-to-summary-statistics" class="section level4 hasAnchor" number="4.2.3.1">
<h4><span class="header-section-number">4.2.3.1</span> Introduction to Summary Statistics<a href="data-manip.html#introduction-to-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In practice, <code>summarise()</code> applies a function (whether it is the <code>mean()</code>, or a simple count using <code>n()</code> for instance) on a set of values. Let’s compute the mean on all numerical variables of <code>sensory</code>:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="data-manip.html#cb98-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="data-manip.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 32
##   Shiny Exter…¹ Color…² Qty o…³ Surfa…⁴ Print…⁵ Thick…⁶
##   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1  23.9    33.7    28.2    20.6    23.3    40.7    25.5
## # … with 25 more variables: `Color contrast` &lt;dbl&gt;,
## #   `Overall odor intensity` &lt;dbl&gt;,
## #   `Fatty odor` &lt;dbl&gt;, `Roasted odor` &lt;dbl&gt;,
## #   `Cereal flavor` &lt;dbl&gt;, `RawDough flavor` &lt;dbl&gt;,
## #   `Fatty flavor` &lt;dbl&gt;, `Dairy flavor` &lt;dbl&gt;,
## #   `Roasted flavor` &lt;dbl&gt;,
## #   `Overall flavor persistence` &lt;dbl&gt;, Salty &lt;dbl&gt;, …</code></pre>
<p>As can be seen, the grand mean is computed for each attribute. It can also be noticed that all the other variables that were not involved have been removed (e.g. <code>Judge</code> and <code>Product</code> as they are not numerical variables).</p>
<p>If multiple functions should be applied, we could perform all the transformation simultaneously as following:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="data-manip.html#cb100-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="data-manip.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(<span class="at">min =</span> min, <span class="at">max =</span> max)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 64
##   Shiny_min Shiny_max Externa…¹ Exter…² Color…³ Color…⁴
##       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1         0        54       6.6    55.2     6.6    53.4
## # … with 58 more variables:
## #   `Qty of inclusions_min` &lt;dbl&gt;,
## #   `Qty of inclusions_max` &lt;dbl&gt;,
## #   `Surface defects_min` &lt;dbl&gt;,
## #   `Surface defects_max` &lt;dbl&gt;,
## #   `Print quality_min` &lt;dbl&gt;,
## #   `Print quality_max` &lt;dbl&gt;, Thickness_min &lt;dbl&gt;, …</code></pre>
<p>In this example, each attribute is duplicated with <code>_min</code> and <code>_max</code> to provide the minimum and maximum value for each attribute.</p>
<blockquote>
<p>It would be a good exercise to restructure this table using <code>pivot_longer()</code> with <code>names_sep</code> followed by <code>pivot_wider()</code> to build a new table that shows for each attribute (in rows) the minimum and the maximum in two different columns.</p>
</blockquote>
<p>By following the same principles, many other functions can be performed, whether they are built-in R or created by the user.</p>
<p>Here is a recommendation of interesting descriptive functions to consider with <code>summarise()</code>:</p>
<ul>
<li><code>mean()</code>, <code>median()</code> (or more generally <code>quantile()</code>) for the mean and median (or any other quantile);</li>
<li><code>sd()</code> and <code>var()</code> for the standard deviation and the variance;</li>
<li><code>min()</code>, <code>max()</code>, <code>range()</code> (provides both the min and max) or <code>diff(range())</code> (for the difference between min and max);</li>
<li><code>n()</code> and <code>sum()</code> for the number of counts and the sum respectively.</li>
</ul>
</div>
<div id="introduction-to-grouping" class="section level4 hasAnchor" number="4.2.3.2">
<h4><span class="header-section-number">4.2.3.2</span> Introduction to <em>grouping</em><a href="data-manip.html#introduction-to-grouping" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It can appear that the interest is not in the grand mean, but in the mean per product (say), or per product and panelist (for test with duplicates). In such cases, <code>summarize()</code> should aggregate set of values per product, or per product and panelist respectively. Such information can be passed on through <code>group_by()</code><a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="data-manip.html#cb102-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="data-manip.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Product) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="data-manip.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean)) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="data-manip.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 11 × 33
##    Product Shiny External col…¹ Color…² Qty o…³ Surfa…⁴
##    &lt;chr&gt;   &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 P01     41.9            26.2    15.8    15.5    27.7
##  2 P02     39.1            29.5    20.3    14      20.5
##  3 P03     30.5            43.6    30.7    17.6    18.6
##  4 P04     42.6            43.3    37.7    15.1    32.8
##  5 P05     13.9            17.3    36.1    26.7    19.5
##  6 P06      6.87           40.7    25.5    28      26.9
##  7 P07     32.5            24.1    22.9    17.9    21.9
##  8 P08      8.93           45.1    42.3    23.5    25.1
##  9 P09      3.53           39.9    27.7    22.3    22.6
## 10 P10     26.1            24.7    23.1    21.9    15.7
## 11 POpt    16.9            36.1    28.1    24.5    25.5
## # … with 27 more variables: `Print quality` &lt;dbl&gt;,
## #   Thickness &lt;dbl&gt;, `Color contrast` &lt;dbl&gt;,
## #   `Overall odor intensity` &lt;dbl&gt;,
## #   `Fatty odor` &lt;dbl&gt;, `Roasted odor` &lt;dbl&gt;,
## #   `Cereal flavor` &lt;dbl&gt;, `RawDough flavor` &lt;dbl&gt;,
## #   `Fatty flavor` &lt;dbl&gt;, `Dairy flavor` &lt;dbl&gt;,
## #   `Roasted flavor` &lt;dbl&gt;, …</code></pre>
<p>This procedure creates a tibble with 11 rows (product) and 33 columns (32 sensory attributes + 1 column including the product information) which contains the mean per attribute for each sample, also known as the sensory profiles of the products.</p>
<blockquote>
<p>In some cases, the data should not be aggregated across rows, but by rows. In such cases, it is important to specify that each computation should be done per row by using <code>rowwise()</code> prior to performing the transformation. For instance, if we would want to extract the minimum between <code>Shiny</code>, <code>Salty</code>, and <code>Bitter</code>, we could write the following code:</p>
</blockquote>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="data-manip.html#cb104-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="data-manip.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, Shiny, Salty, Bitter) <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="data-manip.html#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-4"><a href="data-manip.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Min =</span> <span class="fu">min</span>(Shiny, Salty, Bitter))</span></code></pre></div>
</div>
<div id="means" class="section level4 hasAnchor" number="4.2.3.3">
<h4><span class="header-section-number">4.2.3.3</span> Illustrations of Data Manipulation<a href="data-manip.html#means" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s review the different transformations presented here by generating the sensory profiles of the samples through different approaches<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>.</p>
<p>In the previous example, we’ve seen how to obtain the sensory profile using <code>summarise()</code> <code>across()</code> all numerical variables. In case a selection of the attributes should have been done, we could use the same process by simply informing which attributes to transform:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="data-manip.html#cb105-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="data-manip.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Product) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="data-manip.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(Shiny<span class="sc">:</span>Melting, mean)) <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="data-manip.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>The list of attributes to include can also be stored in an external vector:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="data-manip.html#cb106-1" aria-hidden="true" tabindex="-1"></a>sensory_attr <span class="ot">&lt;-</span> <span class="fu">colnames</span>(sensory)[<span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(sensory)]</span>
<span id="cb106-2"><a href="data-manip.html#cb106-2" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="data-manip.html#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Product) <span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="data-manip.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(sensory_attr), mean)) <span class="sc">%&gt;%</span></span>
<span id="cb106-5"><a href="data-manip.html#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>A different approach consists in combining <code>summarise()</code> to <code>pivot_longer()</code> and <code>pivot_wider()</code>. This process requires summarizing only one column by Product and Attribute:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="data-manip.html#cb107-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="data-manip.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Shiny<span class="sc">:</span>Melting, <span class="at">names_to =</span> <span class="st">&quot;Attribute&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Scores&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="data-manip.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Attribute =</span> <span class="fu">fct_inorder</span>(Attribute)) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="data-manip.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Product, Attribute) <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="data-manip.html#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Scores =</span> <span class="fu">mean</span>(Scores)) <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="data-manip.html#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Attribute, <span class="at">values_from =</span> Scores) <span class="sc">%&gt;%</span></span>
<span id="cb107-7"><a href="data-manip.html#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>Here, we transformed <code>Attribute</code> into a factor using <code>fct_inorder()</code> to ensure that the double pivoting procedure maintains the original order. Without this line of code, the final table would have the columns reordered alphabetically.</p>
<blockquote>
<p>As you can see, R provides the following message: <em><code>summarise()</code> has grouped output by ‘Product’. You can override using the <code>.groups</code> argument.</em> This message is just informative, and can be hidden by adding the following code at the start of your script: <code>options(dplyr.summarise.inform = FALSE)</code>.</p>
</blockquote>
<p>What would happen if we would omit to <code>summarise()</code> the data in between the two pivoting functions? In that case, we also remove the column <code>Judge</code> since the means should be computed across panelists…</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="data-manip.html#cb108-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb108-2"><a href="data-manip.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Shiny<span class="sc">:</span>Melting, <span class="at">names_to =</span> <span class="st">&quot;Attribute&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Scores&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="data-manip.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Judge) <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="data-manip.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Attribute, <span class="at">values_from =</span> Scores)</span></code></pre></div>
<p>As can be seen, each variable is of type list in which each cell contains <code>dbl [9]</code>: This corresponds to the scores provided by the 9 panelists to that product and that attribute. Since we would ultimately want the mean of these 9 values to generate the sensory profiles, a solution comes directly within <code>pivot_wider()</code> through the parameter <code>values_fn</code> which applies the function provided here on each set of values:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="data-manip.html#cb109-1" aria-hidden="true" tabindex="-1"></a>sensory <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="data-manip.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Shiny<span class="sc">:</span>Melting, <span class="at">names_to =</span> <span class="st">&quot;Attribute&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Scores&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="data-manip.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Judge) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="data-manip.html#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Attribute, <span class="at">values_from =</span> Scores, <span class="at">values_fn =</span> mean)</span></code></pre></div>
<p>Through this simple example, we’ve seen that the same results can be obtained through different ways. It is important to keep this in mind as you may find the solution to your own challenges by simply considering different paths.</p>
</div>
</div>
<div id="combining-data-from-different-sources" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Combining Data from Different Sources<a href="data-manip.html#combining-data-from-different-sources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It often happens that the data to analyze is stored in different files, and need to be combined or merged. Depending on the situations, different solutions are required.</p>
<div id="binding-vertically" class="section level4 hasAnchor" number="4.2.4.1">
<h4><span class="header-section-number">4.2.4.1</span> Binding Vertically<a href="data-manip.html#binding-vertically" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start with a simple example where the tables match in terms of variables, and should be combined vertically. To illustrate this situation, the data stored in the file <em>excel-scrap.xlsx</em> is used. This file contains a fictive example in which 12 assessors evaluated 2 samples on 3 attributes in triplicate, each replication being stored in a different sheet.</p>
<p>The goal here is to read the data stored in the different sheets, and to combine them vertically in one unique file for further analysis. Let’s start with importing the data:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="data-manip.html#cb110-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;excel_scrap.xlsx&quot;</span>)</span>
<span id="cb110-2"><a href="data-manip.html#cb110-2" aria-hidden="true" tabindex="-1"></a>session1 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(path, <span class="at">sheet =</span> <span class="dv">1</span>)</span>
<span id="cb110-3"><a href="data-manip.html#cb110-3" aria-hidden="true" tabindex="-1"></a>session2 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(path, <span class="at">sheet =</span> <span class="dv">2</span>)</span>
<span id="cb110-4"><a href="data-manip.html#cb110-4" aria-hidden="true" tabindex="-1"></a>session3 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(path, <span class="at">sheet =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>To combine the tables vertically, we could use the basic R function <code>rbind()</code>. However, we prefer to use <code>bind_rows()</code> from <code>{dplyr}</code> since it better controls for the columns by ensuring that the order is respected. Moreover, if one of the tables contains a variable that the other don’t, this variable will be kept and filled in with missing values when the information is missing. Additionally, we<code>bind_rows()</code> allows keeping track of the <em>origin</em> of the data through the parameter <code>.id</code>. This is of particular interest in this example since a new <code>Session</code> column can be created (and used) to distinguish between tables. This process is used to avoid losing such useful information especially since it is not directly available within the data: If it were, the parameter <code>.id</code> could have been ignored.</p>
<p>This solution works fine, especially since there were only 3 files to combine. Ultimately, we would prefer to automate the reading process so that all the files are directly imported and combined. This more efficient solution is presented in <a href="data-collection.html#import-mult-sheet">8.4.3</a>.</p>
</div>
<div id="binding-horizontally" class="section level4 hasAnchor" number="4.2.4.2">
<h4><span class="header-section-number">4.2.4.2</span> Binding Horizontally<a href="data-manip.html#binding-horizontally" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In other cases, the tables to combine contain different information (variables) on the same entities (rows), and the tables should be merged horizontally. To do so, a first solution consists in using the functions <code>cbind()</code> (<code>{base}</code>) and/or <code>bind_cols()</code> (<code>{dplyr}</code>) can be used. However, some of these functions require that the tables to combine must already have the rows in the exact same order (no check is being done) and must be of the same size.</p>
<p>If that is not the case, merging tables should be done using <code>merge()</code> (<code>{base}</code>), or preferably through the different <code>*_join()</code> functions from (<code>{dplyr}</code>). For illustration, let’s consider these two tables to merge:</p>
<template id="c80cabb5-f6d6-4076-9ad1-a7343e39be91"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b5a89db8{}.cl-b59b541e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5a0a798{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5a0a7ac{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5a0da9c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5a0daba{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5a0dac4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5a0dace{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5a0dacf{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5a0dad8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b5a89db8'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b5a0da9c"><p class="cl-b5a0a798"><span class="cl-b59b541e">Product</span></p></th><th class="cl-b5a0daba"><p class="cl-b5a0a7ac"><span class="cl-b59b541e">Var1</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b5a0dac4"><p class="cl-b5a0a798"><span class="cl-b59b541e">A</span></p></td><td class="cl-b5a0dace"><p class="cl-b5a0a7ac"><span class="cl-b59b541e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5a0dac4"><p class="cl-b5a0a798"><span class="cl-b59b541e">B</span></p></td><td class="cl-b5a0dace"><p class="cl-b5a0a7ac"><span class="cl-b59b541e">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5a0dacf"><p class="cl-b5a0a798"><span class="cl-b59b541e">C</span></p></td><td class="cl-b5a0dad8"><p class="cl-b5a0a7ac"><span class="cl-b59b541e">3</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="d4c7e718-47c9-4b95-ac6c-f65acf283cac"></div>
<script>
var dest = document.getElementById("d4c7e718-47c9-4b95-ac6c-f65acf283cac");
var template = document.getElementById("c80cabb5-f6d6-4076-9ad1-a7343e39be91");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<template id="83dcf368-7145-43ca-a6c9-e005509e7493"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b5be37f4{}.cl-b5b171fe{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5b6573c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5b65750{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5b677bc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5b677c6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5b677c7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5b677d0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5b677d1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5b677da{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b5be37f4'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b5b677bc"><p class="cl-b5b6573c"><span class="cl-b5b171fe">Product</span></p></th><th class="cl-b5b677c6"><p class="cl-b5b65750"><span class="cl-b5b171fe">Var2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b5b677c7"><p class="cl-b5b6573c"><span class="cl-b5b171fe">A</span></p></td><td class="cl-b5b677d0"><p class="cl-b5b65750"><span class="cl-b5b171fe">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5b677c7"><p class="cl-b5b6573c"><span class="cl-b5b171fe">B</span></p></td><td class="cl-b5b677d0"><p class="cl-b5b65750"><span class="cl-b5b171fe">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5b677d1"><p class="cl-b5b6573c"><span class="cl-b5b171fe">D</span></p></td><td class="cl-b5b677da"><p class="cl-b5b65750"><span class="cl-b5b171fe">4</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="bedaab15-a216-4b8c-83ec-ad4e59d2abcc"></div>
<script>
var dest = document.getElementById("bedaab15-a216-4b8c-83ec-ad4e59d2abcc");
var template = document.getElementById("83dcf368-7145-43ca-a6c9-e005509e7493");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>Depending on the <em>merging degree</em> to consider between tables X and Y, there are four different <code>*_join()</code> versions to consider:</p>
<ul>
<li><code>full_join()</code> keeps all the cases from X and Y regardless whether they are present in the other table or not (in case they are not present, missing values are introduced) [it corresponds to <code>merge(all=TRUE)</code>];</li>
</ul>
<template id="53aa1c8c-5076-4a7e-a6a6-1a717455d96f"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b5dced66{}.cl-b5d05132{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5d56b18{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5d56b2c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5d58b8e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5d58b98{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5d58ba2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5d58ba3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5d58bac{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5d58bad{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b5dced66'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b5d58b8e"><p class="cl-b5d56b18"><span class="cl-b5d05132">Product</span></p></th><th class="cl-b5d58b98"><p class="cl-b5d56b2c"><span class="cl-b5d05132">Var1</span></p></th><th class="cl-b5d58b98"><p class="cl-b5d56b2c"><span class="cl-b5d05132">Var2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b5d58ba2"><p class="cl-b5d56b18"><span class="cl-b5d05132">A</span></p></td><td class="cl-b5d58ba3"><p class="cl-b5d56b2c"><span class="cl-b5d05132">1</span></p></td><td class="cl-b5d58ba3"><p class="cl-b5d56b2c"><span class="cl-b5d05132">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5d58ba2"><p class="cl-b5d56b18"><span class="cl-b5d05132">B</span></p></td><td class="cl-b5d58ba3"><p class="cl-b5d56b2c"><span class="cl-b5d05132">2</span></p></td><td class="cl-b5d58ba3"><p class="cl-b5d56b2c"><span class="cl-b5d05132">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5d58ba2"><p class="cl-b5d56b18"><span class="cl-b5d05132">C</span></p></td><td class="cl-b5d58ba3"><p class="cl-b5d56b2c"><span class="cl-b5d05132">3</span></p></td><td class="cl-b5d58ba3"><p class="cl-b5d56b2c"><span class="cl-b5d05132"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5d58bac"><p class="cl-b5d56b18"><span class="cl-b5d05132">D</span></p></td><td class="cl-b5d58bad"><p class="cl-b5d56b2c"><span class="cl-b5d05132"></span></p></td><td class="cl-b5d58bad"><p class="cl-b5d56b2c"><span class="cl-b5d05132">4</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="36e22d4c-ff27-45da-a520-cb0242f4585b"></div>
<script>
var dest = document.getElementById("36e22d4c-ff27-45da-a520-cb0242f4585b");
var template = document.getElementById("53aa1c8c-5076-4a7e-a6a6-1a717455d96f");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<ul>
<li><code>inner_join()</code> only keeps the common cases, i.e. cases that are present in both X and Y [corresponds to <code>merge(all=FALSE)</code>];</li>
</ul>
<template id="cf5cce85-0015-45d3-bc2c-7960c80a8acd"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b5f9d660{}.cl-b5ecf9fe{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5f22a32{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5f22a3c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5f24d28{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5f24d32{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5f24d3c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5f24d46{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5f24d47{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5f24d50{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b5f9d660'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b5f24d28"><p class="cl-b5f22a32"><span class="cl-b5ecf9fe">Product</span></p></th><th class="cl-b5f24d32"><p class="cl-b5f22a3c"><span class="cl-b5ecf9fe">Var1</span></p></th><th class="cl-b5f24d32"><p class="cl-b5f22a3c"><span class="cl-b5ecf9fe">Var2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b5f24d3c"><p class="cl-b5f22a32"><span class="cl-b5ecf9fe">A</span></p></td><td class="cl-b5f24d46"><p class="cl-b5f22a3c"><span class="cl-b5ecf9fe">1</span></p></td><td class="cl-b5f24d46"><p class="cl-b5f22a3c"><span class="cl-b5ecf9fe">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5f24d47"><p class="cl-b5f22a32"><span class="cl-b5ecf9fe">B</span></p></td><td class="cl-b5f24d50"><p class="cl-b5f22a3c"><span class="cl-b5ecf9fe">2</span></p></td><td class="cl-b5f24d50"><p class="cl-b5f22a3c"><span class="cl-b5ecf9fe">2</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="3a64f83b-596a-41aa-b0d4-3acebd85109f"></div>
<script>
var dest = document.getElementById("3a64f83b-596a-41aa-b0d4-3acebd85109f");
var template = document.getElementById("cf5cce85-0015-45d3-bc2c-7960c80a8acd");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<ul>
<li><code>left_join()</code> keeps all the cases from X [corresponds to <code>merge(all.x=TRUE, all.y=FALSE)</code>];</li>
</ul>
<template id="0ac39a38-70a1-45d8-a39b-5099cfd2f219"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b617fa3c{}.cl-b60bbbaa{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b6108b26{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b6108b3a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b610acc8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b610acd2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b610acdc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b610ace6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b610ace7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b610acf0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b617fa3c'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b610acc8"><p class="cl-b6108b26"><span class="cl-b60bbbaa">Product</span></p></th><th class="cl-b610acd2"><p class="cl-b6108b3a"><span class="cl-b60bbbaa">Var1</span></p></th><th class="cl-b610acd2"><p class="cl-b6108b3a"><span class="cl-b60bbbaa">Var2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b610acdc"><p class="cl-b6108b26"><span class="cl-b60bbbaa">A</span></p></td><td class="cl-b610ace6"><p class="cl-b6108b3a"><span class="cl-b60bbbaa">1</span></p></td><td class="cl-b610ace6"><p class="cl-b6108b3a"><span class="cl-b60bbbaa">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b610acdc"><p class="cl-b6108b26"><span class="cl-b60bbbaa">B</span></p></td><td class="cl-b610ace6"><p class="cl-b6108b3a"><span class="cl-b60bbbaa">2</span></p></td><td class="cl-b610ace6"><p class="cl-b6108b3a"><span class="cl-b60bbbaa">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b610ace7"><p class="cl-b6108b26"><span class="cl-b60bbbaa">C</span></p></td><td class="cl-b610acf0"><p class="cl-b6108b3a"><span class="cl-b60bbbaa">3</span></p></td><td class="cl-b610acf0"><p class="cl-b6108b3a"><span class="cl-b60bbbaa"></span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="e0463038-ca22-47be-91c5-5178b25e8eaf"></div>
<script>
var dest = document.getElementById("e0463038-ca22-47be-91c5-5178b25e8eaf");
var template = document.getElementById("0ac39a38-70a1-45d8-a39b-5099cfd2f219");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<ul>
<li><code>right_join()</code> keeps all the cases from Y [corresponds to <code>merge(all.x=FALSE, all.y=TRUE)</code>];</li>
</ul>
<template id="57d7877c-b612-47fe-be4c-0aa8f276559d"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b6366152{}.cl-b628536e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b62d78b2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b62d78bc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b62d9ea0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b62d9eaa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b62d9eab{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b62d9eb4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b62d9eb5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b62d9eb6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b6366152'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b62d9ea0"><p class="cl-b62d78b2"><span class="cl-b628536e">Product</span></p></th><th class="cl-b62d9eaa"><p class="cl-b62d78bc"><span class="cl-b628536e">Var1</span></p></th><th class="cl-b62d9eaa"><p class="cl-b62d78bc"><span class="cl-b628536e">Var2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b62d9eab"><p class="cl-b62d78b2"><span class="cl-b628536e">A</span></p></td><td class="cl-b62d9eb4"><p class="cl-b62d78bc"><span class="cl-b628536e">1</span></p></td><td class="cl-b62d9eb4"><p class="cl-b62d78bc"><span class="cl-b628536e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b62d9eab"><p class="cl-b62d78b2"><span class="cl-b628536e">B</span></p></td><td class="cl-b62d9eb4"><p class="cl-b62d78bc"><span class="cl-b628536e">2</span></p></td><td class="cl-b62d9eb4"><p class="cl-b62d78bc"><span class="cl-b628536e">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b62d9eb5"><p class="cl-b62d78b2"><span class="cl-b628536e">D</span></p></td><td class="cl-b62d9eb6"><p class="cl-b62d78bc"><span class="cl-b628536e"></span></p></td><td class="cl-b62d9eb6"><p class="cl-b62d78bc"><span class="cl-b628536e">4</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="3b347975-f669-46f3-874c-9c30c9ebd09c"></div>
<script>
var dest = document.getElementById("3b347975-f669-46f3-874c-9c30c9ebd09c");
var template = document.getElementById("57d7877c-b612-47fe-be4c-0aa8f276559d");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<ul>
<li><code>anti_join()</code> only keeps the elements from X that are not present in Y (this is particularly useful if you have a tibble Y of elements that you would like to remove from X).</li>
</ul>
<template id="da2b231d-b986-4639-8b58-83fad94f8fbf"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-b651be66{}.cl-b644b2c0{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b64a0748{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b64a075c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b64a2520{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b64a252a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b64a2534{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b64a2535{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-b651be66'><thead><tr style="overflow-wrap:break-word;"><th class="cl-b64a2520"><p class="cl-b64a0748"><span class="cl-b644b2c0">Product</span></p></th><th class="cl-b64a252a"><p class="cl-b64a075c"><span class="cl-b644b2c0">Var1</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b64a2534"><p class="cl-b64a0748"><span class="cl-b644b2c0">C</span></p></td><td class="cl-b64a2535"><p class="cl-b64a075c"><span class="cl-b644b2c0">3</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="77c00fb4-ab8c-4d8c-9377-ca48bf90e75d"></div>
<script>
var dest = document.getElementById("77c00fb4-ab8c-4d8c-9377-ca48bf90e75d");
var template = document.getElementById("da2b231d-b986-4639-8b58-83fad94f8fbf");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>The merging procedure requires the users to provide a <em>key</em>, i.e. a (set of) variable(s) used to combine the tables. For each unique element defined by the key, a line is being created. When needed, rows of a table are being duplicated. Within the different <code>*_join()</code> functions, the key is informed by the <code>by</code> parameter, which may contain one or more variables with the same or different names.</p>
<p>For illustration, let’s use the data set called <em>biscuits_consumer_test.xlsx</em>, which contains three tabs:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="data-manip.html#cb111-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;biscuits_consumer_test.xlsx&quot;</span>)</span>
<span id="cb111-2"><a href="data-manip.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">excel_sheets</span>(file_path)</span></code></pre></div>
<pre><code>## [1] &quot;Biscuits&quot;         &quot;Time Consumption&quot;
## [3] &quot;Weight&quot;</code></pre>
<p>The three sheets contain the following information, which need to be combined:</p>
<ul>
<li><em>Biscuits</em>: The consumers’ evaluation of the 10 products and their assessment on liking, hunger, etc. at different moments of the test.</li>
<li><em>Time Consumption</em>: The amount of cookies and the time required to evaluate them in each sitting.</li>
<li><em>Weight</em>: The weight associated to each cookie.</li>
</ul>
<p>Let’s start by combining <em>Time Consumption</em> and <em>Weight</em> so that we can compute the total weight of biscuits eaten by each consumer in each sitting. In this case, the joining procedure is done by <code>Product</code> since the weight is only provided for each product. The total weight eaten (<code>Amount</code>) is then computed by multiplying the number of cookies eaten (<code>Nb biscuits</code>) by <code>Weight</code>:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="data-manip.html#cb113-1" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet =</span> <span class="st">&quot;Time Consumption&quot;</span>)</span>
<span id="cb113-2"><a href="data-manip.html#cb113-2" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet =</span> <span class="st">&quot;Weight&quot;</span>)</span>
<span id="cb113-3"><a href="data-manip.html#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="data-manip.html#cb113-4" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> time <span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="data-manip.html#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(weight, <span class="at">by =</span> <span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-6"><a href="data-manip.html#cb113-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Amount =</span> <span class="st">`</span><span class="at">Nb biscuits</span><span class="st">`</span> <span class="sc">*</span> Weight)</span></code></pre></div>
<p>As can be seen, the <code>Weight</code> information stored in the <em>Weight</em> sheet has been replicated every time each sample has been evaluated by another respondent.</p>
<p>The next step is then to merge this table to <code>Biscuits</code>. In this case, since both data set contain the full evaluation of the cookies (each consumer evaluating each product), the joining procedure needs to be done by <code>Judge</code> and <code>Product</code> simultaneously. A quick look at the data shows two important things:</p>
<ol style="list-style-type: decimal">
<li>In <em>Biscuits</em>, the consumer names only contain the numbers whereas in <code>consumption</code>, they also contain a <code>J</code> in front of the name: This needs to be fixed as the names need to be identical to be merged, else they will be considered separately and missing values will be introduced. In practice, this will be done by mutating <code>Consumer</code> and by pasting a <code>J</code> in front of the number using the function <code>paste0()</code>.</li>
<li>The names that contain the product (<code>Samples</code> and <code>Product</code>) and consumers (<code>Consumer</code> and <code>Judge</code>) information are different in both data set. We could rename these columns in one data set to match the other, but instead we will keep the two names and inform it within <code>full_join()</code>. This is done through the <code>by</code> parameter as following: <code>"name in dataset 1" = "name in dataset 2"</code></li>
</ol>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="data-manip.html#cb114-1" aria-hidden="true" tabindex="-1"></a>biscuits <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet =</span> <span class="st">&quot;Biscuits&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="data-manip.html#cb114-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">Consumer =</span> <span class="fu">str_c</span>(<span class="st">&quot;J&quot;</span>, Consumer)) <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="data-manip.html#cb114-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">full_join</span>(consumption, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Consumer&quot;</span> <span class="ot">=</span> <span class="st">&quot;Judge&quot;</span>, <span class="st">&quot;Samples&quot;</span> <span class="ot">=</span> <span class="st">&quot;Product&quot;</span>))</span></code></pre></div>
<p>The three data sets are now flawlessly joined into one that can be further manipulated and/or analysed.</p>

</div>
</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Wickham2014" class="csl-entry">
Wickham, Hadley. 2014. <span>“<span class="nocase">Tidy data</span>.”</span> <em>Journal of Statistical Software</em> 59 (1): 1–23.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>Note that some of the examples presented in this chapter emphasize the <em>how to?</em>, not the <em>why?</em>, and are not necessarily chosen to convey a scientific meaning.<a href="data-manip.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>For more details about the data set and/or data importation, please see Section <a href="data-collection.html#data-import">8.4</a>.<a href="data-manip.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>By default, <code>between(x, value1, value2)</code> considers value1 &lt;= x &lt;= value2.<a href="data-manip.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>For numerical order, this is simply re-arranging the values from the lowest to the highest. For strings, the entries are then sorted alphabetically unless the variable is a factor in which case the order of the levels for that factor is being used.<a href="data-manip.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>We strongly recommend you to <code>ungroup()</code> blocks of code that includes <code>group_by()</code> once the computations are done to avoid any unexpected results. Otherwise, further computations may be done on the groups when it should be performed on the full data.<a href="data-manip.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>It is important to realize that any data manipulation challenge can be tackled in many different ways, so don’t be afraid to think out of the box when solving them.<a href="data-manip.html#fnref19" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data_science.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-viz.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/04-data-manip.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
