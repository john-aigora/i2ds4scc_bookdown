<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Manipulation | Data Science for Sensory and Consumer Scientists</title>
  <meta name="description" content="Open development of data science book for sensory and consumer scientists." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Manipulation | Data Science for Sensory and Consumer Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Open development of data science book for sensory and consumer scientists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Manipulation | Data Science for Sensory and Consumer Scientists" />
  
  <meta name="twitter:description" content="Open development of data science book for sensory and consumer scientists." />
  

<meta name="author" content="John Ennis, Julien Delarue, and Thierry Worch" />


<meta name="date" content="2021-04-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tidy-thoughts.html"/>
<link rel="next" href="data-viz.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Sensory and Consumer Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-read-this-book"><i class="fa fa-check"></i>Who Should Read This Book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to Use This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cautions-dont-that-everybody-does"><i class="fa fa-check"></i>Cautions: Don’t that Everybody Does</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contact-us"><i class="fa fa-check"></i>How to Contact Us</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="bienvenue.html"><a href="bienvenue.html"><i class="fa fa-check"></i><b>1</b> Bienvenue!</a>
<ul>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#why-data-science-for-sensory-and-consumer-science"><i class="fa fa-check"></i>Why Data Science for Sensory and Consumer Science?</a>
<ul>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#core-principles-in-sensory-and-consumer-science"><i class="fa fa-check"></i>Core principles in Sensory and Consumer Science</a></li>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#measuring-and-analyzing-human-responses"><i class="fa fa-check"></i>Measuring and analyzing human responses</a></li>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#computational-sensory-science"><i class="fa fa-check"></i>Computational Sensory Science</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Hors d’Oeuvres</b></span></li>
<li class="chapter" data-level="2" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>2</b> Why Data Science?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-science.html"><a href="data-science.html#history-and-definition"><i class="fa fa-check"></i><b>2.1</b> History and Definition</a></li>
<li class="chapter" data-level="2.2" data-path="data-science.html"><a href="data-science.html#benefits-of-data-science"><i class="fa fa-check"></i><b>2.2</b> Benefits of Data Science</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-science.html"><a href="data-science.html#reproducible-research"><i class="fa fa-check"></i><b>2.2.1</b> Reproducible Research</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-science.html"><a href="data-science.html#standardized-reporting"><i class="fa fa-check"></i><b>2.2.2</b> Standardized Reporting</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-science.html"><a href="data-science.html#data-driven-decision-making"><i class="fa fa-check"></i><b>2.2.3</b> Data-Driven Decision Making</a></li>
<li class="chapter" data-level="2.2.4" data-path="data-science.html"><a href="data-science.html#standardized-data-collection"><i class="fa fa-check"></i><b>2.2.4</b> Standardized Data Collection</a></li>
<li class="chapter" data-level="2.2.5" data-path="data-science.html"><a href="data-science.html#improved-business-impact"><i class="fa fa-check"></i><b>2.2.5</b> Improved Business Impact</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-science.html"><a href="data-science.html#data-scientific-workflow"><i class="fa fa-check"></i><b>2.3</b> Data Scientific Workflow</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-science.html"><a href="data-science.html#data-collection2"><i class="fa fa-check"></i><b>2.3.1</b> Data Collection</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-science.html"><a href="data-science.html#data-preparation"><i class="fa fa-check"></i><b>2.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-science.html"><a href="data-science.html#data-analysis2"><i class="fa fa-check"></i><b>2.3.3</b> Data Analysis</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-science.html"><a href="data-science.html#value-delivery2"><i class="fa fa-check"></i><b>2.3.4</b> Value Delivery</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-science.html"><a href="data-science.html#reproducible-research-1"><i class="fa fa-check"></i><b>2.4</b> Reproducible Research</a></li>
<li class="chapter" data-level="2.5" data-path="data-science.html"><a href="data-science.html#how-to-learn-data-science"><i class="fa fa-check"></i><b>2.5</b> How to Learn Data Science</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidy-thoughts.html"><a href="tidy-thoughts.html"><i class="fa fa-check"></i><b>3</b> Tidy Thinking</a></li>
<li class="chapter" data-level="4" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manip.html"><a href="data-manip.html#tidying-data"><i class="fa fa-check"></i><b>4.1</b> Tidying Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-manip.html"><a href="data-manip.html#transformation-without-altering-the-data"><i class="fa fa-check"></i><b>4.1.1</b> Transformation without Altering the Data</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-manip.html"><a href="data-manip.html#transformation-that-alters-the-data"><i class="fa fa-check"></i><b>4.1.2</b> Transformation that Alters the Data</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-manip.html"><a href="data-manip.html#handling-lists-of-tables"><i class="fa fa-check"></i><b>4.1.3</b> Handling Lists of Tables</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-manip.html"><a href="data-manip.html#illustration"><i class="fa fa-check"></i><b>4.2</b> Illustration</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-viz.html"><a href="data-viz.html#design-principles"><i class="fa fa-check"></i><b>5.1</b> Design Principles</a></li>
<li class="chapter" data-level="5.2" data-path="data-viz.html"><a href="data-viz.html#table-making"><i class="fa fa-check"></i><b>5.2</b> Table Making</a></li>
<li class="chapter" data-level="5.3" data-path="data-viz.html"><a href="data-viz.html#chart-making"><i class="fa fa-check"></i><b>5.3</b> Chart Making</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-viz.html"><a href="data-viz.html#philosophy-of-ggplot2"><i class="fa fa-check"></i><b>5.3.1</b> Philosophy of ggplot2</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-viz.html"><a href="data-viz.html#common-charts"><i class="fa fa-check"></i><b>5.3.2</b> Common Charts</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-viz.html"><a href="data-viz.html#additional-topics"><i class="fa fa-check"></i><b>5.3.3</b> Additional Topics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="auto-report.html"><a href="auto-report.html"><i class="fa fa-check"></i><b>6</b> Automated Reporting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="auto-report.html"><a href="auto-report.html#what-is-automated-reporting"><i class="fa fa-check"></i><b>6.1</b> What is Automated Reporting?</a></li>
<li class="chapter" data-level="6.2" data-path="auto-report.html"><a href="auto-report.html#excel"><i class="fa fa-check"></i><b>6.2</b> Excel</a></li>
<li class="chapter" data-level="6.3" data-path="auto-report.html"><a href="auto-report.html#powerpoint"><i class="fa fa-check"></i><b>6.3</b> PowerPoint</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="auto-report.html"><a href="auto-report.html#powerpoint-formatting"><i class="fa fa-check"></i><b>6.3.1</b> PowerPoint Formatting</a></li>
<li class="chapter" data-level="6.3.2" data-path="auto-report.html"><a href="auto-report.html#placeholders"><i class="fa fa-check"></i><b>6.3.2</b> Placeholders</a></li>
<li class="chapter" data-level="6.3.3" data-path="auto-report.html"><a href="auto-report.html#text-1"><i class="fa fa-check"></i><b>6.3.3</b> Text</a></li>
<li class="chapter" data-level="6.3.4" data-path="auto-report.html"><a href="auto-report.html#tables"><i class="fa fa-check"></i><b>6.3.4</b> Tables</a></li>
<li class="chapter" data-level="6.3.5" data-path="auto-report.html"><a href="auto-report.html#charts"><i class="fa fa-check"></i><b>6.3.5</b> Charts</a></li>
<li class="chapter" data-level="6.3.6" data-path="auto-report.html"><a href="auto-report.html#mschart-package"><i class="fa fa-check"></i><b>6.3.6</b> mschart Package</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="auto-report.html"><a href="auto-report.html#word"><i class="fa fa-check"></i><b>6.4</b> Word</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="auto-report.html"><a href="auto-report.html#word-documents"><i class="fa fa-check"></i><b>6.4.1</b> Word documents</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Bon Appétit</b></span></li>
<li class="chapter" data-level="7" data-path="example-projects.html"><a href="example-projects.html"><i class="fa fa-check"></i><b>7</b> Example Projects</a></li>
<li class="chapter" data-level="8" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>8</b> Data Collection</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-collection.html"><a href="data-collection.html#design-1"><i class="fa fa-check"></i><b>8.1</b> Design</a></li>
<li class="chapter" data-level="8.2" data-path="data-collection.html"><a href="data-collection.html#execute-1"><i class="fa fa-check"></i><b>8.2</b> Execute</a></li>
<li class="chapter" data-level="8.3" data-path="data-collection.html"><a href="data-collection.html#import-1"><i class="fa fa-check"></i><b>8.3</b> Import</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-collection.html"><a href="data-collection.html#importing-structured-excel-file"><i class="fa fa-check"></i><b>8.3.1</b> Importing Structured Excel File</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-collection.html"><a href="data-collection.html#importing-unstructured-excel-file"><i class="fa fa-check"></i><b>8.3.2</b> Importing Unstructured Excel File</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>9</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-prep.html"><a href="data-prep.html#inspect-1"><i class="fa fa-check"></i><b>9.1</b> Inspect</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-prep.html"><a href="data-prep.html#data-inspection"><i class="fa fa-check"></i><b>9.1.1</b> Data Inspection</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-prep.html"><a href="data-prep.html#design-inspection"><i class="fa fa-check"></i><b>9.1.2</b> Design Inspection</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-prep.html"><a href="data-prep.html#missing-data-inspection"><i class="fa fa-check"></i><b>9.1.3</b> Missing Data Inspection</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-prep.html"><a href="data-prep.html#clean-1"><i class="fa fa-check"></i><b>9.2</b> Clean</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-prep.html"><a href="data-prep.html#renaming-variables"><i class="fa fa-check"></i><b>9.2.1</b> Renaming Variables</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-prep.html"><a href="data-prep.html#handling-data-type"><i class="fa fa-check"></i><b>9.2.2</b> Handling Data Type</a></li>
<li class="chapter" data-level="9.2.3" data-path="data-prep.html"><a href="data-prep.html#converting-between-types"><i class="fa fa-check"></i><b>9.2.3</b> Converting between Types</a></li>
<li class="chapter" data-level="9.2.4" data-path="data-prep.html"><a href="data-prep.html#handling-missing-values"><i class="fa fa-check"></i><b>9.2.4</b> Handling Missing Values</a></li>
<li class="chapter" data-level="9.2.5" data-path="data-prep.html"><a href="data-prep.html#restructuring-data"><i class="fa fa-check"></i><b>9.2.5</b> Restructuring Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>10</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-analysis.html"><a href="data-analysis.html#transform-1"><i class="fa fa-check"></i><b>10.1</b> Transform</a></li>
<li class="chapter" data-level="10.2" data-path="data-analysis.html"><a href="data-analysis.html#explore-1"><i class="fa fa-check"></i><b>10.2</b> Explore</a></li>
<li class="chapter" data-level="10.3" data-path="data-analysis.html"><a href="data-analysis.html#model-1"><i class="fa fa-check"></i><b>10.3</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="value-delivery.html"><a href="value-delivery.html"><i class="fa fa-check"></i><b>11</b> Value Delivery</a>
<ul>
<li class="chapter" data-level="11.1" data-path="value-delivery.html"><a href="value-delivery.html#communicate-1"><i class="fa fa-check"></i><b>11.1</b> Communicate</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="value-delivery.html"><a href="value-delivery.html#know-your-audience"><i class="fa fa-check"></i><b>11.1.1</b> Know Your Audience</a></li>
<li class="chapter" data-level="11.1.2" data-path="value-delivery.html"><a href="value-delivery.html#pick-the-correct-format"><i class="fa fa-check"></i><b>11.1.2</b> Pick the Correct Format</a></li>
<li class="chapter" data-level="11.1.3" data-path="value-delivery.html"><a href="value-delivery.html#storytelling"><i class="fa fa-check"></i><b>11.1.3</b> Storytelling</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="value-delivery.html"><a href="value-delivery.html#reformulate-1"><i class="fa fa-check"></i><b>11.2</b> Reformulate</a></li>
</ul></li>
<li class="part"><span><b>Haute Cuisine</b></span></li>
<li class="chapter" data-level="12" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>12</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="machine-learning.html"><a href="machine-learning.html#overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="machine-learning.html"><a href="machine-learning.html#key-topics"><i class="fa fa-check"></i><b>12.2</b> Key Topics</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="machine-learning.html"><a href="machine-learning.html#model-validation"><i class="fa fa-check"></i><b>12.2.1</b> Model Validation</a></li>
<li class="chapter" data-level="12.2.2" data-path="machine-learning.html"><a href="machine-learning.html#unsupervised-learning"><i class="fa fa-check"></i><b>12.2.2</b> Unsupervised learning</a></li>
<li class="chapter" data-level="12.2.3" data-path="machine-learning.html"><a href="machine-learning.html#semisupervised-learning"><i class="fa fa-check"></i><b>12.2.3</b> Semisupervised learning</a></li>
<li class="chapter" data-level="12.2.4" data-path="machine-learning.html"><a href="machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>12.2.4</b> Supervised learning</a></li>
<li class="chapter" data-level="12.2.5" data-path="machine-learning.html"><a href="machine-learning.html#interpretability"><i class="fa fa-check"></i><b>12.2.5</b> Interpretability</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="machine-learning.html"><a href="machine-learning.html#common-applications"><i class="fa fa-check"></i><b>12.3</b> Common Applications</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="machine-learning.html"><a href="machine-learning.html#predicting-sensory-profiles-from-instrumental-data"><i class="fa fa-check"></i><b>12.3.1</b> Predicting sensory profiles from instrumental data</a></li>
<li class="chapter" data-level="12.3.2" data-path="machine-learning.html"><a href="machine-learning.html#predicting-consumer-response-from-sensory-profiles"><i class="fa fa-check"></i><b>12.3.2</b> Predicting consumer response from sensory profiles</a></li>
<li class="chapter" data-level="12.3.3" data-path="machine-learning.html"><a href="machine-learning.html#characterizing-consumer-clusters"><i class="fa fa-check"></i><b>12.3.3</b> Characterizing consumer clusters</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="machine-learning.html"><a href="machine-learning.html#code-examples"><i class="fa fa-check"></i><b>12.4</b> Code Examples</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="machine-learning.html"><a href="machine-learning.html#data-prep-1"><i class="fa fa-check"></i><b>12.4.1</b> Data Prep</a></li>
<li class="chapter" data-level="12.4.2" data-path="machine-learning.html"><a href="machine-learning.html#classification-code"><i class="fa fa-check"></i><b>12.4.2</b> Classification Code</a></li>
<li class="chapter" data-level="12.4.3" data-path="machine-learning.html"><a href="machine-learning.html#regression-code"><i class="fa fa-check"></i><b>12.4.3</b> Regression Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>13</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="text-analysis.html"><a href="text-analysis.html#overview-1"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="text-analysis.html"><a href="text-analysis.html#key-topics-1"><i class="fa fa-check"></i><b>13.2</b> Key Topics</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="text-analysis.html"><a href="text-analysis.html#data-sources"><i class="fa fa-check"></i><b>13.2.1</b> Data Sources</a></li>
<li class="chapter" data-level="13.2.2" data-path="text-analysis.html"><a href="text-analysis.html#working-with-strings"><i class="fa fa-check"></i><b>13.2.2</b> Working with Strings</a></li>
<li class="chapter" data-level="13.2.3" data-path="text-analysis.html"><a href="text-analysis.html#tokenizing"><i class="fa fa-check"></i><b>13.2.3</b> Tokenizing</a></li>
<li class="chapter" data-level="13.2.4" data-path="text-analysis.html"><a href="text-analysis.html#lemmatization-stemming-and-stop-word-removal"><i class="fa fa-check"></i><b>13.2.4</b> Lemmatization, stemming, and stop word removal</a></li>
<li class="chapter" data-level="13.2.5" data-path="text-analysis.html"><a href="text-analysis.html#part-of-speech-tagging"><i class="fa fa-check"></i><b>13.2.5</b> Part of Speech Tagging</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="text-analysis.html"><a href="text-analysis.html#common-applications-1"><i class="fa fa-check"></i><b>13.3</b> Common Applications</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="text-analysis.html"><a href="text-analysis.html#frequency-counts-and-summary-statistics"><i class="fa fa-check"></i><b>13.3.1</b> Frequency counts and summary statistics</a></li>
<li class="chapter" data-level="13.3.2" data-path="text-analysis.html"><a href="text-analysis.html#word-clouds"><i class="fa fa-check"></i><b>13.3.2</b> Word clouds</a></li>
<li class="chapter" data-level="13.3.3" data-path="text-analysis.html"><a href="text-analysis.html#contrast-plots"><i class="fa fa-check"></i><b>13.3.3</b> Contrast plots</a></li>
<li class="chapter" data-level="13.3.4" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>13.3.4</b> Sentiment analysis</a></li>
<li class="chapter" data-level="13.3.5" data-path="text-analysis.html"><a href="text-analysis.html#topic-modeling"><i class="fa fa-check"></i><b>13.3.5</b> Topic Modeling</a></li>
<li class="chapter" data-level="13.3.6" data-path="text-analysis.html"><a href="text-analysis.html#bigrams-and-word-graphs"><i class="fa fa-check"></i><b>13.3.6</b> Bigrams and word graphs</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="text-analysis.html"><a href="text-analysis.html#code-examples-1"><i class="fa fa-check"></i><b>13.4</b> Code Examples</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="text-analysis.html"><a href="text-analysis.html#statistical-entities"><i class="fa fa-check"></i><b>13.4.1</b> Statistical entities</a></li>
<li class="chapter" data-level="13.4.2" data-path="text-analysis.html"><a href="text-analysis.html#analysis-of-frequencies-and-term-frequency-document"><i class="fa fa-check"></i><b>13.4.2</b> Analysis of Frequencies and term-frequency document</a></li>
<li class="chapter" data-level="13.4.3" data-path="text-analysis.html"><a href="text-analysis.html#futher-analysis-of-the-words"><i class="fa fa-check"></i><b>13.4.3</b> Futher Analysis of the words</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-programming.html"><a href="linear-programming.html"><i class="fa fa-check"></i><b>14</b> Linear Programming</a>
<ul>
<li class="chapter" data-level="14.1" data-path="linear-programming.html"><a href="linear-programming.html#overview-2"><i class="fa fa-check"></i><b>14.1</b> Overview</a></li>
<li class="chapter" data-level="14.2" data-path="linear-programming.html"><a href="linear-programming.html#common-applications-2"><i class="fa fa-check"></i><b>14.2</b> Common Applications</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="linear-programming.html"><a href="linear-programming.html#experimental-design"><i class="fa fa-check"></i><b>14.2.1</b> Experimental Design</a></li>
<li class="chapter" data-level="14.2.2" data-path="linear-programming.html"><a href="linear-programming.html#sample-selection"><i class="fa fa-check"></i><b>14.2.2</b> Sample Selection</a></li>
<li class="chapter" data-level="14.2.3" data-path="linear-programming.html"><a href="linear-programming.html#compact-letter-displays"><i class="fa fa-check"></i><b>14.2.3</b> Compact Letter Displays</a></li>
<li class="chapter" data-level="14.2.4" data-path="linear-programming.html"><a href="linear-programming.html#turf-analysis"><i class="fa fa-check"></i><b>14.2.4</b> TURF Analysis</a></li>
<li class="chapter" data-level="14.2.5" data-path="linear-programming.html"><a href="linear-programming.html#bundle-optimization"><i class="fa fa-check"></i><b>14.2.5</b> Bundle Optimization</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="linear-programming.html"><a href="linear-programming.html#code-examples-2"><i class="fa fa-check"></i><b>14.3</b> Code Examples</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="pipelines.html"><a href="pipelines.html"><i class="fa fa-check"></i><b>15</b> Pipelines</a></li>
<li class="chapter" data-level="16" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>16</b> Dashboards</a></li>
<li class="chapter" data-level="17" data-path="graph-db.html"><a href="graph-db.html"><i class="fa fa-check"></i><b>17</b> Graph Databases</a></li>
<li class="appendix"><span><b>À la Carte</b></span></li>
<li class="chapter" data-level="A" data-path="start-R.html"><a href="start-R.html"><i class="fa fa-check"></i><b>A</b> Apéritifs (Getting Started)</a>
<ul>
<li class="chapter" data-level="A.1" data-path="start-R.html"><a href="start-R.html#r"><i class="fa fa-check"></i><b>A.1</b> R</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="start-R.html"><a href="start-R.html#why-learn-a-programming-language"><i class="fa fa-check"></i><b>A.1.1</b> Why Learn a Programming Language?</a></li>
<li class="chapter" data-level="A.1.2" data-path="start-R.html"><a href="start-R.html#why-r"><i class="fa fa-check"></i><b>A.1.2</b> Why R?</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="start-R.html"><a href="start-R.html#why-r-1"><i class="fa fa-check"></i><b>A.2</b> Why R?</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-r"><i class="fa fa-check"></i><b>A.2.1</b> Steps to Install R</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="start-R.html"><a href="start-R.html#rstudio"><i class="fa fa-check"></i><b>A.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-rstudio"><i class="fa fa-check"></i><b>A.3.1</b> Steps to Install RStudio</a></li>
<li class="chapter" data-level="A.3.2" data-path="start-R.html"><a href="start-R.html#create-a-local-project"><i class="fa fa-check"></i><b>A.3.2</b> Create a Local Project</a></li>
<li class="chapter" data-level="A.3.3" data-path="start-R.html"><a href="start-R.html#install-and-load-packages"><i class="fa fa-check"></i><b>A.3.3</b> Install and Load Packages</a></li>
<li class="chapter" data-level="A.3.4" data-path="start-R.html"><a href="start-R.html#run-sample-code"><i class="fa fa-check"></i><b>A.3.4</b> Run Sample Code</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="start-R.html"><a href="start-R.html#git-and-github"><i class="fa fa-check"></i><b>A.4</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="start-R.html"><a href="start-R.html#git"><i class="fa fa-check"></i><b>A.4.1</b> Git</a></li>
<li class="chapter" data-level="A.4.2" data-path="start-R.html"><a href="start-R.html#github"><i class="fa fa-check"></i><b>A.4.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="start-R.html"><a href="start-R.html#raw-material"><i class="fa fa-check"></i><b>A.5</b> RAW MATERIAL</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="start-R.html"><a href="start-R.html#principles"><i class="fa fa-check"></i><b>A.5.1</b> Principles</a></li>
<li class="chapter" data-level="A.5.2" data-path="start-R.html"><a href="start-R.html#tools"><i class="fa fa-check"></i><b>A.5.2</b> Tools</a></li>
<li class="chapter" data-level="A.5.3" data-path="start-R.html"><a href="start-R.html#documentation"><i class="fa fa-check"></i><b>A.5.3</b> Documentation</a></li>
<li class="chapter" data-level="A.5.4" data-path="start-R.html"><a href="start-R.html#version-control"><i class="fa fa-check"></i><b>A.5.4</b> Version control</a></li>
<li class="chapter" data-level="A.5.5" data-path="start-R.html"><a href="start-R.html#online-repositories-for-team-collaboration"><i class="fa fa-check"></i><b>A.5.5</b> Online repositories for team collaboration</a></li>
<li class="chapter" data-level="A.5.6" data-path="start-R.html"><a href="start-R.html#building-a-code-base"><i class="fa fa-check"></i><b>A.5.6</b> Building a code base</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>B</b> Digestifs (Next Steps)</a>
<ul>
<li class="chapter" data-level="B.1" data-path="next-steps.html"><a href="next-steps.html#sensory-analysis-in-r"><i class="fa fa-check"></i><b>B.1</b> Sensory Analysis in R</a></li>
<li class="chapter" data-level="B.2" data-path="next-steps.html"><a href="next-steps.html#other-recommended-resources"><i class="fa fa-check"></i><b>B.2</b> Other Recommended Resources</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="next-steps.html"><a href="next-steps.html#r-for-data-science"><i class="fa fa-check"></i><b>B.2.1</b> R for Data Science</a></li>
<li class="chapter" data-level="B.2.2" data-path="next-steps.html"><a href="next-steps.html#hands-on-machine-learning-with-r"><i class="fa fa-check"></i><b>B.2.2</b> Hands-On Machine Learning with R</a></li>
<li class="chapter" data-level="B.2.3" data-path="next-steps.html"><a href="next-steps.html#factoextra"><i class="fa fa-check"></i><b>B.2.3</b> FactoExtra</a></li>
<li class="chapter" data-level="B.2.4" data-path="next-steps.html"><a href="next-steps.html#r-graphics-cookbook"><i class="fa fa-check"></i><b>B.2.4</b> R Graphics Cookbook</a></li>
<li class="chapter" data-level="B.2.5" data-path="next-steps.html"><a href="next-steps.html#storytelling-with-data"><i class="fa fa-check"></i><b>B.2.5</b> Storytelling with Data</a></li>
<li class="chapter" data-level="B.2.6" data-path="next-steps.html"><a href="next-steps.html#text-mining-wtih-r"><i class="fa fa-check"></i><b>B.2.6</b> Text Mining wtih R</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="next-steps.html"><a href="next-steps.html#python-and-other-languages"><i class="fa fa-check"></i><b>B.3</b> Python and Other Languages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Sensory and Consumer Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-manip" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Manipulation</h1>
<p>In sensory science, different data collection tools (whether it is device, software, or methodologies) may provide data in different formats. Also, different statistical analyses may require having the same data structured in a different way.</p>
<p>A simple example to illustrate this later point is the analysis of liking data.
Let C consumers provide their hedonic assessments of P samples. To evaluate if samples have been liked differently, an ANOVA is performed on a long thin table with (PxC) rows x 3 columns (consumer, sample, and the liking scores).</p>
<!-- Insert Figure illustrating the data structure -->
<p>However, to assess whether consumers have the same preference patterns at the individual level, internal preference mapping or cluster analysis would be performed, and both these analyses require as input a short and large table with P rows and C columns.</p>
<!-- Insert Figure illustrating the data structure -->
<p>Another example of data manipulation consists in summarizing data, by for instance computing the mean by product for each sensory attribute (hence creating the so-called sensory profiles), or to generate frequency tables (e.g. proportions of male/female, distribution of the liking scores by sample, contingency table for CATA data, etc.)</p>
<!-- Insert Figure illustrating the data structure -->
<p>For these reasons, it is hence essential to learn to manipulate data and transition from one structure to another.</p>
<p>For illustration, let’s consider the data stored in <em>Sensory Profile.xlsx</em>, which consists in 9 panellists evaluating 11 samples on 32 sensory attributes. This dataset will be further analysed in the following sections. The aim here is not to interpret the results, but to show how data is being manipulated.</p>
<p>This data is imported using the <code>read_xlsx()</code> function from the <code>{readxl}</code> package (for more information on how to import data, see Section <a href="data-collection.html#data-collection">8</a>).</p>
<p>A first analysis that is commonly done on such table consists in computing the mean per sample for each attribute, hence generating the so-called sensory profiles of the samples. Such table (crossing the samples in rows and the sensory attributes in columns) gives a first impression at the differences between samples across attributes.</p>
<p>The principles of data manipulation will be illustrated here by generating the sensory profiles from the raw data using different approaches. This step consists in reducing the 99x35 table into a 11x33 table, i.e. a table with 11 rows (one per sample) and 32 columns (one per attribute) and one column with the sample information. An important message here is that most data transformation situation can be solved in different ways, so don’t be afraid to open your mind and think differently by stimulating your imagination to solve any of your data challenge.</p>
<p>Note that we could consider passing the sample names as row names rather than having it as an extra column. This extra step is required for certain functions from <code>{FactoMineR}</code> and <code>{SensoMineR}</code> for instance, and will be presented in Section <a href="data-prep.html#data-prep">9</a>.</p>
<!-- 
1. Using base R and 'regular' functions
2. `{SensoMineR}`, a package dedicated to sensory analysis
3. A different approach proposed by Hadley Wickham and his team at RStudio using the `{tidyverse}` philosophy, philosophy that we will be adopting throughout this book.

### Using `{base}`

To compute the mean, the `mean()` function is used: It computes the mean across a set of values. Unfortunately, it is not possible to specify a variable to split the mean for the different categories. In other words, applying `mean()` to a variable would provide the grand mean, not the mean per sample.  
To create the sensory profiles, a first possibility consists in filtering the data by product, and computing the mean in each case. The results obtained for each sample are then combined. Although this solution works, it is quite tedious, and we are not going to consider it here. Instead, we propose to combine `mean()` to the `aggregate()` function: `aggregate()` allows performing the same function (here `mean()`) across a set of variables by splitting the results according to one (or more) categorical variables specified by `by`. In our example, such table would be obtained as such:


```r
senso_mean1 <- aggregate(sensory[,4:ncol(sensory)], by=list(sensory[,3]), FUN=mean)
rownames(senso_mean1) <- senso_mean1[,1]
senso_mean1 <- senso_mean1[,-1]
round(senso_mean1, 2)
```

In case we would have replicates and would want to compute the mean across replicates (hence generate a (panelist x sample) x attribute table), we would use `by=c(list(sensory[,1], list(sensory[,2])))`. Many other functions could also be used here: Instead of `mean()`, one could consider `median()`, `min()`, `max()`, or eventually `length()` to evaluate how many scores each samples received.

### Using `{SensoMineR}`

Alternatively to base R, we can also consider the `averagetable()` function from the **{SensoMineR}** package.  Since **{SensoMineR}** is a package dedicated to the analysis of sensory data, it is no surprise that it provides such possibility. In this case, the code would look like the following:


```r
library(SensoMineR)
senso_adjmean1 <- averagetable(sensory, formul="~product+judge", firstvar=4, method="mean")
round(senso_adjmean1, 2)
```

The `averagetable()` has the disadvantage that it can only compute the mean, meaning that this function cannot be provide other statistics such as the median for instance. However, when the dataset contains missing data (visible through empty cells in the data, or invisible through incomplete design), this function allows computing both the arithmetic mean and the adjusted mean[^1] (also known as LS means) through the `method` option (use `method="coeff"` for the adjusted mean). 

[^1]: The adjusted mean (or LS mean) consists in estimating through a model the missing values before computing the mean. When there are no missing data, both the arithmetic mean and the adjusted mean return the same results. 

The adjusted mean can also be obtained from the `SensoMineR::decat()` (which stands for DEscription of CATegories) function, which goes further in the description of the samples since ANOVA and t-tests are also performed. To extract the sensory profiles, the output called `adjmean` is extracted.


```r
senso_adjmean2 <- decat(sensory, formul="~product+judge", firstvar=4, graph=FALSE)$adjmean
round(senso_adjmean2, 2)
```

-->
<div id="tidying-data" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Tidying Data</h2>
<div id="transformation-without-altering-the-data" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Transformation without Altering the Data</h3>
<p>Transforming a data table without altering the data itself is done through pivoting, hence either creating a shorter and wider table (CREATE FIGURE), or a longer and thinner table (CREATE FIGURE). This is done through the <code>pivot_wider()</code> and <code>pivot_longer()</code> functions from the <code>{tidyr}</code> package.</p>
</div>
<div id="transformation-that-alters-the-data" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Transformation that Alters the Data</h3>
<p>In some cases, the final table to generate requires altering the data, by (say) computing the mean across multiple values, or counting the number of occurrences of factor levels for instance. In other words, we summarize the information, which also tend to reduce the size of the table. It is hence no surprise that the function used for such data reduction is called <code>summarise()</code> from the <code>{dplyr}</code> package.</p>
<p>In practice, <code>summarise()</code> applies a function (whether it is the <code>mean()</code>, or a simple count using <code>n()</code>) on a set of values. When this set of values need to be aggregated based on another variable (say we do not want to compute the overall mean for the entire table, but the mean by product), <code>summarise()</code> is then coupled with <code>group_by()</code>.</p>
</div>
<div id="handling-lists-of-tables" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Handling Lists of Tables</h3>
<p>Create an example with multiple dataset in one excel sheet (could be different countries, or different sessions)
Import the data using <code>map()</code> by reading the different tabs
Use <code>enframe()</code> to combine all the results
(alternative: use <code>reduce()</code> with <code>bind_rows()</code>, but this version will lose the country names/session info if not already part of the dataset)</p>
<p><code>nest_by()</code> and <code>unnest_by()</code>
<code>enframe()</code> and <code>deframe()</code></p>
<p><code>reduce()</code></p>
<p><code>rowwise()</code> and <code>mutate()</code></p>
<p><code>separate_rows()</code> to link to <code>unnest_tokens()</code></p>
</div>
</div>
<div id="illustration" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Illustration</h2>
<p>Although the solutions we just presented are simple and only involve a few lines of code, we propose other solutions using the <strong>{tidyverse}</strong>. This will allow us introducing this philosophy of coding, and will provide you a first contact to some of the functions that we use.</p>
<p>The <strong>{tidyverse}</strong> operates 5 major transformations on a dataset:</p>
<ul>
<li><code>select()</code> allows selecting, renaming, and re-arranging columns of a dataset;</li>
<li><code>filter()</code> and <code>arrange()</code> works on the rows of the dataset by filtering data and rearranging the order;</li>
<li><code>mutate()</code> adds new columns, which can be the combination of other columns of the dataset;</li>
<li><code>summarise()</code> summarises the data by providing the statistics of interest on the variables selected (all the variables that are not specified are then removed).</li>
</ul>
<p>Note that for <code>mutate()</code> and <code>summarise()</code>, different variant such as <code>mutate_all()</code> or <code>mutate_if()</code> (resp. <code>summarise_all()</code> and <code>summarise_if()</code>) allows applying the same transformation to multiple columns (all the columns for <code>mutate_all()</code> and <code>summarise_all()</code>, or the one that meet a pre-defined condition for <code>mutate_if()</code> and <code>summarise_if()</code>).</p>
<p>As a first proposition, we use <code>summarise_all</code>, meaning that we should only keep the variables that are relevant for the analysis. From <code>sensory</code>, we hence select the columns 3 (product), and the block starting from column 4 until the end of the dataset (sensory attributes).
Since the mean needs to be computed for each sample separately, the function <code>group_by()</code> is used. This function ensures that the results are summarised by product in our case. We then summarise the data by performing the mean on all the variables (product is ignored since it is used to group the results).
Ultimately, we use the product names as row names (using <code>column_to_rownames()</code>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-manip.html#cb1-1" aria-hidden="true" tabindex="-1"></a>senso_mean2 <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="data-manip.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">3</span>,<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(sensory)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="data-manip.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(product) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="data-manip.html#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="fu">list</span>(<span class="sc">~</span><span class="fu">mean</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="data-manip.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;product&quot;</span>)</span>
<span id="cb1-6"><a href="data-manip.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(senso_mean2, <span class="dv">2</span>)</span></code></pre></div>
<p>The transformation from the original 11x35 table to the 11x33 table is done through the <code>group_by()</code> followed by <code>summarise_all</code> functions.</p>
<p>Another way of generating such table consists in not pre-selecting the variables, but in computing the mean only if the variable is numerical. To do so, we use <code>summarise_if()</code> and we put the condition that the variable should be numerical to compute the mean (otherwise R will return an error). Here again, we group the results by product.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-manip.html#cb2-1" aria-hidden="true" tabindex="-1"></a>senso_mean3 <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="data-manip.html#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(product) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="data-manip.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_if</span>(is.numeric, mean) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="data-manip.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;product&quot;</span>)</span>
<span id="cb2-5"><a href="data-manip.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(senso_mean3, <span class="dv">2</span>)</span></code></pre></div>
<p>This solution fits well if all the variables that are numeric should be summarized in the same way (here using the mean). Otherwise, a good solution is to run the analysis on a pre-defined set of variables. Such set can be created manually (we are taking the first 10 sensory attributes here), or automatically if the names of the attributes follow a certain pattern. In such case, the use of functions such as <code>starts_with()</code>, <code>ends_with()</code>, or using regular expression is of great help!</p>
<p>The mean table is then generated using the <code>summarise()</code> function <code>across()</code> <code>all_of()</code> the variables that were selected.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data-manip.html#cb3-1" aria-hidden="true" tabindex="-1"></a>senso_var <span class="ot">&lt;-</span> <span class="fu">colnames</span>(sensory)[<span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb3-2"><a href="data-manip.html#cb3-2" aria-hidden="true" tabindex="-1"></a>senso_mean4 <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="data-manip.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(product) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="data-manip.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(senso_var), mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="data-manip.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="data-manip.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;product&quot;</span>)</span>
<span id="cb3-7"><a href="data-manip.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(senso_mean4, <span class="dv">2</span>)</span></code></pre></div>
<p>At last, we propose a solution which in this case is not optimal, but which can be very useful in some others. This solution consists in working on the dataset by permuting all the variables using <code>pivot_longer()</code>, hence generating a dataset with 3 relevant columns: one containing the products, one containing all the attributes, and one containing the scores. On this variable, we <code>summarise()</code> the scores by product and by attribute, before re-structuring the data using <code>pivot_wider()</code>.
Note that the combination <code>pivot_longer()</code> and <code>pivot_wider()</code> will re-organize automatically the attributes alphabetically. To avoid that, we can transform the column we name <code>attribute</code> into a factor with as level order the original order. This procedure maintains the original order.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-manip.html#cb4-1" aria-hidden="true" tabindex="-1"></a>senso_mean5 <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="data-manip.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(.), <span class="at">names_to=</span><span class="st">&quot;attributes&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;scores&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="data-manip.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attributes =</span> <span class="fu">factor</span>(attributes, <span class="at">levels=</span><span class="fu">colnames</span>(sensory)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(sensory)])) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="data-manip.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(product, attributes) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="data-manip.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">scores =</span> <span class="fu">mean</span>(scores)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="data-manip.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>attributes, <span class="at">values_from=</span>scores) <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="data-manip.html#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;product&quot;</span>)</span>
<span id="cb4-8"><a href="data-manip.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(senso_mean5, <span class="dv">2</span>)</span></code></pre></div>
<p>This procedure uses intermediate steps since the structure of the original table (99x35) is transformed by pivoting the attributes from columns to rows: this means that after <code>pivot_wider()</code>, the dataset created now contains 99x32=3168 rows and 5 columns (<em>judge</em>, <em>code</em>, and <em>product</em>, one column called <em>attributes</em> which contains the attribute names, and one column called <em>scores</em> which contain the individual scores). This table is then reduced to a table 11x32=352 rows and 3 columns (<em>product</em>, <em>attributes</em>, <em>scores</em>) through the <code>group_by()</code> and <code>summarise()</code> process, before being reset as 11x33 table through <code>pivot_wider()</code>.</p>
<p>This procedure could slightly be simplified: To generate <code>senso_mean5</code>, we computed the mean by <code>product</code> and <code>attributes</code> across all assessors. If we delete this line of code (i.e. related to <code>summary</code>), R will generate a table crossing <code>product</code> in rows, <code>attributes</code> in columns, in which each cell contains a list of values (here, we have as many values as we have assessors performing the test in each cell).
When such situation appears, it is possible to apply automatically a function (here we want the <code>mean()</code>) on this sets of values using <code>values_fn</code> from <code>pivot_wider()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-manip.html#cb5-1" aria-hidden="true" tabindex="-1"></a>senso_mean6 <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="data-manip.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(.), <span class="at">names_to=</span><span class="st">&quot;attribute&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;scores&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="data-manip.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attribute =</span> <span class="fu">factor</span>(attribute, <span class="at">levels=</span><span class="fu">colnames</span>(sensory)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(sensory)])) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="data-manip.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>judge, <span class="sc">-</span>code) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="data-manip.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(product, attribute) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="data-manip.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>attribute, <span class="at">values_from=</span>scores, <span class="at">values_fn=</span>mean) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="data-manip.html#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;product&quot;</span>)</span>
<span id="cb5-8"><a href="data-manip.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(senso_mean6, <span class="dv">2</span>)</span></code></pre></div>
<p>In a similar way, missing values can be replaced automatically using <code>values_fill</code>.</p>
<p>As expected, all these solutions provide the same sensory profiles using different process. Depending on the situations, some of these processes may be better than others.</p>
<p>Note that multiple analysis can be ordered together. Let’s take back the example generating <code>senso_mean4</code>, and let’s consider 2 other groups of variables, one in which we ask for the median, and one for which we ask the number of measures. This entire table can be generated as such:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-manip.html#cb6-1" aria-hidden="true" tabindex="-1"></a>senso_var1 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(sensory)[<span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb6-2"><a href="data-manip.html#cb6-2" aria-hidden="true" tabindex="-1"></a>senso_var2 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(sensory)[<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb6-3"><a href="data-manip.html#cb6-3" aria-hidden="true" tabindex="-1"></a>senso_var3 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(sensory)[<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb6-4"><a href="data-manip.html#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="data-manip.html#cb6-5" aria-hidden="true" tabindex="-1"></a>senso_multifun <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="data-manip.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(product) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="data-manip.html#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(senso_var1), mean),</span>
<span id="cb6-8"><a href="data-manip.html#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">all_of</span>(senso_var2), median),</span>
<span id="cb6-9"><a href="data-manip.html#cb6-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">all_of</span>(senso_var3), length)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="data-manip.html#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="data-manip.html#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;product&quot;</span>)</span>
<span id="cb6-12"><a href="data-manip.html#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(senso_multifun, <span class="dv">2</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tidy-thoughts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-viz.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["i2ds4scc_bookdown.pdf", "i2ds4scc_bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
