<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Automated Reporting | Data Science for Sensory and Consumer Scientists</title>
  <meta name="description" content="Open development of data science book for sensory and consumer scientists." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Automated Reporting | Data Science for Sensory and Consumer Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Open development of data science book for sensory and consumer scientists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Automated Reporting | Data Science for Sensory and Consumer Scientists" />
  
  <meta name="twitter:description" content="Open development of data science book for sensory and consumer scientists." />
  

<meta name="author" content="John Ennis, Julien Delarue, and Thierry Worch" />


<meta name="date" content="2021-10-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-viz.html"/>
<link rel="next" href="example-projects.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Sensory and Consumer Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-read-this-book"><i class="fa fa-check"></i>Who Should Read This Book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to Use This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cautions-dont-that-everybody-does"><i class="fa fa-check"></i>Cautions: Don’t that Everybody Does</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contact-us"><i class="fa fa-check"></i>How to Contact Us</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="bienvenue.html"><a href="bienvenue.html"><i class="fa fa-check"></i><b>1</b> Bienvenue!</a>
<ul>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#why-data-science-for-sensory-and-consumer-science"><i class="fa fa-check"></i>Why Data Science for Sensory and Consumer Science?</a>
<ul>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#core-principles-in-sensory-and-consumer-science"><i class="fa fa-check"></i>Core principles in Sensory and Consumer Science</a></li>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#measuring-and-analyzing-human-responses"><i class="fa fa-check"></i>Measuring and analyzing human responses</a></li>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#computational-sensory-science"><i class="fa fa-check"></i>Computational Sensory Science</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Hors d’Oeuvres</b></span></li>
<li class="chapter" data-level="2" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>2</b> Why Data Science?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-science.html"><a href="data-science.html#history-and-definition"><i class="fa fa-check"></i><b>2.1</b> History and Definition</a></li>
<li class="chapter" data-level="2.2" data-path="data-science.html"><a href="data-science.html#benefits-of-data-science"><i class="fa fa-check"></i><b>2.2</b> Benefits of Data Science</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-science.html"><a href="data-science.html#reproducible-research"><i class="fa fa-check"></i><b>2.2.1</b> Reproducible Research</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-science.html"><a href="data-science.html#standardized-reporting"><i class="fa fa-check"></i><b>2.2.2</b> Standardized Reporting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-science.html"><a href="data-science.html#data-scientific-workflow"><i class="fa fa-check"></i><b>2.3</b> Data Scientific Workflow</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-science.html"><a href="data-science.html#data-collection2"><i class="fa fa-check"></i><b>2.3.1</b> Data Collection</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-science.html"><a href="data-science.html#data-preparation"><i class="fa fa-check"></i><b>2.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-science.html"><a href="data-science.html#data-analysis2"><i class="fa fa-check"></i><b>2.3.3</b> Data Analysis</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-science.html"><a href="data-science.html#value-delivery2"><i class="fa fa-check"></i><b>2.3.4</b> Value Delivery</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-science.html"><a href="data-science.html#how-to-learn-data-science"><i class="fa fa-check"></i><b>2.4</b> How to Learn Data Science</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>3</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-manip.html"><a href="data-manip.html#tidy-data"><i class="fa fa-check"></i><b>3.1</b> Tidying Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-manip.html"><a href="data-manip.html#simple-manipulations"><i class="fa fa-check"></i><b>3.1.1</b> Simple Manipulations</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-manip.html"><a href="data-manip.html#reshaping-the-data"><i class="fa fa-check"></i><b>3.1.2</b> Reshaping the Data</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-manip.html"><a href="data-manip.html#transformation-that-alters-the-data"><i class="fa fa-check"></i><b>3.1.3</b> Transformation that Alters the Data</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-manip.html"><a href="data-manip.html#combining-data-from-different-sources"><i class="fa fa-check"></i><b>3.1.4</b> Combining Data from Different Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>4</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-viz.html"><a href="data-viz.html#design-principles"><i class="fa fa-check"></i><b>4.1</b> Design Principles</a></li>
<li class="chapter" data-level="4.2" data-path="data-viz.html"><a href="data-viz.html#table-making"><i class="fa fa-check"></i><b>4.2</b> Table Making</a></li>
<li class="chapter" data-level="4.3" data-path="data-viz.html"><a href="data-viz.html#chart-making"><i class="fa fa-check"></i><b>4.3</b> Chart Making</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-viz.html"><a href="data-viz.html#philosophy-of-ggplot2"><i class="fa fa-check"></i><b>4.3.1</b> Philosophy of <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="data-viz.html"><a href="data-viz.html#getting-started-with-ggplot2"><i class="fa fa-check"></i><b>4.3.2</b> Getting started with <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="data-viz.html"><a href="data-viz.html#common-charts"><i class="fa fa-check"></i><b>4.3.3</b> Common Charts</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-viz.html"><a href="data-viz.html#additional-topics"><i class="fa fa-check"></i><b>4.3.4</b> Additional Topics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="auto-report.html"><a href="auto-report.html"><i class="fa fa-check"></i><b>5</b> Automated Reporting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="auto-report.html"><a href="auto-report.html#what-is-automated-reporting"><i class="fa fa-check"></i><b>5.1</b> What is Automated Reporting?</a></li>
<li class="chapter" data-level="5.2" data-path="auto-report.html"><a href="auto-report.html#excel"><i class="fa fa-check"></i><b>5.2</b> Excel</a></li>
<li class="chapter" data-level="5.3" data-path="auto-report.html"><a href="auto-report.html#powerpoint"><i class="fa fa-check"></i><b>5.3</b> PowerPoint</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="auto-report.html"><a href="auto-report.html#creating-a-powerpoint-deck"><i class="fa fa-check"></i><b>5.3.1</b> Creating a PowerPoint Deck</a></li>
<li class="chapter" data-level="5.3.2" data-path="auto-report.html"><a href="auto-report.html#powerpoint-themes"><i class="fa fa-check"></i><b>5.3.2</b> PowerPoint Themes</a></li>
<li class="chapter" data-level="5.3.3" data-path="auto-report.html"><a href="auto-report.html#placeholders-and-shapes"><i class="fa fa-check"></i><b>5.3.3</b> Placeholders and Shapes</a></li>
<li class="chapter" data-level="5.3.4" data-path="auto-report.html"><a href="auto-report.html#working-with-text"><i class="fa fa-check"></i><b>5.3.4</b> Working with Text</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="auto-report.html"><a href="auto-report.html#tables"><i class="fa fa-check"></i><b>5.4</b> Tables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="auto-report.html"><a href="auto-report.html#introduction-to-flextable"><i class="fa fa-check"></i><b>5.4.1</b> Introduction to flextable</a></li>
<li class="chapter" data-level="5.4.2" data-path="auto-report.html"><a href="auto-report.html#formatting-examples"><i class="fa fa-check"></i><b>5.4.2</b> Formatting examples</a></li>
<li class="chapter" data-level="5.4.3" data-path="auto-report.html"><a href="auto-report.html#add-flextable-object-to-a-powerpoint-slide"><i class="fa fa-check"></i><b>5.4.3</b> Add flextable object to a powerpoint slide</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="auto-report.html"><a href="auto-report.html#charts"><i class="fa fa-check"></i><b>5.5</b> Charts</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="auto-report.html"><a href="auto-report.html#adding-charts-as-images"><i class="fa fa-check"></i><b>5.5.1</b> Adding charts as images</a></li>
<li class="chapter" data-level="5.5.2" data-path="auto-report.html"><a href="auto-report.html#rvg-package"><i class="fa fa-check"></i><b>5.5.2</b> rvg package</a></li>
<li class="chapter" data-level="5.5.3" data-path="auto-report.html"><a href="auto-report.html#mschart-package"><i class="fa fa-check"></i><b>5.5.3</b> mschart package</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="auto-report.html"><a href="auto-report.html#word"><i class="fa fa-check"></i><b>5.6</b> Word</a></li>
</ul></li>
<li class="part"><span><b>Bon Appétit</b></span></li>
<li class="chapter" data-level="6" data-path="example-projects.html"><a href="example-projects.html"><i class="fa fa-check"></i><b>6</b> Example Project: the biscuit study</a>
<ul>
<li class="chapter" data-level="6.1" data-path="example-projects.html"><a href="example-projects.html#products"><i class="fa fa-check"></i><b>6.1</b> Products</a></li>
<li class="chapter" data-level="6.2" data-path="example-projects.html"><a href="example-projects.html#consumer-test"><i class="fa fa-check"></i><b>6.2</b> Consumer test</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="example-projects.html"><a href="example-projects.html#participants"><i class="fa fa-check"></i><b>6.2.1</b> Participants</a></li>
<li class="chapter" data-level="6.2.2" data-path="example-projects.html"><a href="example-projects.html#test-design"><i class="fa fa-check"></i><b>6.2.2</b> Test design</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="example-projects.html"><a href="example-projects.html#sensory-descriptive-analysis-data"><i class="fa fa-check"></i><b>6.3</b> Sensory descriptive analysis data</a></li>
<li class="chapter" data-level="6.4" data-path="example-projects.html"><a href="example-projects.html#summary-of-the-datasets"><i class="fa fa-check"></i><b>6.4</b> Summary of the datasets</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>7</b> Data Collection</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-collection.html"><a href="data-collection.html#design-1"><i class="fa fa-check"></i><b>7.1</b> Design</a></li>
<li class="chapter" data-level="7.2" data-path="data-collection.html"><a href="data-collection.html#execute-1"><i class="fa fa-check"></i><b>7.2</b> Execute</a></li>
<li class="chapter" data-level="7.3" data-path="data-collection.html"><a href="data-collection.html#data-import"><i class="fa fa-check"></i><b>7.3</b> Import</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="data-collection.html"><a href="data-collection.html#importing-structured-excel-file"><i class="fa fa-check"></i><b>7.3.1</b> Importing Structured Excel File</a></li>
<li class="chapter" data-level="7.3.2" data-path="data-collection.html"><a href="data-collection.html#importing-unstructured-excel-file"><i class="fa fa-check"></i><b>7.3.2</b> Importing Unstructured Excel File</a></li>
<li class="chapter" data-level="7.3.3" data-path="data-collection.html"><a href="data-collection.html#import-mult-sheet"><i class="fa fa-check"></i><b>7.3.3</b> Importing Data Stored in Multiple Sheets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>8</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-prep.html"><a href="data-prep.html#inspect"><i class="fa fa-check"></i><b>8.1</b> Inspect</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="data-prep.html"><a href="data-prep.html#data-inspection"><i class="fa fa-check"></i><b>8.1.1</b> Data Inspection</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-prep.html"><a href="data-prep.html#design-inspection"><i class="fa fa-check"></i><b>8.1.2</b> Design Inspection</a></li>
<li class="chapter" data-level="8.1.3" data-path="data-prep.html"><a href="data-prep.html#missing-data-inspection"><i class="fa fa-check"></i><b>8.1.3</b> Missing Data Inspection</a></li>
<li class="chapter" data-level="8.1.4" data-path="data-prep.html"><a href="data-prep.html#checks-for-consistency-and-reliability"><i class="fa fa-check"></i><b>8.1.4</b> Checks for Consistency and Reliability</a></li>
<li class="chapter" data-level="8.1.5" data-path="data-prep.html"><a href="data-prep.html#preliminary-tables-and-charts"><i class="fa fa-check"></i><b>8.1.5</b> Preliminary Tables and Charts</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-prep.html"><a href="data-prep.html#clean"><i class="fa fa-check"></i><b>8.2</b> Clean</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="data-prep.html"><a href="data-prep.html#renaming-variables-1"><i class="fa fa-check"></i><b>8.2.1</b> Renaming Variables</a></li>
<li class="chapter" data-level="8.2.2" data-path="data-prep.html"><a href="data-prep.html#handling-data-type"><i class="fa fa-check"></i><b>8.2.2</b> Handling Data Type</a></li>
<li class="chapter" data-level="8.2.3" data-path="data-prep.html"><a href="data-prep.html#converting-between-types"><i class="fa fa-check"></i><b>8.2.3</b> Converting between Types</a></li>
<li class="chapter" data-level="8.2.4" data-path="data-prep.html"><a href="data-prep.html#handling-missing-values"><i class="fa fa-check"></i><b>8.2.4</b> Handling Missing Values</a></li>
<li class="chapter" data-level="8.2.5" data-path="data-prep.html"><a href="data-prep.html#restructuring-data"><i class="fa fa-check"></i><b>8.2.5</b> Restructuring Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>9</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-analysis.html"><a href="data-analysis.html#sensory-data"><i class="fa fa-check"></i><b>9.1</b> Sensory Data</a></li>
<li class="chapter" data-level="9.2" data-path="data-analysis.html"><a href="data-analysis.html#demographic-and-questionnaire-data"><i class="fa fa-check"></i><b>9.2</b> Demographic and Questionnaire Data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-analysis.html"><a href="data-analysis.html#demographic-data-frequency-and-proportion"><i class="fa fa-check"></i><b>9.2.1</b> Demographic Data: Frequency and Proportion</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-analysis.html"><a href="data-analysis.html#personality-traits-and-eating-behavior-tfeq-data"><i class="fa fa-check"></i><b>9.2.2</b> Personality traits and eating behavior: TFEQ data</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-analysis.html"><a href="data-analysis.html#consumer-data"><i class="fa fa-check"></i><b>9.3</b> Consumer Data</a></li>
<li class="chapter" data-level="9.4" data-path="data-analysis.html"><a href="data-analysis.html#combining-sensory-and-consumer-data"><i class="fa fa-check"></i><b>9.4</b> Combining Sensory and Consumer Data</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="data-analysis.html"><a href="data-analysis.html#internal-preference-mapping"><i class="fa fa-check"></i><b>9.4.1</b> Internal Preference Mapping</a></li>
<li class="chapter" data-level="9.4.2" data-path="data-analysis.html"><a href="data-analysis.html#consumers-clustering"><i class="fa fa-check"></i><b>9.4.2</b> Consumers Clustering</a></li>
<li class="chapter" data-level="9.4.3" data-path="data-analysis.html"><a href="data-analysis.html#drivers-of-liking"><i class="fa fa-check"></i><b>9.4.3</b> Drivers of Liking</a></li>
<li class="chapter" data-level="9.4.4" data-path="data-analysis.html"><a href="data-analysis.html#external-preference-mapping"><i class="fa fa-check"></i><b>9.4.4</b> External Preference Mapping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="value-delivery.html"><a href="value-delivery.html"><i class="fa fa-check"></i><b>10</b> Value Delivery</a>
<ul>
<li class="chapter" data-level="10.1" data-path="value-delivery.html"><a href="value-delivery.html#communicate2"><i class="fa fa-check"></i><b>10.1</b> Communicate</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="value-delivery.html"><a href="value-delivery.html#know-your-audience"><i class="fa fa-check"></i><b>10.1.1</b> Know Your Audience</a></li>
<li class="chapter" data-level="10.1.2" data-path="value-delivery.html"><a href="value-delivery.html#pick-the-correct-format"><i class="fa fa-check"></i><b>10.1.2</b> Pick the Correct Format</a></li>
<li class="chapter" data-level="10.1.3" data-path="value-delivery.html"><a href="value-delivery.html#storytelling"><i class="fa fa-check"></i><b>10.1.3</b> Storytelling</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="value-delivery.html"><a href="value-delivery.html#reformulate2"><i class="fa fa-check"></i><b>10.2</b> Reformulate</a></li>
</ul></li>
<li class="part"><span><b>Haute Cuisine</b></span></li>
<li class="chapter" data-level="11" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>11</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="11.1" data-path="machine-learning.html"><a href="machine-learning.html#overview"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="machine-learning.html"><a href="machine-learning.html#key-topics"><i class="fa fa-check"></i><b>11.2</b> Key Topics</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="machine-learning.html"><a href="machine-learning.html#model-validation"><i class="fa fa-check"></i><b>11.2.1</b> Model Validation</a></li>
<li class="chapter" data-level="11.2.2" data-path="machine-learning.html"><a href="machine-learning.html#unsupervised-learning"><i class="fa fa-check"></i><b>11.2.2</b> Unsupervised learning</a></li>
<li class="chapter" data-level="11.2.3" data-path="machine-learning.html"><a href="machine-learning.html#semisupervised-learning"><i class="fa fa-check"></i><b>11.2.3</b> Semisupervised learning</a></li>
<li class="chapter" data-level="11.2.4" data-path="machine-learning.html"><a href="machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>11.2.4</b> Supervised learning</a></li>
<li class="chapter" data-level="11.2.5" data-path="machine-learning.html"><a href="machine-learning.html#interpretability"><i class="fa fa-check"></i><b>11.2.5</b> Interpretability</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="machine-learning.html"><a href="machine-learning.html#common-applications"><i class="fa fa-check"></i><b>11.3</b> Common Applications</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="machine-learning.html"><a href="machine-learning.html#predicting-sensory-profiles-from-instrumental-data"><i class="fa fa-check"></i><b>11.3.1</b> Predicting sensory profiles from instrumental data</a></li>
<li class="chapter" data-level="11.3.2" data-path="machine-learning.html"><a href="machine-learning.html#predicting-consumer-response-from-sensory-profiles"><i class="fa fa-check"></i><b>11.3.2</b> Predicting consumer response from sensory profiles</a></li>
<li class="chapter" data-level="11.3.3" data-path="machine-learning.html"><a href="machine-learning.html#characterizing-consumer-clusters"><i class="fa fa-check"></i><b>11.3.3</b> Characterizing consumer clusters</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="machine-learning.html"><a href="machine-learning.html#code-examples"><i class="fa fa-check"></i><b>11.4</b> Code Examples</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="machine-learning.html"><a href="machine-learning.html#data-prep-1"><i class="fa fa-check"></i><b>11.4.1</b> Data Prep</a></li>
<li class="chapter" data-level="11.4.2" data-path="machine-learning.html"><a href="machine-learning.html#classification-code"><i class="fa fa-check"></i><b>11.4.2</b> Classification Code</a></li>
<li class="chapter" data-level="11.4.3" data-path="machine-learning.html"><a href="machine-learning.html#regression-code"><i class="fa fa-check"></i><b>11.4.3</b> Regression Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>12</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="text-analysis.html"><a href="text-analysis.html#overview-1"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="text-analysis.html"><a href="text-analysis.html#key-topics-1"><i class="fa fa-check"></i><b>12.2</b> Key Topics</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="text-analysis.html"><a href="text-analysis.html#data-sources"><i class="fa fa-check"></i><b>12.2.1</b> Data Sources</a></li>
<li class="chapter" data-level="12.2.2" data-path="text-analysis.html"><a href="text-analysis.html#working-with-strings"><i class="fa fa-check"></i><b>12.2.2</b> Working with Strings</a></li>
<li class="chapter" data-level="12.2.3" data-path="text-analysis.html"><a href="text-analysis.html#tokenizing"><i class="fa fa-check"></i><b>12.2.3</b> Tokenizing</a></li>
<li class="chapter" data-level="12.2.4" data-path="text-analysis.html"><a href="text-analysis.html#lemmatization-stemming-and-stop-word-removal"><i class="fa fa-check"></i><b>12.2.4</b> Lemmatization, stemming, and stop word removal</a></li>
<li class="chapter" data-level="12.2.5" data-path="text-analysis.html"><a href="text-analysis.html#part-of-speech-tagging"><i class="fa fa-check"></i><b>12.2.5</b> Part of Speech Tagging</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="text-analysis.html"><a href="text-analysis.html#common-applications-1"><i class="fa fa-check"></i><b>12.3</b> Common Applications</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="text-analysis.html"><a href="text-analysis.html#frequency-counts-and-summary-statistics"><i class="fa fa-check"></i><b>12.3.1</b> Frequency counts and summary statistics</a></li>
<li class="chapter" data-level="12.3.2" data-path="text-analysis.html"><a href="text-analysis.html#word-clouds"><i class="fa fa-check"></i><b>12.3.2</b> Word clouds</a></li>
<li class="chapter" data-level="12.3.3" data-path="text-analysis.html"><a href="text-analysis.html#contrast-plots"><i class="fa fa-check"></i><b>12.3.3</b> Contrast plots</a></li>
<li class="chapter" data-level="12.3.4" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>12.3.4</b> Sentiment analysis</a></li>
<li class="chapter" data-level="12.3.5" data-path="text-analysis.html"><a href="text-analysis.html#topic-modeling"><i class="fa fa-check"></i><b>12.3.5</b> Topic Modeling</a></li>
<li class="chapter" data-level="12.3.6" data-path="text-analysis.html"><a href="text-analysis.html#bigrams-and-word-graphs"><i class="fa fa-check"></i><b>12.3.6</b> Bigrams and word graphs</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="text-analysis.html"><a href="text-analysis.html#code-examples-1"><i class="fa fa-check"></i><b>12.4</b> Code Examples</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="text-analysis.html"><a href="text-analysis.html#statistical-entities"><i class="fa fa-check"></i><b>12.4.1</b> Statistical entities</a></li>
<li class="chapter" data-level="12.4.2" data-path="text-analysis.html"><a href="text-analysis.html#analysis-of-frequencies-and-term-frequency-document"><i class="fa fa-check"></i><b>12.4.2</b> Analysis of Frequencies and term-frequency document</a></li>
<li class="chapter" data-level="12.4.3" data-path="text-analysis.html"><a href="text-analysis.html#futher-analysis-of-the-words"><i class="fa fa-check"></i><b>12.4.3</b> Futher Analysis of the words</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-programming.html"><a href="linear-programming.html"><i class="fa fa-check"></i><b>13</b> Linear Programming</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-programming.html"><a href="linear-programming.html#overview-2"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="linear-programming.html"><a href="linear-programming.html#common-applications-2"><i class="fa fa-check"></i><b>13.2</b> Common Applications</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="linear-programming.html"><a href="linear-programming.html#experimental-design"><i class="fa fa-check"></i><b>13.2.1</b> Experimental Design</a></li>
<li class="chapter" data-level="13.2.2" data-path="linear-programming.html"><a href="linear-programming.html#sample-selection"><i class="fa fa-check"></i><b>13.2.2</b> Sample Selection</a></li>
<li class="chapter" data-level="13.2.3" data-path="linear-programming.html"><a href="linear-programming.html#compact-letter-displays"><i class="fa fa-check"></i><b>13.2.3</b> Compact Letter Displays</a></li>
<li class="chapter" data-level="13.2.4" data-path="linear-programming.html"><a href="linear-programming.html#turf-analysis"><i class="fa fa-check"></i><b>13.2.4</b> TURF Analysis</a></li>
<li class="chapter" data-level="13.2.5" data-path="linear-programming.html"><a href="linear-programming.html#bundle-optimization"><i class="fa fa-check"></i><b>13.2.5</b> Bundle Optimization</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="linear-programming.html"><a href="linear-programming.html#code-examples-2"><i class="fa fa-check"></i><b>13.3</b> Code Examples</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="pipelines.html"><a href="pipelines.html"><i class="fa fa-check"></i><b>14</b> Pipelines</a></li>
<li class="chapter" data-level="15" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>15</b> Dashboards</a></li>
<li class="chapter" data-level="16" data-path="graph-db.html"><a href="graph-db.html"><i class="fa fa-check"></i><b>16</b> Graph Databases</a></li>
<li class="appendix"><span><b>À la Carte</b></span></li>
<li class="chapter" data-level="A" data-path="start-R.html"><a href="start-R.html"><i class="fa fa-check"></i><b>A</b> Apéritifs (Getting Started)</a>
<ul>
<li class="chapter" data-level="A.1" data-path="start-R.html"><a href="start-R.html#r"><i class="fa fa-check"></i><b>A.1</b> R</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="start-R.html"><a href="start-R.html#why-learn-a-programming-language"><i class="fa fa-check"></i><b>A.1.1</b> Why Learn a Programming Language?</a></li>
<li class="chapter" data-level="A.1.2" data-path="start-R.html"><a href="start-R.html#why-r"><i class="fa fa-check"></i><b>A.1.2</b> Why R?</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="start-R.html"><a href="start-R.html#why-r-1"><i class="fa fa-check"></i><b>A.2</b> Why R?</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-r"><i class="fa fa-check"></i><b>A.2.1</b> Steps to Install R</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="start-R.html"><a href="start-R.html#rstudio"><i class="fa fa-check"></i><b>A.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-rstudio"><i class="fa fa-check"></i><b>A.3.1</b> Steps to Install RStudio</a></li>
<li class="chapter" data-level="A.3.2" data-path="start-R.html"><a href="start-R.html#create-a-local-project"><i class="fa fa-check"></i><b>A.3.2</b> Create a Local Project</a></li>
<li class="chapter" data-level="A.3.3" data-path="start-R.html"><a href="start-R.html#install-and-load-packages"><i class="fa fa-check"></i><b>A.3.3</b> Install and Load Packages</a></li>
<li class="chapter" data-level="A.3.4" data-path="start-R.html"><a href="start-R.html#run-sample-code"><i class="fa fa-check"></i><b>A.3.4</b> Run Sample Code</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="start-R.html"><a href="start-R.html#git-and-github"><i class="fa fa-check"></i><b>A.4</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="start-R.html"><a href="start-R.html#git"><i class="fa fa-check"></i><b>A.4.1</b> Git</a></li>
<li class="chapter" data-level="A.4.2" data-path="start-R.html"><a href="start-R.html#github"><i class="fa fa-check"></i><b>A.4.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="start-R.html"><a href="start-R.html#raw-material"><i class="fa fa-check"></i><b>A.5</b> RAW MATERIAL</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="start-R.html"><a href="start-R.html#principles"><i class="fa fa-check"></i><b>A.5.1</b> Principles</a></li>
<li class="chapter" data-level="A.5.2" data-path="start-R.html"><a href="start-R.html#tools"><i class="fa fa-check"></i><b>A.5.2</b> Tools</a></li>
<li class="chapter" data-level="A.5.3" data-path="start-R.html"><a href="start-R.html#documentation"><i class="fa fa-check"></i><b>A.5.3</b> Documentation</a></li>
<li class="chapter" data-level="A.5.4" data-path="start-R.html"><a href="start-R.html#version-control"><i class="fa fa-check"></i><b>A.5.4</b> Version control</a></li>
<li class="chapter" data-level="A.5.5" data-path="start-R.html"><a href="start-R.html#online-repositories-for-team-collaboration"><i class="fa fa-check"></i><b>A.5.5</b> Online repositories for team collaboration</a></li>
<li class="chapter" data-level="A.5.6" data-path="start-R.html"><a href="start-R.html#building-a-code-base"><i class="fa fa-check"></i><b>A.5.6</b> Building a code base</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>B</b> Digestifs (Next Steps)</a>
<ul>
<li class="chapter" data-level="B.1" data-path="next-steps.html"><a href="next-steps.html#sensory-analysis-in-r"><i class="fa fa-check"></i><b>B.1</b> Sensory Analysis in R</a></li>
<li class="chapter" data-level="B.2" data-path="next-steps.html"><a href="next-steps.html#other-recommended-resources"><i class="fa fa-check"></i><b>B.2</b> Other Recommended Resources</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="next-steps.html"><a href="next-steps.html#r-for-data-science"><i class="fa fa-check"></i><b>B.2.1</b> R for Data Science</a></li>
<li class="chapter" data-level="B.2.2" data-path="next-steps.html"><a href="next-steps.html#hands-on-machine-learning-with-r"><i class="fa fa-check"></i><b>B.2.2</b> Hands-On Machine Learning with R</a></li>
<li class="chapter" data-level="B.2.3" data-path="next-steps.html"><a href="next-steps.html#factoextra"><i class="fa fa-check"></i><b>B.2.3</b> FactoExtra</a></li>
<li class="chapter" data-level="B.2.4" data-path="next-steps.html"><a href="next-steps.html#r-graphics-cookbook"><i class="fa fa-check"></i><b>B.2.4</b> R Graphics Cookbook</a></li>
<li class="chapter" data-level="B.2.5" data-path="next-steps.html"><a href="next-steps.html#storytelling-with-data"><i class="fa fa-check"></i><b>B.2.5</b> Storytelling with Data</a></li>
<li class="chapter" data-level="B.2.6" data-path="next-steps.html"><a href="next-steps.html#text-mining-wtih-r"><i class="fa fa-check"></i><b>B.2.6</b> Text Mining wtih R</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="next-steps.html"><a href="next-steps.html#python-and-other-languages"><i class="fa fa-check"></i><b>B.3</b> Python and Other Languages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Sensory and Consumer Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="auto-report" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Automated Reporting</h1>
<p>Effective communication of results is among the essential duties of the sensory scientist, but the sometimes tedious mechanics of report production together with the sheer volume of data that many scientists now must process combine to make reporting design an afterthought in too many cases. In this tutorial, we review recent advances in automated report production that liberate resources for scientists to focus on the interpretation and communication of results, while simultaneously reducing errors and increasing the consistency of their analyses. We teach the tutorial through an extended example, cumulatively building an R script that takes participates from receipt of an example dataset to a beautifully-designed and nearly completed PowerPoint presentation automatically and using freely available, open-source packages. Details of how to customize the final presentation to incorporate corporate branding - such as logos, font choices, and color palettes - will also be covered.</p>
<div id="what-is-automated-reporting" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> What is Automated Reporting?</h2>
<p>Why Script?
Save time
Reduce errors
Collaboration
Share code with others
Read own code later
Explain choices for analysis, table presentation, charts
Save steps for result creation
Main tools
R/RStudio
RMarkdown, HTML output, etc. (mention but don’t focus)
Packages for Microsoft office production
Officer suite (PowerPoint, Word)
Charts, especially RVG
Extract from Word/PowerPoint
Index
Flextable
Images?
Packages for formatting
extrafont
extrafontdb
Rcolorbrewer</p>
</div>
<div id="excel" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Excel</h2>
<p>Although Excel is not our preferred tool for automated reporting, it is still one of the major ways to access and share data. Most data collection software offer the possibility to export data and results in an Excel format, and most data analysis tools accept Excel format as inputs. With the large use of Excel, it is no surprise that many of our colleagues or clients like to share data and results using such spreadsheets. It is even less a surprise that R provides multiple solutions to import/export results from/to Excel.</p>
<p>For the import of datasets, we have already presented the package <code>{readxl}</code> among others. For exporting results, two complementary packages (yet again, among others!) in terms of ease of use and flexibility in the outcome are proposed: <code>{writexl}</code> and <code>{openxlsx}</code>.</p>
<p>As its name suggests, <code>{writexl}</code> is the extension of <code>{readxl}</code> dedicated to exporting tables to Excel through the <code>write_xlsx()</code> function. Its use is very simple as it only takes as inputs the table (or list of tables) to export to the file specified in the <code>path</code> parameter.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="auto-report.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb45-2"><a href="auto-report.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb45-3"><a href="auto-report.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-4"><a href="auto-report.html#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="auto-report.html#cb45-5" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;Sensory Profile.xlsx&quot;</span>)</span>
<span id="cb45-6"><a href="auto-report.html#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="auto-report.html#cb45-7" aria-hidden="true" tabindex="-1"></a>product_info <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path  =</span> file_path,</span>
<span id="cb45-8"><a href="auto-report.html#cb45-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sheet =</span> <span class="st">&quot;Product Info&quot;</span>,</span>
<span id="cb45-9"><a href="auto-report.html#cb45-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">range =</span> <span class="st">&quot;A1:D12&quot;</span>,</span>
<span id="cb45-10"><a href="auto-report.html#cb45-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-11"><a href="auto-report.html#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="auto-report.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Basic data manipulation: writing a subset into a new xlsx</span></span>
<span id="cb45-13"><a href="auto-report.html#cb45-13" aria-hidden="true" tabindex="-1"></a>product_info <span class="sc">%&gt;%</span> </span>
<span id="cb45-14"><a href="auto-report.html#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Protein <span class="sc">%in%</span> <span class="st">&quot;High&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-15"><a href="auto-report.html#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="at">path =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>, <span class="st">&quot;High Protein Products.xlsx&quot;</span>),</span>
<span id="cb45-16"><a href="auto-report.html#cb45-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The export of tables using the <code>{writexl}</code> package is easy, yet simplistic as it does not allow formatting the tables (except for some minor possibilities for the header), nor does it allow exporting multiple tables within the same sheet. For more advanced exporting options, the use of <strong>{openxlsx}</strong> package is preferred as it allows more flexibility in structuring and formatting the Excel output.</p>
<p>With <code>{openxlsx}</code>, the procedure starts with creating a workbook object <code>wb</code> using the <code>createWorkbook()</code> function, to which we add worksheets through the <code>addWorksheet()</code> function.
On a given worksheet, any table can be exported using <code>writeData()</code> or <code>writeDataTable()</code>, which controls where to write the table through the <code>startRow</code> and <code>startCol</code> options.
Through these different functions, many additional formatting procedure can be applied:</p>
<ul>
<li><code>createWorksheet()</code> allows:
<ul>
<li>show/hide grid lines using <code>gridLines</code>;</li>
<li>color the sheet using <code>tabColour</code>;</li>
<li>change the zoom on the sheet through <code>zoom</code>;</li>
<li>show/hide the tab using <code>visible</code>;</li>
<li>format the worksheet by specifying its size (<code>paperSize</code>) and orientation (<code>orientation</code>).</li>
</ul></li>
<li><code>writeData()</code> and <code>writeDataTable()</code> allow:
<ul>
<li>controlling where to print the data using <code>startRow</code> and <code>startCol</code> (or alternatively <code>xy</code>: <code>xy = c("B",12)</code> prints the table starting in cell B12), hence allowing exporting multiple tables within the same sheet;</li>
<li>including the row names and column names through <code>rowNames</code> and <code>colNames</code>;</li>
<li>formatting the header using <code>headerStyle</code> (incl. color of the text and/or background, font, font size, etc.);</li>
<li>shaping the borders using predefined solutions through <code>borders</code>, or customizing them with <code>borderStyle</code> and <code>borderColour</code>;</li>
<li>adding a filter to the table using <code>withFilter</code>;</li>
<li>converts missing data to “#N/A” or any other string using <code>keepNA</code> and <code>na.string</code>.</li>
</ul></li>
<li>Additional formatting can be controlled using:
<ul>
<li><code>options()</code> to pre-define number formatting, border colors and style that will be applied automatically to each table;</li>
<li><code>modifyBaseFont()</code> to define the font name and font size;</li>
<li><code>freezePane()</code> to freeze the first row and/or column of the table using <code>firstRow = TRUE</code> and <code>firstCol = TRUE</code>;</li>
<li><code>createStyle()</code> to pre-define a style, or <code>addStyle()</code> to apply the styling to selected cells;</li>
<li><code>setColWidths</code> to control column width;</li>
<li><code>conditionalFormatting()</code> styling of cells when they meet pre-defined rules, as for instance to highlight significant p-values.</li>
</ul></li>
</ul>
<p>When using <code>{openxlsx}</code>, we recommend to use the same procedure as for Word and PowerPoint:</p>
<ul>
<li>Start with setting the default parameters that should be applied to each table;</li>
<li>Create styles for text or table headers that you save in different elements, and that you apply where needed.</li>
</ul>
<p>In the following example, the sensory profiles are exported into a newly created sheet.</p>
<p>To introduce conditional formatting with <code>{openxlsx}</code>, the sensory profiles are color coded as following: for each cell, the value is compared to the overall mean computed for that column and is colored in red (resp. blue) if it’s higher (resp. lower) than the mean.
In practice, the color style is pre-defined in two parameters called <code>pos_style</code> (red) and <code>neg_style</code> (blue) using <code>createStyle()</code>. The decision whether <code>pos_style</code> or <code>neg_style</code> should be used is defined by the <code>rule</code> parameter from the <code>conditionalFormatting()</code><a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> function.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="auto-report.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb46-2"><a href="auto-report.html#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="auto-report.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-define options to control the borders </span></span>
<span id="cb46-4"><a href="auto-report.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.borderColour&quot;</span> <span class="ot">=</span> <span class="st">&quot;#4F80BD&quot;</span>)</span>
<span id="cb46-5"><a href="auto-report.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.borderStyle&quot;</span> <span class="ot">=</span> <span class="st">&quot;thin&quot;</span>)</span>
<span id="cb46-6"><a href="auto-report.html#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="auto-report.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatically set Number formats to 3 values after the decimal</span></span>
<span id="cb46-8"><a href="auto-report.html#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.numFmt&quot;</span> <span class="ot">=</span> <span class="st">&quot;0.000&quot;</span>)</span>
<span id="cb46-9"><a href="auto-report.html#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="auto-report.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a header style in which </span></span>
<span id="cb46-11"><a href="auto-report.html#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a blue background is used,</span></span>
<span id="cb46-12"><a href="auto-report.html#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># borders on top and on the bottom, </span></span>
<span id="cb46-13"><a href="auto-report.html#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the text is centered and is bold</span></span>
<span id="cb46-14"><a href="auto-report.html#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="auto-report.html#cb46-15" aria-hidden="true" tabindex="-1"></a>headSty <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fgFill =</span> <span class="st">&quot;#DCE6F1&quot;</span>,</span>
<span id="cb46-16"><a href="auto-report.html#cb46-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">border =</span> <span class="st">&quot;TopBottom&quot;</span>,</span>
<span id="cb46-17"><a href="auto-report.html#cb46-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">halign =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb46-18"><a href="auto-report.html#cb46-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">textDecoration =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb46-19"><a href="auto-report.html#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="auto-report.html#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Data preparation</span></span>
<span id="cb46-21"><a href="auto-report.html#cb46-21" aria-hidden="true" tabindex="-1"></a>senso_mean <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb46-22"><a href="auto-report.html#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Product) <span class="sc">%&gt;%</span> </span>
<span id="cb46-23"><a href="auto-report.html#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-24"><a href="auto-report.html#cb46-24" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">&quot;Product&quot;</span>)</span>
<span id="cb46-25"><a href="auto-report.html#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="auto-report.html#cb46-26" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(senso_mean, <span class="dv">2</span>, mean)</span>
<span id="cb46-27"><a href="auto-report.html#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="auto-report.html#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create workbook object</span></span>
<span id="cb46-29"><a href="auto-report.html#cb46-29" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> openxlsx<span class="sc">::</span><span class="fu">createWorkbook</span>()</span>
<span id="cb46-30"><a href="auto-report.html#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="auto-report.html#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the font to Calibri size 10</span></span>
<span id="cb46-32"><a href="auto-report.html#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="fu">modifyBaseFont</span>(wb,<span class="at">fontName =</span> <span class="st">&quot;Calibri&quot;</span>, <span class="at">fontSize =</span> <span class="dv">10</span>)</span>
<span id="cb46-33"><a href="auto-report.html#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="auto-report.html#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new worksheet</span></span>
<span id="cb46-35"><a href="auto-report.html#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="at">sheetName =</span> <span class="st">&quot;Mean&quot;</span>, <span class="at">gridLines =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-36"><a href="auto-report.html#cb46-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-37"><a href="auto-report.html#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Write table: note that </span></span>
<span id="cb46-38"><a href="auto-report.html#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="fu">writeDataTable</span>(wb,</span>
<span id="cb46-39"><a href="auto-report.html#cb46-39" aria-hidden="true" tabindex="-1"></a>               <span class="at">sheet =</span> <span class="st">&quot;Mean&quot;</span>,</span>
<span id="cb46-40"><a href="auto-report.html#cb46-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> senso_mean, </span>
<span id="cb46-41"><a href="auto-report.html#cb46-41" aria-hidden="true" tabindex="-1"></a>               <span class="at">startCol =</span> <span class="dv">1</span>,</span>
<span id="cb46-42"><a href="auto-report.html#cb46-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">startRow =</span> <span class="dv">1</span>,</span>
<span id="cb46-43"><a href="auto-report.html#cb46-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">colNames =</span> <span class="cn">TRUE</span>, <span class="at">rowNames =</span> <span class="cn">TRUE</span>, </span>
<span id="cb46-44"><a href="auto-report.html#cb46-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">tableStyle =</span> <span class="st">&quot;TableStyleLight9&quot;</span>)</span>
<span id="cb46-45"><a href="auto-report.html#cb46-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-46"><a href="auto-report.html#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Freezing the table</span></span>
<span id="cb46-47"><a href="auto-report.html#cb46-47" aria-hidden="true" tabindex="-1"></a><span class="fu">freezePane</span>(wb, <span class="at">sheet =</span> <span class="st">&quot;Mean&quot;</span>, <span class="at">firstRow =</span> <span class="cn">TRUE</span>, <span class="at">firstCol =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-48"><a href="auto-report.html#cb46-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-49"><a href="auto-report.html#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Styles for conditional formatting</span></span>
<span id="cb46-50"><a href="auto-report.html#cb46-50" aria-hidden="true" tabindex="-1"></a>pos_style <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fontColour =</span> <span class="st">&quot;firebrick3&quot;</span>, <span class="at">bgFill =</span> <span class="st">&quot;mistyrose1&quot;</span>)</span>
<span id="cb46-51"><a href="auto-report.html#cb46-51" aria-hidden="true" tabindex="-1"></a>neg_style <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fontColour =</span> <span class="st">&quot;navy&quot;</span>, <span class="at">bgFill =</span> <span class="st">&quot;lightsteelblue&quot;</span>)</span>
<span id="cb46-52"><a href="auto-report.html#cb46-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-53"><a href="auto-report.html#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding formatting to the second column</span></span>
<span id="cb46-54"><a href="auto-report.html#cb46-54" aria-hidden="true" tabindex="-1"></a><span class="fu">conditionalFormatting</span>(wb,</span>
<span id="cb46-55"><a href="auto-report.html#cb46-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">&quot;Mean&quot;</span>, </span>
<span id="cb46-56"><a href="auto-report.html#cb46-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cols  =</span> <span class="dv">2</span>,</span>
<span id="cb46-57"><a href="auto-report.html#cb46-57" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rows  =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(senso_mean), </span>
<span id="cb46-58"><a href="auto-report.html#cb46-58" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rule  =</span> <span class="fu">paste0</span>(<span class="st">&quot;&gt;&quot;</span>,overall_mean[<span class="dv">2</span>]),</span>
<span id="cb46-59"><a href="auto-report.html#cb46-59" aria-hidden="true" tabindex="-1"></a>                      <span class="at">style =</span> pos_style)</span>
<span id="cb46-60"><a href="auto-report.html#cb46-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-61"><a href="auto-report.html#cb46-61" aria-hidden="true" tabindex="-1"></a><span class="fu">conditionalFormatting</span>(wb,</span>
<span id="cb46-62"><a href="auto-report.html#cb46-62" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sheet =</span> <span class="st">&quot;Mean&quot;</span>,</span>
<span id="cb46-63"><a href="auto-report.html#cb46-63" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cols  =</span> <span class="dv">2</span>,</span>
<span id="cb46-64"><a href="auto-report.html#cb46-64" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rows  =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(senso_mean), </span>
<span id="cb46-65"><a href="auto-report.html#cb46-65" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rule  =</span> <span class="fu">paste0</span>(<span class="st">&quot;&lt;&quot;</span>,overall_mean[<span class="dv">2</span>]),</span>
<span id="cb46-66"><a href="auto-report.html#cb46-66" aria-hidden="true" tabindex="-1"></a>                      <span class="at">style =</span> neg_style)</span>
<span id="cb46-67"><a href="auto-report.html#cb46-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-68"><a href="auto-report.html#cb46-68" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="st">&quot;Mean&quot;</span>,</span>
<span id="cb46-69"><a href="auto-report.html#cb46-69" aria-hidden="true" tabindex="-1"></a>             <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">ncol</span>(senso_mean)), <span class="at">widths =</span> <span class="dv">12</span>)</span></code></pre></div>
<p>The file is created using <code>saveWorkbook()</code> by specifying the name of the workbook <code>wb</code> and its path through <code>file</code>. In case such workbook already exists, it can be overwritten using <code>overwrite</code>.</p>
<p>TIPS: At any time, you can visualize your file using <code>openXL()</code>: This function opens within Excel the temporary file that is currently being built, hence allowing you to double-check that your code matches your expectations.</p>
<p>For more details on using <strong>{openxlsx}</strong> see <a href="https://rdrr.io/cran/openxlsx/" class="uri">https://rdrr.io/cran/openxlsx/</a>.</p>
</div>
<div id="powerpoint" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> PowerPoint</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="auto-report.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb47-2"><a href="auto-report.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)</span>
<span id="cb47-3"><a href="auto-report.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span></code></pre></div>
<p>With <code>{officer}</code>, the procedure starts with creating a powerpoint object <code>pptx_obj</code> using the <code>read_pptx()</code> function, to which we add slides through the <code>add_slide()</code> function.
On a given worksheet, any type of content (text, graph, table) can be exported using <code>ph_with()</code> (ph ~ placeholder) which controls where to write the content through the <code>location</code> and <code>ph_location</code> options.</p>
<p>Through these different functions, many additional formatting procedure can be applied.</p>
<ul>
<li><code>add_slide()</code> with arguments:
<ul>
<li><code>layout</code> type of slide;</li>
<li><code>master</code> theme of the deck;</li>
</ul></li>
</ul>
<div id="creating-a-powerpoint-deck" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Creating a PowerPoint Deck</h3>
<p><strong>Key functions:</strong>
<code>read_pptx(path)</code> <code>add_slide(x, layout, master)</code> <code>layout_summary(x)</code></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="auto-report.html#cb48-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb48-2"><a href="auto-report.html#cb48-2" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="auto-report.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout  =</span> <span class="st">&#39;Title and Content&#39;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb48-4"><a href="auto-report.html#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="auto-report.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(pptx_obj)</span>
<span id="cb48-6"><a href="auto-report.html#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="auto-report.html#cb48-7" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="auto-report.html#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_summary</span>()</span>
<span id="cb48-9"><a href="auto-report.html#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="auto-report.html#cb48-10" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb48-11"><a href="auto-report.html#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;example_1.pptx&quot;</span>))</span></code></pre></div>
</div>
<div id="powerpoint-themes" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> PowerPoint Themes</h3>
<p>A blank Deck is by default set up with the <em>Office Theme</em>. To use a custom theme, we must create a Deck using the Powerpoint software and use it as input.</p>
<p>Loading a template with a custom theme</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="auto-report.html#cb49-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;templates&quot;</span>, <span class="st">&quot;intergral.pptx&quot;</span>))</span>
<span id="cb49-2"><a href="auto-report.html#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="auto-report.html#cb49-3" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="auto-report.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_summary</span>()</span>
<span id="cb49-5"><a href="auto-report.html#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="auto-report.html#cb49-6" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> <span class="co"># add slide</span></span>
<span id="cb49-7"><a href="auto-report.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Integral&quot;</span>)</span></code></pre></div>
</div>
<div id="placeholders-and-shapes" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Placeholders and Shapes</h3>
<ul>
<li><code>ph_location_type()</code> allows use predefined placeholders for content:
<ul>
<li>title, body</li>
<li>ctrTitle, subTitle, dt, ftr, sldNum</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="auto-report.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1</span></span>
<span id="cb50-2"><a href="auto-report.html#cb50-2" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;My functions are:&quot;</span>, <span class="st">&quot;ph_with&quot;</span>, <span class="st">&quot;ph_location_type&quot;</span>)</span>
<span id="cb50-3"><a href="auto-report.html#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="auto-report.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># first slide</span></span>
<span id="cb50-5"><a href="auto-report.html#cb50-5" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="auto-report.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb50-7"><a href="auto-report.html#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="auto-report.html#cb50-8" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="auto-report.html#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&#39;body&#39;</span>))</span>
<span id="cb50-10"><a href="auto-report.html#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="auto-report.html#cb50-11" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb50-12"><a href="auto-report.html#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">on_slide</span>(<span class="at">index =</span> <span class="dv">1</span>) <span class="co"># set active slide</span></span>
<span id="cb50-13"><a href="auto-report.html#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="auto-report.html#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="fu">slide_summary</span>(pptx_obj) <span class="co"># technical content summary</span></span>
<span id="cb50-15"><a href="auto-report.html#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="auto-report.html#cb50-16" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">head</span>(mtcars)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb50-17"><a href="auto-report.html#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="auto-report.html#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># second slide</span></span>
<span id="cb50-19"><a href="auto-report.html#cb50-19" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb50-20"><a href="auto-report.html#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb50-21"><a href="auto-report.html#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="auto-report.html#cb50-22" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb50-23"><a href="auto-report.html#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&#39;body&#39;</span>)) </span>
<span id="cb50-24"><a href="auto-report.html#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="auto-report.html#cb50-25" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb50-26"><a href="auto-report.html#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;example_2.pptx&quot;</span>))</span></code></pre></div>
<ul>
<li><code>ph_location()</code> allows to specify exact positions for content
<ul>
<li>for left/top/width/height units are inches</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="auto-report.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3</span></span>
<span id="cb51-2"><a href="auto-report.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We add a text box item in a custom position</span></span>
<span id="cb51-3"><a href="auto-report.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The same can be done for an image, logo, custom objects, etc.</span></span>
<span id="cb51-4"><a href="auto-report.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="auto-report.html#cb51-5" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="st">&quot;My text&quot;</span></span>
<span id="cb51-6"><a href="auto-report.html#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="auto-report.html#cb51-7" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="auto-report.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb51-9"><a href="auto-report.html#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="auto-report.html#cb51-10" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb51-11"><a href="auto-report.html#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data, <span class="at">location =</span> <span class="fu">ph_location</span>(<span class="at">left =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="dv">3</span>, <span class="at">height =</span> <span class="dv">1</span>))</span>
<span id="cb51-12"><a href="auto-report.html#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="auto-report.html#cb51-13" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb51-14"><a href="auto-report.html#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;example_3.pptx&quot;</span>))</span></code></pre></div>
</div>
<div id="working-with-text" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Working with Text</h3>
<p>Each new text item added to a PowerPoint via officer is a paragraph object</p>
<p><code>fpar()</code> (“formatted paragraph”) creates this object</p>
<p><code>block_list()</code> allows us to wrap multiple paragraphs together</p>
<p><code>ftext()</code> (“formatted text”) to edit the text before pasting into paragraphs. <code>ftext()</code> requires a second argument called prop which contains the formatting properties.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="auto-report.html#cb52-1" aria-hidden="true" tabindex="-1"></a>my_prop <span class="ot">&lt;-</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">font.size =</span> <span class="dv">14</span>)</span>
<span id="cb52-2"><a href="auto-report.html#cb52-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="fu">ftext</span>(<span class="st">&quot;First Line in Red&quot;</span>, <span class="at">prop =</span> my_prop)</span>
<span id="cb52-3"><a href="auto-report.html#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="auto-report.html#cb52-4" aria-hidden="true" tabindex="-1"></a>my_par <span class="ot">&lt;-</span> <span class="fu">fpar</span>(my_text) <span class="co"># formatted</span></span>
<span id="cb52-5"><a href="auto-report.html#cb52-5" aria-hidden="true" tabindex="-1"></a>blank_line <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;&quot;</span>) <span class="co">#optional</span></span>
<span id="cb52-6"><a href="auto-report.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="auto-report.html#cb52-7" aria-hidden="true" tabindex="-1"></a>my_par2 <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;Second Line&quot;</span>) <span class="co"># unformatted</span></span>
<span id="cb52-8"><a href="auto-report.html#cb52-8" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">block_list</span>(my_par, blank_line, my_par2)</span>
<span id="cb52-9"><a href="auto-report.html#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="auto-report.html#cb52-10" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-11"><a href="auto-report.html#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-12"><a href="auto-report.html#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_list, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>) )</span>
<span id="cb52-13"><a href="auto-report.html#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="auto-report.html#cb52-14" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="auto-report.html#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;example_4.pptx&quot;</span>))</span></code></pre></div>
<p>For more details on using <strong>{officer}</strong> see <a href="https://davidgohel.github.io/officer" class="uri">https://davidgohel.github.io/officer</a>.</p>
</div>
</div>
<div id="tables" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Tables</h2>
<p><code>ph_with</code> accepts a data.frame as value and renders it in a default format</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="auto-report.html#cb53-1" aria-hidden="true" tabindex="-1"></a>ft_data <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="auto-report.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Salty, Sweet, Sour, Bitter) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="auto-report.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="auto-report.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Product =</span> rowname) <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="auto-report.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Salty<span class="sc">:</span>Bitter, as.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="auto-report.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">summarise</span>(.,</span>
<span id="cb53-7"><a href="auto-report.html#cb53-7" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean),</span>
<span id="cb53-8"><a href="auto-report.html#cb53-8" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span><span class="st">&quot;Average&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb53-9"><a href="auto-report.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) </span>
<span id="cb53-10"><a href="auto-report.html#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="auto-report.html#cb53-11" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-12"><a href="auto-report.html#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-13"><a href="auto-report.html#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> ft_data, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-14"><a href="auto-report.html#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;table_1.pptx&quot;</span>))</span></code></pre></div>
<div id="introduction-to-flextable" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Introduction to flextable</h3>
<p>With <code>{flextable}</code>, the procedure starts with creating a flextable object <code>ft_table</code> using the <code>flextable()</code> function.
Flextable objects are compatible with <code>{officer}</code> and therefore are our primary tool for table formatting.
Through different functions, many custom formatting procedure can be applied:</p>
<p><strong>key functions:</strong>
<code>align()</code> <code>bold()</code> <code>font()</code> <code>color()</code> <code>bg()</code> <code>height()</code> &amp; <code>width()</code>
<code>border_outer()</code> &amp; <code>border_inner()</code> &amp; <code>border_inner_h()</code> <code>border_inner_v()</code> <code>autofit()</code></p>
<p>Additional function to learn: <code>merge()</code>, <code>compose()</code> &amp; <code>as_chunk()</code>, <code>style()</code></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="auto-report.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb54-2"><a href="auto-report.html#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="auto-report.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a flextable object</span></span>
<span id="cb54-4"><a href="auto-report.html#cb54-4" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> ft_data <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="auto-report.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span>
<span id="cb54-6"><a href="auto-report.html#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="auto-report.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Flextable objects can be found in the Viewer tab of Rstudio</span></span>
<span id="cb54-8"><a href="auto-report.html#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ft_table)</span></code></pre></div>
</div>
<div id="formatting-examples" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Formatting examples</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="auto-report.html#cb55-1" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> ft_table <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="auto-report.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span> <span class="co"># column width</span></span>
<span id="cb55-3"><a href="auto-report.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alignment of header: we use part argument</span></span>
<span id="cb55-4"><a href="auto-report.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">&quot;center&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="auto-report.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alignment of content: we can use part = &quot;body&quot; or specify exact lines </span></span>
<span id="cb55-6"><a href="auto-report.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ft_data), <span class="at">align =</span> <span class="st">&quot;center&quot;</span>) </span>
<span id="cb55-7"><a href="auto-report.html#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="auto-report.html#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ft_table)</span></code></pre></div>
<p>Set font names, sizes and colors</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="auto-report.html#cb56-1" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> ft_table <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="auto-report.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># main formatting</span></span>
<span id="cb56-3"><a href="auto-report.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="auto-report.html#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> <span class="st">&quot;Calibri&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># since no i or j are input, change is for all data</span></span>
<span id="cb56-5"><a href="auto-report.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> <span class="st">&quot;Roboto&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#different font for header</span></span>
<span id="cb56-6"><a href="auto-report.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="auto-report.html#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="auto-report.html#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># format last row</span></span>
<span id="cb56-9"><a href="auto-report.html#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">i =</span> <span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ft_data)) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb56-10"><a href="auto-report.html#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">italic</span>(<span class="at">i =</span> <span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="sc">~</span>Product <span class="sc">+</span> Salty <span class="sc">+</span> Sweet <span class="sc">+</span> Sour <span class="sc">+</span> Bitter) <span class="sc">%&gt;%</span> <span class="co"># using ~ notation</span></span>
<span id="cb56-11"><a href="auto-report.html#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">i =</span>  <span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="sc">~</span>Sour, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-12"><a href="auto-report.html#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">i =</span>  <span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="sc">~</span>Sweet, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-13"><a href="auto-report.html#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># background colors</span></span>
<span id="cb56-14"><a href="auto-report.html#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">bg =</span> <span class="st">&quot;#324C63&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># a custom background for the header</span></span>
<span id="cb56-15"><a href="auto-report.html#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ft_data), <span class="at">bg =</span> <span class="st">&quot;#EDEDED&quot;</span>) <span class="co"># a custom background for some cells</span></span>
<span id="cb56-16"><a href="auto-report.html#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="auto-report.html#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ft_table)</span></code></pre></div>
<p>Set borders and adjust cells heights and widths</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="auto-report.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BORDERS</span></span>
<span id="cb57-2"><a href="auto-report.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For borders we need to use nested functions (similar to fpar&gt;ftext&gt;fp_text)</span></span>
<span id="cb57-3"><a href="auto-report.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fp_border() is the second level function we will use to specify border&quot;s characteristics</span></span>
<span id="cb57-4"><a href="auto-report.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># as argument it takes color, style, and width</span></span>
<span id="cb57-5"><a href="auto-report.html#cb57-5" aria-hidden="true" tabindex="-1"></a>my_border <span class="ot">&lt;-</span> officer<span class="sc">::</span><span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">style =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb57-6"><a href="auto-report.html#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="auto-report.html#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We use this second level function inside various main border functions</span></span>
<span id="cb57-8"><a href="auto-report.html#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># border_outer(), border_inner(), border_inner_h(), border_inner_v()</span></span>
<span id="cb57-9"><a href="auto-report.html#cb57-9" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> ft_table <span class="sc">%&gt;%</span></span>
<span id="cb57-10"><a href="auto-report.html#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_outer</span>(<span class="at">part =</span> <span class="st">&quot;all&quot;</span>, <span class="at">border =</span> my_border) <span class="sc">%&gt;%</span> <span class="co"># using predefined border</span></span>
<span id="cb57-11"><a href="auto-report.html#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner</span>(<span class="at">part =</span> <span class="st">&quot;body&quot;</span>, <span class="at">border =</span> officer<span class="sc">::</span><span class="fu">fp_border</span>(<span class="at">style =</span> <span class="st">&quot;dashed&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-12"><a href="auto-report.html#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="auto-report.html#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># all measurements are in inches</span></span>
<span id="cb57-14"><a href="auto-report.html#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.2</span>) <span class="sc">%&gt;%</span> <span class="co"># column 1 wider</span></span>
<span id="cb57-15"><a href="auto-report.html#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">height</span>(<span class="at">i =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">1</span>) <span class="co"># last row&#39;s height</span></span>
<span id="cb57-16"><a href="auto-report.html#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="auto-report.html#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ft_table)</span></code></pre></div>
</div>
<div id="add-flextable-object-to-a-powerpoint-slide" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Add flextable object to a powerpoint slide</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="auto-report.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add table to slide</span></span>
<span id="cb58-2"><a href="auto-report.html#cb58-2" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="auto-report.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="auto-report.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> ft_table, <span class="fu">ph_location</span>(<span class="at">left =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-5"><a href="auto-report.html#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;table_2.pptx&quot;</span>))</span></code></pre></div>
<p>For more details on using <strong>{flextable}</strong> see <a href="https://davidgohel.github.io/flextable/" class="uri">https://davidgohel.github.io/flextable/</a>.</p>
</div>
</div>
<div id="charts" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Charts</h2>
<div id="adding-charts-as-images" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Adding charts as images</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="auto-report.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using ggplot2 as plotting library</span></span>
<span id="cb59-2"><a href="auto-report.html#cb59-2" aria-hidden="true" tabindex="-1"></a>chart_to_plot <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="auto-report.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Salty, Sweet, Sour, Bitter) <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="auto-report.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb59-5"><a href="auto-report.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Product =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href="auto-report.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Salty<span class="sc">:</span>Bitter, <span class="at">names_to =</span> <span class="st">&#39;Attribute&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Value&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-7"><a href="auto-report.html#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Product, <span class="at">y =</span> Value, <span class="at">fill =</span> Attribute)) <span class="sc">+</span> </span>
<span id="cb59-8"><a href="auto-report.html#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span>
<span id="cb59-9"><a href="auto-report.html#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="auto-report.html#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chart_to_plot) <span class="co">#in Plots window of Rstudio</span></span></code></pre></div>
</div>
<div id="rvg-package" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> rvg package</h3>
<p>rvg is providing two graphics devices that produces Vector Graphics outputs in <code>DrawingML</code> format for Microsoft PowerPoint with dml_pptx and for Microsoft Excel with dml_xlsx.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="auto-report.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># body location</span></span>
<span id="cb60-2"><a href="auto-report.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvg)</span>
<span id="cb60-3"><a href="auto-report.html#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="auto-report.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># all items on the chart inside the pptx can be editable</span></span>
<span id="cb60-5"><a href="auto-report.html#cb60-5" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-6"><a href="auto-report.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-7"><a href="auto-report.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> <span class="fu">dml</span>(<span class="at">ggobj =</span> chart_to_plot, <span class="at">editable =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-8"><a href="auto-report.html#cb60-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">location=</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&#39;body&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-9"><a href="auto-report.html#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;rvg_1.pptx&quot;</span>))</span>
<span id="cb60-10"><a href="auto-report.html#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="auto-report.html#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">#custom location, all units are in inches</span></span>
<span id="cb60-12"><a href="auto-report.html#cb60-12" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-13"><a href="auto-report.html#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-14"><a href="auto-report.html#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> <span class="fu">dml</span>(<span class="at">ggobj =</span> chart_to_plot, <span class="at">editable =</span> <span class="cn">FALSE</span>),</span>
<span id="cb60-15"><a href="auto-report.html#cb60-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">location =</span>  <span class="fu">ph_location</span>(<span class="at">left =</span> <span class="dv">1</span>, <span class="at">top =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb60-16"><a href="auto-report.html#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;rvg_2.pptx&quot;</span>))</span></code></pre></div>
</div>
<div id="mschart-package" class="section level3" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> mschart package</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="auto-report.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mschart)</span>
<span id="cb61-2"><a href="auto-report.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sample dataframe</span></span>
<span id="cb61-3"><a href="auto-report.html#cb61-3" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="auto-report.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Salty, Sweet, Sour, Bitter) <span class="sc">%&gt;%</span> </span>
<span id="cb61-5"><a href="auto-report.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-6"><a href="auto-report.html#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Product =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="auto-report.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Salty<span class="sc">:</span>Bitter, <span class="at">names_to =</span> <span class="st">&#39;Attribute&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Value&#39;</span>)</span>
<span id="cb61-8"><a href="auto-report.html#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="auto-report.html#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># syntaxis is similar to ggplot2&#39;s aes() with x,y,group</span></span>
<span id="cb61-10"><a href="auto-report.html#cb61-10" aria-hidden="true" tabindex="-1"></a>my_barchart <span class="ot">&lt;-</span> <span class="fu">ms_barchart</span>(<span class="at">data =</span> mydata,</span>
<span id="cb61-11"><a href="auto-report.html#cb61-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> <span class="st">&quot;Product&quot;</span>,</span>
<span id="cb61-12"><a href="auto-report.html#cb61-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>,</span>
<span id="cb61-13"><a href="auto-report.html#cb61-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">&quot;Attribute&quot;</span>)</span>
<span id="cb61-14"><a href="auto-report.html#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="auto-report.html#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co">#the chart is a Powerpoint native object and can be viewed using the preview option in print</span></span>
<span id="cb61-16"><a href="auto-report.html#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_barchart, <span class="at">preview =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-17"><a href="auto-report.html#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co">#the command will work on machines with a Powerpoint Viewer</span></span>
<span id="cb61-18"><a href="auto-report.html#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="auto-report.html#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co"># to add the object to a powerpoint slide we can use the officer&#39;s native ph_with</span></span>
<span id="cb61-20"><a href="auto-report.html#cb61-20" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-21"><a href="auto-report.html#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-22"><a href="auto-report.html#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_barchart, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-23"><a href="auto-report.html#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;rvg_2.pptx&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="word" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Word</h2>
<p>Word documents are created using <code>read_docx()</code>.</p>
<p><code>body_add_par()</code> to add a text paragraph. Paragraphs are automatically separated by line breaks.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="auto-report.html#cb62-1" aria-hidden="true" tabindex="-1"></a>my_doc <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="auto-report.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;My Text&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="auto-report.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Other Text&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="auto-report.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Conclusion&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="auto-report.html#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;doc_1.docx&quot;</span>))</span></code></pre></div>
<p>Unlike a pptx with separate slides, a word document is a continuous object. To create a new page and continue to write on it <code>body_add_break()</code> is used.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="auto-report.html#cb63-1" aria-hidden="true" tabindex="-1"></a>my_doc <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="auto-report.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;My Text&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="auto-report.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_break</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="auto-report.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Conclusion&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-5"><a href="auto-report.html#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;doc_2.docx&quot;</span>))</span></code></pre></div>
<p><code>body_add_fpar()</code> to add a formatted text paragraph
<code>body_add_table()</code> to add a table</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="auto-report.html#cb64-1" aria-hidden="true" tabindex="-1"></a>my_format <span class="ot">&lt;-</span> <span class="fu">fp_text</span>(<span class="at">font.family =</span> <span class="st">&#39;Calibri&#39;</span>, <span class="at">font.size =</span> <span class="dv">14</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb64-2"><a href="auto-report.html#cb64-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="fu">ftext</span>(<span class="st">&#39;My dataset is:&#39;</span>, my_format)</span>
<span id="cb64-3"><a href="auto-report.html#cb64-3" aria-hidden="true" tabindex="-1"></a>my_par <span class="ot">&lt;-</span> <span class="fu">fpar</span>(my_text)</span>
<span id="cb64-4"><a href="auto-report.html#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="auto-report.html#cb64-5" aria-hidden="true" tabindex="-1"></a>doc <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-6"><a href="auto-report.html#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Document Title&quot;</span>, <span class="at">style =</span> <span class="st">&quot;heading 1&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-7"><a href="auto-report.html#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-8"><a href="auto-report.html#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_fpar</span>(my_par, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#formatted paragraph function</span></span>
<span id="cb64-9"><a href="auto-report.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-10"><a href="auto-report.html#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_table</span>(<span class="at">value =</span> <span class="fu">head</span>(mtcars)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">style =</span> <span class="st">&quot;table_template&quot;</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb64-11"><a href="auto-report.html#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="fu">file.path</span>(<span class="st">&quot;output&quot;</span>,<span class="st">&quot;doc_3.docx&quot;</span>))</span></code></pre></div>

</div>
</div>



</div>
<div class="footnotes">
<hr />
<ol start="13">
<li id="fn13"><p>In <code>conditionalFormatting()</code>, you can specify to which <code>rows</code> and <code>cols</code> the formatting applies. In this example, <code>cols</code> takes <code>2</code> because the first column contains the row names.<a href="auto-report.html#fnref13" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-viz.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-projects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["i2ds4scc_bookdown.pdf", "i2ds4scc_bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
