<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Automated Reporting | Data Science for Sensory and Consumer Scientists</title>
  <meta name="description" content="Open development of data science book for sensory and consumer scientists." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Automated Reporting | Data Science for Sensory and Consumer Scientists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/digital_coffee.png" />
  <meta property="og:description" content="Open development of data science book for sensory and consumer scientists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Automated Reporting | Data Science for Sensory and Consumer Scientists" />
  
  <meta name="twitter:description" content="Open development of data science book for sensory and consumer scientists." />
  <meta name="twitter:image" content="images/digital_coffee.png" />

<meta name="author" content="John Ennis, Julien Delarue, and Thierry Worch" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-viz.html"/>
<link rel="next" href="data-collection.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Sensory and Consumer Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Cover</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#core-principles-in-sensory-and-consumer-science"><i class="fa fa-check"></i><b>1.1</b> Core principles in Sensory and Consumer Science</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#measuring-and-analyzing-human-responses"><i class="fa fa-check"></i><b>1.1.1</b> Measuring and analyzing human responses</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#how-should-sensory-and-consumer-scientists-learn-data-science"><i class="fa fa-check"></i><b>1.2</b> How should sensory and consumer scientists learn data science?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#caution-dont-that-everybody-does"><i class="fa fa-check"></i><b>1.3</b> Caution: Don’t that everybody does</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#example-projects"><i class="fa fa-check"></i><b>1.4</b> Example projects</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>2</b> What is Data Science?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-science.html"><a href="data-science.html#history-and-definition"><i class="fa fa-check"></i><b>2.1</b> History and Definition</a></li>
<li class="chapter" data-level="2.2" data-path="data-science.html"><a href="data-science.html#data-scientific-workflow"><i class="fa fa-check"></i><b>2.2</b> Data Scientific Workflow</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-science.html"><a href="data-science.html#data-collection"><i class="fa fa-check"></i><b>2.2.1</b> Data Collection</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-science.html"><a href="data-science.html#data-preparation"><i class="fa fa-check"></i><b>2.2.2</b> Data Preparation</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-science.html"><a href="data-science.html#data-analysis"><i class="fa fa-check"></i><b>2.2.3</b> Data Analysis</a></li>
<li class="chapter" data-level="2.2.4" data-path="data-science.html"><a href="data-science.html#value-delivery"><i class="fa fa-check"></i><b>2.2.4</b> Value Delivery</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-science.html"><a href="data-science.html#reproducible-research"><i class="fa fa-check"></i><b>2.3</b> Reproducible Research</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-science.html"><a href="data-science.html#principles"><i class="fa fa-check"></i><b>2.3.1</b> Principles</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-science.html"><a href="data-science.html#tools"><i class="fa fa-check"></i><b>2.3.2</b> Tools</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-science.html"><a href="data-science.html#documentation"><i class="fa fa-check"></i><b>2.3.3</b> Documentation</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-science.html"><a href="data-science.html#version-control"><i class="fa fa-check"></i><b>2.3.4</b> Version control</a></li>
<li class="chapter" data-level="2.3.5" data-path="data-science.html"><a href="data-science.html#online-repositories-for-team-collaboration"><i class="fa fa-check"></i><b>2.3.5</b> Online repositories for team collaboration</a></li>
<li class="chapter" data-level="2.3.6" data-path="data-science.html"><a href="data-science.html#building-a-code-base"><i class="fa fa-check"></i><b>2.3.6</b> Building a code base</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-science.html"><a href="data-science.html#benefits-of-data-science"><i class="fa fa-check"></i><b>2.4</b> Benefits of Data Science</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-science.html"><a href="data-science.html#data-driven-decision-making"><i class="fa fa-check"></i><b>2.4.1</b> Data-Driven Decision Making</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-science.html"><a href="data-science.html#standardized-data-collection"><i class="fa fa-check"></i><b>2.4.2</b> Standardized Data Collection</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-science.html"><a href="data-science.html#standardized-reporting"><i class="fa fa-check"></i><b>2.4.3</b> Standardized Reporting</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-science.html"><a href="data-science.html#improved-business-impact"><i class="fa fa-check"></i><b>2.4.4</b> Improved Business Impact</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-science.html"><a href="data-science.html#how-to-learn-data-science"><i class="fa fa-check"></i><b>2.5</b> How to Learn Data Science</a></li>
<li class="chapter" data-level="2.6" data-path="data-science.html"><a href="data-science.html#how-to-use-this-book"><i class="fa fa-check"></i><b>2.6</b> How to Use This Book</a></li>
<li class="chapter" data-level="2.7" data-path="data-science.html"><a href="data-science.html#common-data-science-tools"><i class="fa fa-check"></i><b>2.7</b> Common Data Science Tools</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="start-R.html"><a href="start-R.html"><i class="fa fa-check"></i><b>3</b> Getting Started</a>
<ul>
<li class="chapter" data-level="3.1" data-path="start-R.html"><a href="start-R.html#r"><i class="fa fa-check"></i><b>3.1</b> R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="start-R.html"><a href="start-R.html#why-learn-a-programming-language"><i class="fa fa-check"></i><b>3.1.1</b> Why Learn a Programming Language?</a></li>
<li class="chapter" data-level="3.1.2" data-path="start-R.html"><a href="start-R.html#why-r"><i class="fa fa-check"></i><b>3.1.2</b> Why R?</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="start-R.html"><a href="start-R.html#why-r-1"><i class="fa fa-check"></i><b>3.2</b> Why R?</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-r"><i class="fa fa-check"></i><b>3.2.1</b> Steps to Install R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="start-R.html"><a href="start-R.html#rstudio"><i class="fa fa-check"></i><b>3.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-rstudio"><i class="fa fa-check"></i><b>3.3.1</b> Steps to Install RStudio</a></li>
<li class="chapter" data-level="3.3.2" data-path="start-R.html"><a href="start-R.html#create-a-local-project"><i class="fa fa-check"></i><b>3.3.2</b> Create a Local Project</a></li>
<li class="chapter" data-level="3.3.3" data-path="start-R.html"><a href="start-R.html#install-and-load-packages"><i class="fa fa-check"></i><b>3.3.3</b> Install and Load Packages</a></li>
<li class="chapter" data-level="3.3.4" data-path="start-R.html"><a href="start-R.html#run-sample-code"><i class="fa fa-check"></i><b>3.3.4</b> Run Sample Code</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="start-R.html"><a href="start-R.html#git-and-github"><i class="fa fa-check"></i><b>3.4</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="start-R.html"><a href="start-R.html#git"><i class="fa fa-check"></i><b>3.4.1</b> Git</a></li>
<li class="chapter" data-level="3.4.2" data-path="start-R.html"><a href="start-R.html#github-1"><i class="fa fa-check"></i><b>3.4.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="start-R.html"><a href="start-R.html#raw-material"><i class="fa fa-check"></i><b>3.5</b> RAW MATERIAL</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="start-R.html"><a href="start-R.html#principles-1"><i class="fa fa-check"></i><b>3.5.1</b> Principles</a></li>
<li class="chapter" data-level="3.5.2" data-path="start-R.html"><a href="start-R.html#tools-1"><i class="fa fa-check"></i><b>3.5.2</b> Tools</a></li>
<li class="chapter" data-level="3.5.3" data-path="start-R.html"><a href="start-R.html#documentation-1"><i class="fa fa-check"></i><b>3.5.3</b> Documentation</a></li>
<li class="chapter" data-level="3.5.4" data-path="start-R.html"><a href="start-R.html#version-control-1"><i class="fa fa-check"></i><b>3.5.4</b> Version control</a></li>
<li class="chapter" data-level="3.5.5" data-path="start-R.html"><a href="start-R.html#online-repositories-for-team-collaboration-1"><i class="fa fa-check"></i><b>3.5.5</b> Online repositories for team collaboration</a></li>
<li class="chapter" data-level="3.5.6" data-path="start-R.html"><a href="start-R.html#building-a-code-base-1"><i class="fa fa-check"></i><b>3.5.6</b> Building a code base</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>General Skills</b></span></li>
<li class="chapter" data-level="4" data-path="tidy-thoughts.html"><a href="tidy-thoughts.html"><i class="fa fa-check"></i><b>4</b> Tidy Thinking</a></li>
<li class="chapter" data-level="5" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>5</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="data-manip.html"><a href="data-manip.html#using-the-tidyverse"><i class="fa fa-check"></i><b>5.0.1</b> Using the <code>{tidyverse}</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>6</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-viz.html"><a href="data-viz.html#principles-2"><i class="fa fa-check"></i><b>6.1</b> Principles</a></li>
<li class="chapter" data-level="6.2" data-path="data-viz.html"><a href="data-viz.html#table-mechanics"><i class="fa fa-check"></i><b>6.2</b> Table Mechanics</a></li>
<li class="chapter" data-level="6.3" data-path="data-viz.html"><a href="data-viz.html#chart-mechanics"><i class="fa fa-check"></i><b>6.3</b> Chart Mechanics</a></li>
<li class="chapter" data-level="6.4" data-path="data-viz.html"><a href="data-viz.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a></li>
<li class="chapter" data-level="6.5" data-path="data-viz.html"><a href="data-viz.html#raw-material-1"><i class="fa fa-check"></i><b>6.5</b> Raw Material</a></li>
<li class="chapter" data-level="6.6" data-path="data-viz.html"><a href="data-viz.html#philosophy-of-ggplot2"><i class="fa fa-check"></i><b>6.6</b> Philosophy of ggplot2</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-viz.html"><a href="data-viz.html#aesthetics"><i class="fa fa-check"></i><b>6.6.1</b> aesthetics</a></li>
<li class="chapter" data-level="6.6.2" data-path="data-viz.html"><a href="data-viz.html#geom_"><i class="fa fa-check"></i><b>6.6.2</b> geom_</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="data-viz.html"><a href="data-viz.html#present-the-most-useful-graph"><i class="fa fa-check"></i><b>6.7</b> Present the most useful graph</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="data-viz.html"><a href="data-viz.html#scatter-points"><i class="fa fa-check"></i><b>6.7.1</b> Scatter points</a></li>
<li class="chapter" data-level="6.7.2" data-path="data-viz.html"><a href="data-viz.html#line-charts"><i class="fa fa-check"></i><b>6.7.2</b> Line charts</a></li>
<li class="chapter" data-level="6.7.3" data-path="data-viz.html"><a href="data-viz.html#bar-charts"><i class="fa fa-check"></i><b>6.7.3</b> Bar charts</a></li>
<li class="chapter" data-level="6.7.4" data-path="data-viz.html"><a href="data-viz.html#distribution"><i class="fa fa-check"></i><b>6.7.4</b> Distribution</a></li>
<li class="chapter" data-level="6.7.5" data-path="data-viz.html"><a href="data-viz.html#text"><i class="fa fa-check"></i><b>6.7.5</b> Text</a></li>
<li class="chapter" data-level="6.7.6" data-path="data-viz.html"><a href="data-viz.html#rectangles"><i class="fa fa-check"></i><b>6.7.6</b> Rectangles</a></li>
<li class="chapter" data-level="6.7.7" data-path="data-viz.html"><a href="data-viz.html#themes-and-legend"><i class="fa fa-check"></i><b>6.7.7</b> Themes and legend</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="data-viz.html"><a href="data-viz.html#interesting-addition"><i class="fa fa-check"></i><b>6.8</b> Interesting addition</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="data-viz.html"><a href="data-viz.html#playing-around-with-axes"><i class="fa fa-check"></i><b>6.8.1</b> Playing around with axes</a></li>
<li class="chapter" data-level="6.8.2" data-path="data-viz.html"><a href="data-viz.html#transposing-the-plot"><i class="fa fa-check"></i><b>6.8.2</b> Transposing the plot</a></li>
<li class="chapter" data-level="6.8.3" data-path="data-viz.html"><a href="data-viz.html#splitting-plots"><i class="fa fa-check"></i><b>6.8.3</b> Splitting plots</a></li>
<li class="chapter" data-level="6.8.4" data-path="data-viz.html"><a href="data-viz.html#combining-plots"><i class="fa fa-check"></i><b>6.8.4</b> Combining plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="auto-report.html"><a href="auto-report.html"><i class="fa fa-check"></i><b>7</b> Automated Reporting</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="auto-report.html"><a href="auto-report.html#powerpoint-workflow"><i class="fa fa-check"></i><b>7.0.1</b> PowerPoint workflow</a></li>
<li class="chapter" data-level="7.0.2" data-path="auto-report.html"><a href="auto-report.html#word"><i class="fa fa-check"></i><b>7.0.2</b> Word</a></li>
<li class="chapter" data-level="7.0.3" data-path="auto-report.html"><a href="auto-report.html#excel"><i class="fa fa-check"></i><b>7.0.3</b> Excel</a></li>
<li class="chapter" data-level="7.1" data-path="auto-report.html"><a href="auto-report.html#more-raw-material"><i class="fa fa-check"></i><b>7.1</b> MORE RAW MATERIAL</a></li>
<li class="chapter" data-level="7.2" data-path="auto-report.html"><a href="auto-report.html#powerpint-slide-master"><i class="fa fa-check"></i><b>7.2</b> PowerPint Slide Master</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="auto-report.html"><a href="auto-report.html#importing-the-template"><i class="fa fa-check"></i><b>7.2.1</b> Importing the Template</a></li>
<li class="chapter" data-level="7.2.2" data-path="auto-report.html"><a href="auto-report.html#creating-a-powerpoint-deck"><i class="fa fa-check"></i><b>7.2.2</b> Creating a PowerPoint Deck</a></li>
<li class="chapter" data-level="7.2.3" data-path="auto-report.html"><a href="auto-report.html#selection-pane"><i class="fa fa-check"></i><b>7.2.3</b> Selection Pane</a></li>
<li class="chapter" data-level="7.2.4" data-path="auto-report.html"><a href="auto-report.html#key-functions-read_pptxpath-layout_summaryx-layout_propertiesx-add_slidex-layout-master-on_slidex-index-slide_summaryx-index-null"><i class="fa fa-check"></i><b>7.2.4</b> Key functions: read_pptx(path), layout_summary(x), layout_properties(x), add_slide(x, layout, master), on_slide(x, index), slide_summary(x, index = NULL)</a></li>
<li class="chapter" data-level="7.2.5" data-path="auto-report.html"><a href="auto-report.html#example-code"><i class="fa fa-check"></i><b>7.2.5</b> Example Code</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="auto-report.html"><a href="auto-report.html#placeholders"><i class="fa fa-check"></i><b>7.3</b> Placeholders</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="auto-report.html"><a href="auto-report.html#placeholders-and-shapes"><i class="fa fa-check"></i><b>7.3.1</b> Placeholders and Shapes</a></li>
<li class="chapter" data-level="7.3.2" data-path="auto-report.html"><a href="auto-report.html#key-functions-ph_with"><i class="fa fa-check"></i><b>7.3.2</b> Key functions: ph_with()</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="auto-report.html"><a href="auto-report.html#text-1"><i class="fa fa-check"></i><b>7.4</b> Text</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="auto-report.html"><a href="auto-report.html#working-with-text"><i class="fa fa-check"></i><b>7.4.1</b> Working with Text</a></li>
<li class="chapter" data-level="7.4.2" data-path="auto-report.html"><a href="auto-report.html#key-functions-fpar-ftext-fp_text-block_list"><i class="fa fa-check"></i><b>7.4.2</b> Key functions: fpar(), ftext(), fp_text(), block_list()</a></li>
<li class="chapter" data-level="7.4.3" data-path="auto-report.html"><a href="auto-report.html#example-code-1"><i class="fa fa-check"></i><b>7.4.3</b> Example Code</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="auto-report.html"><a href="auto-report.html#tables"><i class="fa fa-check"></i><b>7.5</b> Tables</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="auto-report.html"><a href="auto-report.html#basic-code"><i class="fa fa-check"></i><b>7.5.1</b> Basic Code</a></li>
<li class="chapter" data-level="7.5.2" data-path="auto-report.html"><a href="auto-report.html#introduction-to-flextable"><i class="fa fa-check"></i><b>7.5.2</b> Introduction to flextable</a></li>
<li class="chapter" data-level="7.5.3" data-path="auto-report.html"><a href="auto-report.html#demonstration"><i class="fa fa-check"></i><b>7.5.3</b> Demonstration</a></li>
<li class="chapter" data-level="7.5.4" data-path="auto-report.html"><a href="auto-report.html#demonstration-output"><i class="fa fa-check"></i><b>7.5.4</b> Demonstration Output</a></li>
<li class="chapter" data-level="7.5.5" data-path="auto-report.html"><a href="auto-report.html#reformat-original-example"><i class="fa fa-check"></i><b>7.5.5</b> Reformat original example</a></li>
<li class="chapter" data-level="7.5.6" data-path="auto-report.html"><a href="auto-report.html#key-functions-flextable-align-bold-font-color-bg-height-width-border_outer-border_inner-border_inner_h-border_inner_v-autofit"><i class="fa fa-check"></i><b>7.5.6</b> key functions: flextable(), align(), bold(), font(), color(), bg(), height() &amp; width(), border_outer() &amp; border_inner() &amp; border_inner_h() &amp; border_inner_v(), autofit()</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="auto-report.html"><a href="auto-report.html#charts"><i class="fa fa-check"></i><b>7.6</b> Charts</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="auto-report.html"><a href="auto-report.html#adding-charts-as-images"><i class="fa fa-check"></i><b>7.6.1</b> Adding charts as images</a></li>
<li class="chapter" data-level="7.6.2" data-path="auto-report.html"><a href="auto-report.html#mschart-package"><i class="fa fa-check"></i><b>7.6.2</b> mschart Package</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="auto-report.html"><a href="auto-report.html#word-1"><i class="fa fa-check"></i><b>7.7</b> Word</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="auto-report.html"><a href="auto-report.html#word-documents"><i class="fa fa-check"></i><b>7.7.1</b> Word documents</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Workflow in Practice</b></span></li>
<li class="chapter" data-level="8" data-path="data-science.html"><a href="data-science.html#data-collection"><i class="fa fa-check"></i><b>8</b> Data Collection</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="data-collection.html"><a href="data-collection.html#other-details"><i class="fa fa-check"></i><b>8.2</b> Other details</a></li>
<li class="chapter" data-level="8.3" data-path="data-collection.html"><a href="data-collection.html#importing-data-to-r"><i class="fa fa-check"></i><b>8.3</b> Importing Data to R</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-collection.html"><a href="data-collection.html#importing-structured-excel-file"><i class="fa fa-check"></i><b>8.3.1</b> Importing Structured Excel File</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-collection.html"><a href="data-collection.html#importing-unstructured-excel-file"><i class="fa fa-check"></i><b>8.3.2</b> Importing Unstructured Excel File</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>9</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-prep.html"><a href="data-prep.html#inspect-1"><i class="fa fa-check"></i><b>9.1</b> Inspect</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-prep.html"><a href="data-prep.html#data-inspection"><i class="fa fa-check"></i><b>9.1.1</b> Data Inspection</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-prep.html"><a href="data-prep.html#design-inspection"><i class="fa fa-check"></i><b>9.1.2</b> Design Inspection</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-prep.html"><a href="data-prep.html#missing-data-inspection"><i class="fa fa-check"></i><b>9.1.3</b> Missing Data Inspection</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-prep.html"><a href="data-prep.html#clean-1"><i class="fa fa-check"></i><b>9.2</b> Clean</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-prep.html"><a href="data-prep.html#renaming-variables"><i class="fa fa-check"></i><b>9.2.1</b> Renaming Variables</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-prep.html"><a href="data-prep.html#handling-data-type"><i class="fa fa-check"></i><b>9.2.2</b> Handling Data Type</a></li>
<li class="chapter" data-level="9.2.3" data-path="data-prep.html"><a href="data-prep.html#converting-between-types"><i class="fa fa-check"></i><b>9.2.3</b> Converting between Types</a></li>
<li class="chapter" data-level="9.2.4" data-path="data-prep.html"><a href="data-prep.html#handling-missing-values"><i class="fa fa-check"></i><b>9.2.4</b> Handling Missing Values</a></li>
<li class="chapter" data-level="9.2.5" data-path="data-prep.html"><a href="data-prep.html#restructuring-data"><i class="fa fa-check"></i><b>9.2.5</b> Restructuring Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-science.html"><a href="data-science.html#data-analysis"><i class="fa fa-check"></i><b>10</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>10.1</b> Transformation</a></li>
<li class="chapter" data-level="10.2" data-path="data-analysis.html"><a href="data-analysis.html#exploration"><i class="fa fa-check"></i><b>10.2</b> Exploration</a></li>
<li class="chapter" data-level="10.3" data-path="data-analysis.html"><a href="data-analysis.html#modeling"><i class="fa fa-check"></i><b>10.3</b> Modeling</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="data-science.html"><a href="data-science.html#value-delivery"><i class="fa fa-check"></i><b>11</b> Value Delivery</a>
<ul>
<li class="chapter" data-level="11.1" data-path="value-delivery.html"><a href="value-delivery.html"><i class="fa fa-check"></i><b>11.1</b> Design principles</a></li>
<li class="chapter" data-level="11.2" data-path="value-delivery.html"><a href="value-delivery.html#scientific-inquiry-vs-storytelling"><i class="fa fa-check"></i><b>11.2</b> Scientific inquiry vs storytelling</a></li>
<li class="chapter" data-level="11.3" data-path="value-delivery.html"><a href="value-delivery.html#research-reformulation"><i class="fa fa-check"></i><b>11.3</b> Research reformulation</a></li>
<li class="chapter" data-level="11.4" data-path="value-delivery.html"><a href="value-delivery.html#interactive-reporting"><i class="fa fa-check"></i><b>11.4</b> Interactive reporting</a></li>
<li class="chapter" data-level="11.5" data-path="value-delivery.html"><a href="value-delivery.html#excel-1"><i class="fa fa-check"></i><b>11.5</b> Excel</a></li>
<li class="chapter" data-level="11.6" data-path="value-delivery.html"><a href="value-delivery.html#word-2"><i class="fa fa-check"></i><b>11.6</b> Word</a></li>
<li class="chapter" data-level="11.7" data-path="value-delivery.html"><a href="value-delivery.html#powerpoint"><i class="fa fa-check"></i><b>11.7</b> PowerPoint</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="value-delivery.html"><a href="value-delivery.html#charts-1"><i class="fa fa-check"></i><b>11.7.1</b> Charts</a></li>
<li class="chapter" data-level="11.7.2" data-path="value-delivery.html"><a href="value-delivery.html#tables-1"><i class="fa fa-check"></i><b>11.7.2</b> Tables</a></li>
<li class="chapter" data-level="11.7.3" data-path="value-delivery.html"><a href="value-delivery.html#bullet-points"><i class="fa fa-check"></i><b>11.7.3</b> Bullet Points</a></li>
<li class="chapter" data-level="11.7.4" data-path="value-delivery.html"><a href="value-delivery.html#images"><i class="fa fa-check"></i><b>11.7.4</b> Images</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="value-delivery.html"><a href="value-delivery.html#html"><i class="fa fa-check"></i><b>11.8</b> HTML</a></li>
</ul></li>
<li class="part"><span><b>Additional Topics</b></span></li>
<li class="chapter" data-level="12" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>12</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="machine-learning.html"><a href="machine-learning.html#concepts-and-general-workflow-trainingtest"><i class="fa fa-check"></i><b>12.1</b> Concepts and general workflow (training/test)</a></li>
<li class="chapter" data-level="12.2" data-path="machine-learning.html"><a href="machine-learning.html#unsupervised-learning"><i class="fa fa-check"></i><b>12.2</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="machine-learning.html"><a href="machine-learning.html#cluster-analysis"><i class="fa fa-check"></i><b>12.2.1</b> Cluster analysis</a></li>
<li class="chapter" data-level="12.2.2" data-path="machine-learning.html"><a href="machine-learning.html#factor-analysis"><i class="fa fa-check"></i><b>12.2.2</b> Factor analysis</a></li>
<li class="chapter" data-level="12.2.3" data-path="machine-learning.html"><a href="machine-learning.html#principle-components-analysis"><i class="fa fa-check"></i><b>12.2.3</b> Principle components analysis</a></li>
<li class="chapter" data-level="12.2.4" data-path="machine-learning.html"><a href="machine-learning.html#t-sne"><i class="fa fa-check"></i><b>12.2.4</b> t-SNE</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="machine-learning.html"><a href="machine-learning.html#semisupervised-learning"><i class="fa fa-check"></i><b>12.3</b> Semisupervised learning</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="machine-learning.html"><a href="machine-learning.html#pls-regression"><i class="fa fa-check"></i><b>12.3.1</b> PLS regression</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="machine-learning.html"><a href="machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>12.4</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="machine-learning.html"><a href="machine-learning.html#regression"><i class="fa fa-check"></i><b>12.4.1</b> Regression</a></li>
<li class="chapter" data-level="12.4.2" data-path="machine-learning.html"><a href="machine-learning.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>12.4.2</b> K-nearest neighbors</a></li>
<li class="chapter" data-level="12.4.3" data-path="machine-learning.html"><a href="machine-learning.html#decision-trees"><i class="fa fa-check"></i><b>12.4.3</b> Decision trees</a></li>
<li class="chapter" data-level="12.4.4" data-path="machine-learning.html"><a href="machine-learning.html#black-boxes"><i class="fa fa-check"></i><b>12.4.4</b> Black boxes</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="machine-learning.html"><a href="machine-learning.html#predictive-modeling"><i class="fa fa-check"></i><b>12.5</b> Predictive modeling</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="machine-learning.html"><a href="machine-learning.html#predicting-sensory-profiles-from-instrumental-data"><i class="fa fa-check"></i><b>12.5.1</b> Predicting sensory profiles from instrumental data</a></li>
<li class="chapter" data-level="12.5.2" data-path="machine-learning.html"><a href="machine-learning.html#predicting-consumer-response-from-sensory-profiles"><i class="fa fa-check"></i><b>12.5.2</b> Predicting consumer response from sensory profiles</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="machine-learning.html"><a href="machine-learning.html#interpretability"><i class="fa fa-check"></i><b>12.6</b> Interpretability</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="machine-learning.html"><a href="machine-learning.html#lime"><i class="fa fa-check"></i><b>12.6.1</b> LIME</a></li>
<li class="chapter" data-level="12.6.2" data-path="machine-learning.html"><a href="machine-learning.html#dalex"><i class="fa fa-check"></i><b>12.6.2</b> DALEX</a></li>
<li class="chapter" data-level="12.6.3" data-path="machine-learning.html"><a href="machine-learning.html#iml"><i class="fa fa-check"></i><b>12.6.3</b> IML</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="machine-learning.html"><a href="machine-learning.html#cmputer-vision"><i class="fa fa-check"></i><b>12.7</b> Cmputer vision</a></li>
<li class="chapter" data-level="12.8" data-path="machine-learning.html"><a href="machine-learning.html#other-methods-and-resources"><i class="fa fa-check"></i><b>12.8</b> Other methods and resources</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="machine-learning.html"><a href="machine-learning.html#data-prep-1"><i class="fa fa-check"></i><b>12.8.1</b> Data Prep</a></li>
<li class="chapter" data-level="12.8.2" data-path="machine-learning.html"><a href="machine-learning.html#classification-code"><i class="fa fa-check"></i><b>12.8.2</b> Classification Code</a></li>
<li class="chapter" data-level="12.8.3" data-path="machine-learning.html"><a href="machine-learning.html#regression-code"><i class="fa fa-check"></i><b>12.8.3</b> Regression Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>13</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="text-analysis.html"><a href="text-analysis.html#data-import"><i class="fa fa-check"></i><b>13.1</b> Data import</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="text-analysis.html"><a href="text-analysis.html#data-sources"><i class="fa fa-check"></i><b>13.1.1</b> Data sources</a></li>
<li class="chapter" data-level="13.1.2" data-path="text-analysis.html"><a href="text-analysis.html#tokenizing"><i class="fa fa-check"></i><b>13.1.2</b> Tokenizing</a></li>
<li class="chapter" data-level="13.1.3" data-path="text-analysis.html"><a href="text-analysis.html#lemmatization-stemming-and-stop-word-removal"><i class="fa fa-check"></i><b>13.1.3</b> Lemmatization, stemming, and stop word removal</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="text-analysis.html"><a href="text-analysis.html#analysis"><i class="fa fa-check"></i><b>13.2</b> Analysis</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="text-analysis.html"><a href="text-analysis.html#frequency-counts-and-summary-statistics"><i class="fa fa-check"></i><b>13.2.1</b> Frequency counts and summary statistics</a></li>
<li class="chapter" data-level="13.2.2" data-path="text-analysis.html"><a href="text-analysis.html#word-clouds"><i class="fa fa-check"></i><b>13.2.2</b> Word clouds</a></li>
<li class="chapter" data-level="13.2.3" data-path="text-analysis.html"><a href="text-analysis.html#contrast-plots"><i class="fa fa-check"></i><b>13.2.3</b> Contrast plots</a></li>
<li class="chapter" data-level="13.2.4" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>13.2.4</b> Sentiment analysis</a></li>
<li class="chapter" data-level="13.2.5" data-path="text-analysis.html"><a href="text-analysis.html#bigrams-and-word-graphs"><i class="fa fa-check"></i><b>13.2.5</b> Bigrams and word graphs</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="text-analysis.html"><a href="text-analysis.html#raw-material-2"><i class="fa fa-check"></i><b>13.3</b> RAW MATERIAL</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="text-analysis.html"><a href="text-analysis.html#statistical-entities"><i class="fa fa-check"></i><b>13.3.1</b> Statistical entities</a></li>
<li class="chapter" data-level="13.3.2" data-path="text-analysis.html"><a href="text-analysis.html#analysis-of-frequencies-and-term-frequency-document"><i class="fa fa-check"></i><b>13.3.2</b> Analysis of Frequencies and term-frequency document</a></li>
<li class="chapter" data-level="13.3.3" data-path="text-analysis.html"><a href="text-analysis.html#futher-analysis-of-the-words"><i class="fa fa-check"></i><b>13.3.3</b> Futher Analysis of the words</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="pipelines.html"><a href="pipelines.html"><i class="fa fa-check"></i><b>14</b> Pipelines</a></li>
<li class="chapter" data-level="15" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>15</b> What’s Next?</a>
<ul>
<li class="chapter" data-level="15.1" data-path="next-steps.html"><a href="next-steps.html#shiny-2"><i class="fa fa-check"></i><b>15.1</b> Shiny</a></li>
<li class="chapter" data-level="15.2" data-path="next-steps.html"><a href="next-steps.html#graph-databases"><i class="fa fa-check"></i><b>15.2</b> Graph Databases</a></li>
<li class="chapter" data-level="15.3" data-path="next-steps.html"><a href="next-steps.html#sensory-analysis-in-r"><i class="fa fa-check"></i><b>15.3</b> Sensory Analysis in R</a></li>
<li class="chapter" data-level="15.4" data-path="next-steps.html"><a href="next-steps.html#learning-resources"><i class="fa fa-check"></i><b>15.4</b> Learning Resources</a></li>
<li class="chapter" data-level="15.5" data-path="next-steps.html"><a href="next-steps.html#python"><i class="fa fa-check"></i><b>15.5</b> Python</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Sensory and Consumer Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="auto-report" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Automated Reporting</h1>
<p>TUTORIAL TITLE
Increasing Business Impact through Automated Reporting in R</p>
<p>TUTORIAL DESCRIPTION
With this tutorial, we help sensory scientists increase their business impact by leveraging tools for automated report production in R.</p>
<p>ABSTRACT
Effective communication of results is among the essential duties of the sensory scientist, but the sometimes tedious mechanics of report production together with the sheer volume of data that many scientists now must process combine to make reporting design an afterthought in too many cases. In this tutorial, we review recent advances in automated report production that liberate resources for scientists to focus on the interpretation and communication of results, while simultaneously reducing errors and increasing the consistency of their analyses. We teach the tutorial through an extended example, cumulatively building an R script that takes participates from receipt of an example dataset to a beautifully-designed and nearly completed PowerPoint presentation automatically and using freely available, open-source packages. Details of how to customize the final presentation to incorporate corporate branding - such as logos, font choices, and color palettes - will also be covered.</p>
<p>TOPICS COVERED INCLUDE
- What does automated reporting mean in practice?
- Scripting analyses, tables, and charts
- Automated production of PowerPoint presentations
- Building a “cookbook” of reporting recipes
- Font choices and color palettes
- Layering storytelling onto an automated report</p>
<p>SOFTWARE PACKAGES
We use the R programming environment along with several freely available packages such as those that comprise the tidyverse, extrafont, officer, openxlsx, and RColorBrewer. Before the conference, we will provide a full list of packages and versions required to run the script created during the tutorial.
Outline of Section</p>
<p>What is Automated Reporting? [Pull from presentation]
Why Script?
Save time
Reduce errors
Collaboration
Share code with others
Read own code later
Explain choices for analysis, table presentation, charts
Save steps for result creation
Main tools
R/RStudio
RMarkdown, HTML output, etc. (mention but don’t focus)
Packages for Microsoft office production
Officer suite (PowerPoint, Word)
Charts, especially RVG
Extract from Word/PowerPoint
Index
Flextable
Images?
Packages for formatting
extrafont
extrafontdb
Rcolorbrewer</p>
<div id="powerpoint-workflow" class="section level3" number="7.0.1">
<h3><span class="header-section-number">7.0.1</span> PowerPoint workflow</h3>
<p>Start with template
Explain slide master
How to adjust choices
Internal naming (relevant later)
Example
Title slides
Tables
Charts
Bullet points
Images
Layout discussion</p>
</div>
<div id="word" class="section level3" number="7.0.2">
<h3><span class="header-section-number">7.0.2</span> Word</h3>
<p>Touch on but not in detail
Shiny
Make dashboards to help non-users (or self)</p>
</div>
<div id="excel" class="section level3" number="7.0.3">
<h3><span class="header-section-number">7.0.3</span> Excel</h3>
<p>Although Excel is not our preferred tool for automated reporting, it is still one of the major ways to access and share data. Most data collection software offers the possibility to export data and/or results in an Excel format, and most data analysis tools accepts Excel format as inputs. With the large use of Excel, it is no surprise that many of our colleagues or clients like to share data and results using such spreadsheets. It is even less a surprise that R provides multiple solutions to import/export results from/to Excel.</p>
<p>For the importation of datasets, we have already presented two packages (<strong>{xlsx}</strong> and <strong>{readxl}</strong>) which provide some interesting options: they will not be detailed any further here.</p>
<p>For exporting results, two complementary packages (amongst others) in terms of ease of use and flexibility in the outcome are considered: <strong>{xlsx}</strong> and <strong>{openxlsx}</strong>.</p>
<p>Besides its option of importing directly Excel files (.xls and .xlsx), the package <strong>{xlsx}</strong> also offers the option to export tables in Excel through the function <code>write.xlsx()</code>. <code>write.xlsx()</code> works in the same way as <code>base::write.csv()</code> (as its name indicates, this function exports tables from R to a .csv file), but since it generates an Excel file (.xls or .xlsx), additional tabs can be added using the <code>append</code> option. The procedure for <code>write.xlsx()</code> is the following:</p>
<ul>
<li>First export the table <code>x=mydata1</code> of interest in a new Excel into the tab entitles “mytab1” of the file “myfile.xlsx” using the options <code>file=“myfile.xlsx”</code> and <code>sheetName= “mytab1”</code>, and set the option <code>append=FALSE</code>.</li>
<li>Then add to <code>file=“myfile.xlsx”</code> any additional table <code>x=mydata2</code> in another tab (e.g. <code>sheet=”mytab2”</code>) using a similar command, but by setting <code>append=TRUE</code>.
By doing so, R understands that “myfile.xlsx” should be extended with a second tab called “mytab2” that contains “mytable2.” The tables exported may or may not include row names and column namess, and the sheet can automatically be password protected using the <code>password</code> option.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="auto-report.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span>
<span id="cb9-2"><a href="auto-report.html#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="auto-report.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We propose here to export the 5 first tables in 5 different tabs.</span></span>
<span id="cb9-4"><a href="auto-report.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb9-5"><a href="auto-report.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-6"><a href="auto-report.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (v<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb9-7"><a href="auto-report.html#cb9-7" aria-hidden="true" tabindex="-1"></a>    append<span class="ot">=</span><span class="cn">FALSE</span></span>
<span id="cb9-8"><a href="auto-report.html#cb9-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-9"><a href="auto-report.html#cb9-9" aria-hidden="true" tabindex="-1"></a>    append<span class="ot">=</span><span class="cn">TRUE</span></span>
<span id="cb9-10"><a href="auto-report.html#cb9-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-11"><a href="auto-report.html#cb9-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-12"><a href="auto-report.html#cb9-12" aria-hidden="true" tabindex="-1"></a>  xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(<span class="fu">as.data.frame</span>(demog_freq[[v]]), </span>
<span id="cb9-13"><a href="auto-report.html#cb9-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">file=</span><span class="st">&quot;thierry_code/Output/Tables using xlsx.xlsx&quot;</span>, </span>
<span id="cb9-14"><a href="auto-report.html#cb9-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheetName=</span><span class="fu">names</span>(demog_freq)[v], </span>
<span id="cb9-15"><a href="auto-report.html#cb9-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">row.names=</span><span class="cn">FALSE</span>, <span class="at">append=</span>append)</span>
<span id="cb9-16"><a href="auto-report.html#cb9-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The exportation of tables using the <strong>{xlsx}</strong> package is easy, yet very simplistic as it does not allow formatting the tables, nor does it allow exporting multiple tables in the same tab. For more advanced exporting options, the use of <strong>{openxlsx}</strong> package is preferred as it allows more flexibility in structuring and formatting the Excel output.</p>
<p>With <strong>{openxlsx}</strong>, the procedure starts with creating a workbook <code>wb</code> using the <code>createWorkbook()</code> function, to which we add worksheets through the <code>addWorksheet()</code> function.
On a given worksheet, any table can be exported using <code>writeData()</code> or <code>writeDataTable()</code>, which controls where to write the table through the <code>startRow</code> and <code>startCol</code> options.
Through these different functions, many additional formatting procedure can be applied:</p>
<ul>
<li><code>createWorksheet()</code> allows:
<ul>
<li>show/hide grid lines using <code>gridLines</code>;</li>
<li>colour the specific sheet using <code>tabColour</code>;</li>
<li>change the zoom on the sheet through <code>zoom</code>;</li>
<li>show/hide the tab using <code>visible</code>;</li>
<li>format the worksheet by specifying its size (<code>paperSize</code>) and orientation (<code>orientation</code>).</li>
</ul></li>
<li><code>writeData()</code> and <code>writeDataTable()</code> allow:
<ul>
<li>controlling where to print the data using <code>startRow</code> and <code>startCol</code> (or alternatively <code>xy</code>: <code>xy=c(“B”,12)</code> prints the table in cell B12), hence allowing exporting multiple tables within the same tab;</li>
<li>including the row names and column names through <code>rowNames</code> and <code>colNames</code>;</li>
<li>formatting the header using <code>headerStyle</code> (incl. colour of the text and/or background, font, font size, etc.) and whether a <code>filter</code> should be applied;</li>
<li>shaping the borders using predefined solutions through <code>borders</code>, or customizing them with <code>borderStyle</code> and <code>borderColour</code>;</li>
<li>adding a filter to the table using <code>withFilger</code>;</li>
<li>converts missing data to “#N/A” or any other string using <code>keepNA</code> and <code>na.string</code>.</li>
</ul></li>
<li>Additional formatting can be controlled using:
<ul>
<li><code>options()</code> to predefine number formatting, border colours and style that will be applied automatically to each tables;</li>
<li><code>modifyBaseFont()</code> to defined the font and font size;</li>
<li><code>freezePane()</code> to freeze the first row and/or column of the table using <code>firstRow=TRUE</code> and <code>firstCol=TRUE</code>;</li>
<li><code>createStyle()</code> to pre-define a style, or <code>addStyle()</code> to apply a later stage some styling to some cells;</li>
<li>controls the width of the columns using <code>setColWidths</code>;</li>
<li><code>conditionalFormatting()</code> allows coloring cells when they meet pre-defined rules, as for instance to highlight significant p-values.</li>
</ul></li>
</ul>
<p>When using <strong>{openxlsx}</strong>, we recommend to use the same procedure as for Word and PowerPoint:</p>
<ul>
<li>Start with setting as default the parameters that should be applied to each table;</li>
<li>Create styles for text or table headers that you save in different elements, and that you apply where needed.</li>
</ul>
<p>In the following example, the sensory profiles are exported in the first tab, and a set of frequency tables are exported in the second tab.
To introduce conditional formatting with <strong>{openxlsx}</strong>, the sensory profiles are color coded as following: For each cell, the value is compared to the overall mean computed for that column and is colored in red (resp. blue) if it’s higher (resp. lower) than the mean.
In practice, the color style is pre-defined in two parameters called <code>pos_style</code> (red) and <code>neg_style</code> (blue) using <code>createStyle()</code>. The decision whether <code>pos_style</code> or <code>neg_style</code> should be used is defined by the <code>rule</code> parameter from the <code>conditionalFormatting()</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="auto-report.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb10-2"><a href="auto-report.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="auto-report.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-define options to control the borders </span></span>
<span id="cb10-4"><a href="auto-report.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.borderColour&quot;</span><span class="ot">=</span><span class="st">&quot;#4F80BD&quot;</span>)</span>
<span id="cb10-5"><a href="auto-report.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.borderStyle&quot;</span><span class="ot">=</span><span class="st">&quot;thin&quot;</span>)</span>
<span id="cb10-6"><a href="auto-report.html#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="auto-report.html#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatically set Number formats to 3 values after the decimal</span></span>
<span id="cb10-8"><a href="auto-report.html#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.numFmt&quot;</span><span class="ot">=</span><span class="st">&quot;0.000&quot;</span>)</span>
<span id="cb10-9"><a href="auto-report.html#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="auto-report.html#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the font to Calibri size 10</span></span>
<span id="cb10-11"><a href="auto-report.html#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">modifyBaseFont</span>(wb, <span class="at">fontSize=</span><span class="dv">10</span>, <span class="at">fontName=</span><span class="st">&quot;Calibri&quot;</span>)</span>
<span id="cb10-12"><a href="auto-report.html#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="auto-report.html#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a header style in which </span></span>
<span id="cb10-14"><a href="auto-report.html#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the text is centered and in bold, </span></span>
<span id="cb10-15"><a href="auto-report.html#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># borders on top and on the bottom, </span></span>
<span id="cb10-16"><a href="auto-report.html#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a blue background is used.</span></span>
<span id="cb10-17"><a href="auto-report.html#cb10-17" aria-hidden="true" tabindex="-1"></a>headSty <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fgFill=</span><span class="st">&quot;#DCE6F1&quot;</span>, <span class="at">border=</span><span class="st">&quot;TopBottom&quot;</span>,</span>
<span id="cb10-18"><a href="auto-report.html#cb10-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">halign=</span><span class="st">&quot;center&quot;</span>, <span class="at">textDecoration=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb10-19"><a href="auto-report.html#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="auto-report.html#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing the colouring for the conditional formatting</span></span>
<span id="cb10-21"><a href="auto-report.html#cb10-21" aria-hidden="true" tabindex="-1"></a>senso_mean <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb10-22"><a href="auto-report.html#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(product) <span class="sc">%&gt;%</span> </span>
<span id="cb10-23"><a href="auto-report.html#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_if</span>(is.numeric, mean) <span class="sc">%&gt;%</span> </span>
<span id="cb10-24"><a href="auto-report.html#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;product&quot;</span>)</span>
<span id="cb10-25"><a href="auto-report.html#cb10-25" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(senso_mean, <span class="dv">2</span>, mean)</span>
<span id="cb10-26"><a href="auto-report.html#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="auto-report.html#cb10-27" aria-hidden="true" tabindex="-1"></a>pos_style <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fontColour=</span><span class="st">&quot;firebrick3&quot;</span>, <span class="at">bgFill=</span><span class="st">&quot;mistyrose1&quot;</span>)</span>
<span id="cb10-28"><a href="auto-report.html#cb10-28" aria-hidden="true" tabindex="-1"></a>neg_style <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fontColour=</span><span class="st">&quot;navy&quot;</span>, <span class="at">bgFill=</span><span class="st">&quot;lightsteelblue&quot;</span>)</span>
<span id="cb10-29"><a href="auto-report.html#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="auto-report.html#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Creation of the workbook wb with two tabs called Mean and Frequency</span></span>
<span id="cb10-31"><a href="auto-report.html#cb10-31" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> openxlsx<span class="sc">::</span><span class="fu">createWorkbook</span>()</span>
<span id="cb10-32"><a href="auto-report.html#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="at">sheetName=</span><span class="st">&quot;Mean&quot;</span>, <span class="at">gridLines=</span><span class="cn">FALSE</span>)</span>
<span id="cb10-33"><a href="auto-report.html#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="at">sheetName=</span><span class="st">&quot;Frequency&quot;</span>, <span class="at">gridLines=</span><span class="cn">FALSE</span>)</span>
<span id="cb10-34"><a href="auto-report.html#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="auto-report.html#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Exporting senso_mean to the first tab (first row and first column are frozen)</span></span>
<span id="cb10-36"><a href="auto-report.html#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># A pre-defined Excel design called TableStyleLight9 is used for this table</span></span>
<span id="cb10-37"><a href="auto-report.html#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="fu">freezePane</span>(wb, <span class="at">sheet=</span><span class="dv">1</span>, <span class="at">firstRow=</span><span class="cn">TRUE</span>, <span class="at">firstCol=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-38"><a href="auto-report.html#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="fu">writeDataTable</span>(wb, <span class="at">sheet=</span><span class="dv">1</span>, <span class="at">x=</span>senso_mean, </span>
<span id="cb10-39"><a href="auto-report.html#cb10-39" aria-hidden="true" tabindex="-1"></a>               <span class="at">colNames=</span><span class="cn">TRUE</span>, <span class="at">rowNames=</span><span class="cn">TRUE</span>, </span>
<span id="cb10-40"><a href="auto-report.html#cb10-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">tableStyle=</span><span class="st">&quot;TableStyleLight9&quot;</span>)</span>
<span id="cb10-41"><a href="auto-report.html#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(senso_mean1)){</span>
<span id="cb10-42"><a href="auto-report.html#cb10-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conditionalFormatting</span>(wb, <span class="dv">1</span>, <span class="at">cols=</span>v<span class="sc">+</span><span class="dv">1</span>, <span class="at">rows=</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(senso_mean1)<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb10-43"><a href="auto-report.html#cb10-43" aria-hidden="true" tabindex="-1"></a>                        <span class="at">rule =</span> <span class="fu">paste0</span>(<span class="st">&quot;&gt;&quot;</span>,overall_mean[[v]]),</span>
<span id="cb10-44"><a href="auto-report.html#cb10-44" aria-hidden="true" tabindex="-1"></a>                        <span class="at">style =</span> pos_style)</span>
<span id="cb10-45"><a href="auto-report.html#cb10-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conditionalFormatting</span>(wb, <span class="dv">1</span>, <span class="at">cols=</span>v<span class="sc">+</span><span class="dv">1</span>, <span class="at">rows=</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(senso_mean1)<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb10-46"><a href="auto-report.html#cb10-46" aria-hidden="true" tabindex="-1"></a>                        <span class="at">rule =</span> <span class="fu">paste0</span>(<span class="st">&quot;&lt;&quot;</span>,overall_mean[[v]]),</span>
<span id="cb10-47"><a href="auto-report.html#cb10-47" aria-hidden="true" tabindex="-1"></a>                        <span class="at">style =</span> neg_style)</span>
<span id="cb10-48"><a href="auto-report.html#cb10-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-49"><a href="auto-report.html#cb10-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-50"><a href="auto-report.html#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we export many different frequency tables in the second tab by:</span></span>
<span id="cb10-51"><a href="auto-report.html#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. adding a title prior to the table</span></span>
<span id="cb10-52"><a href="auto-report.html#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. export the table under its title</span></span>
<span id="cb10-53"><a href="auto-report.html#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. title_r and next_r are used to track where the text is being printed</span></span>
<span id="cb10-54"><a href="auto-report.html#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="dv">2</span>, <span class="at">x=</span><span class="st">&quot;Frequency Tables&quot;</span>, <span class="at">startRow=</span><span class="dv">1</span>, <span class="at">startCol=</span><span class="dv">2</span>)</span>
<span id="cb10-55"><a href="auto-report.html#cb10-55" aria-hidden="true" tabindex="-1"></a>title_r <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb10-56"><a href="auto-report.html#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb10-57"><a href="auto-report.html#cb10-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeData</span>(wb, <span class="dv">2</span>, <span class="at">x=</span><span class="fu">names</span>(demog_freq)[v], <span class="at">startRow=</span><span class="fu">max</span>(title_r), <span class="at">startCol=</span><span class="dv">1</span>)</span>
<span id="cb10-58"><a href="auto-report.html#cb10-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeData</span>(wb, <span class="dv">2</span>, <span class="at">x=</span>demog_freq[[v]], <span class="at">startRow=</span><span class="fu">max</span>(title_r)<span class="sc">+</span><span class="dv">1</span>, <span class="at">startCol=</span><span class="dv">1</span>, </span>
<span id="cb10-59"><a href="auto-report.html#cb10-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">rowNames=</span><span class="cn">FALSE</span>, <span class="at">borders=</span><span class="st">&quot;surrounding&quot;</span>, <span class="at">headerStyle=</span>headSty)</span>
<span id="cb10-60"><a href="auto-report.html#cb10-60" aria-hidden="true" tabindex="-1"></a>  next_r <span class="ot">&lt;-</span> <span class="fu">max</span>(title_r) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">nrow</span>(demog_freq[[v]]) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb10-61"><a href="auto-report.html#cb10-61" aria-hidden="true" tabindex="-1"></a>  title_r <span class="ot">&lt;-</span> <span class="fu">c</span>(title_r, next_r)</span>
<span id="cb10-62"><a href="auto-report.html#cb10-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-63"><a href="auto-report.html#cb10-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-64"><a href="auto-report.html#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="co"># We apply different style for the main title and for each table&#39;s title.</span></span>
<span id="cb10-65"><a href="auto-report.html#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="fu">addStyle</span>(wb, <span class="dv">2</span>, <span class="at">style=</span><span class="fu">createStyle</span>(<span class="at">fontSize=</span><span class="dv">14</span>, <span class="at">textDecoration=</span><span class="st">&quot;bold&quot;</span>), </span>
<span id="cb10-66"><a href="auto-report.html#cb10-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">rows=</span><span class="dv">1</span>, <span class="at">cols=</span><span class="dv">2</span>)</span>
<span id="cb10-67"><a href="auto-report.html#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="fu">addStyle</span>(wb, <span class="dv">2</span>, <span class="at">style=</span><span class="fu">createStyle</span>(<span class="at">fontSize=</span><span class="dv">12</span>, <span class="at">textDecoration=</span><span class="st">&quot;italic&quot;</span>), </span>
<span id="cb10-68"><a href="auto-report.html#cb10-68" aria-hidden="true" tabindex="-1"></a>         <span class="at">rows=</span>title_r, <span class="at">cols=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(title_r)))</span>
<span id="cb10-69"><a href="auto-report.html#cb10-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-70"><a href="auto-report.html#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="dv">2</span>, <span class="at">cols=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">widths=</span><span class="dv">12</span>)</span></code></pre></div>
<p>The file is created using <code>saveWorkbook()</code> by specifying the name of the workbook <code>wb</code> and its path through <code>file</code>. In case such workbook already exists, it can be overwritten using <code>overwrite</code>. Additionally, the user can visualize the file so far created using <code>openXL()</code>.</p>
<p>For more details on using <strong>{openxlsx}</strong> see <a href="https://rdrr.io/cran/openxlsx/" class="uri">https://rdrr.io/cran/openxlsx/</a>.</p>
</div>
<div id="more-raw-material" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> MORE RAW MATERIAL</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="auto-report.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-2"><a href="auto-report.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)</span>
<span id="cb11-3"><a href="auto-report.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span></code></pre></div>
</div>
<div id="powerpint-slide-master" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> PowerPint Slide Master</h2>
<div id="importing-the-template" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Importing the Template</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="auto-report.html#cb12-1" aria-hidden="true" tabindex="-1"></a>my_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;input&quot;</span>,<span class="st">&quot;templates&quot;</span>,<span class="st">&quot;Tutorial Template.pptx&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="auto-report.html#cb12-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">read_pptx</span>()</span>
<span id="cb12-3"><a href="auto-report.html#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="auto-report.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(my_file) <span class="co"># checking if correct class</span></span>
<span id="cb12-5"><a href="auto-report.html#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="auto-report.html#cb12-6" aria-hidden="true" tabindex="-1"></a>my_file <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="auto-report.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_summary</span>()</span></code></pre></div>
</div>
<div id="creating-a-powerpoint-deck" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Creating a PowerPoint Deck</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="auto-report.html#cb13-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span> () <span class="co"># new empty file</span></span>
<span id="cb13-2"><a href="auto-report.html#cb13-2" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="auto-report.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout  =</span> <span class="st">&#39;Title and Content&#39;</span>,<span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb13-4"><a href="auto-report.html#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="auto-report.html#cb13-5" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/first_example.pptx&quot;</span>)</span></code></pre></div>
<p>We can not load the themes of Office <em>ex nihilo</em> returns error</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="auto-report.html#cb14-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb14-2"><a href="auto-report.html#cb14-2" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="auto-report.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Integral&quot;</span>)</span></code></pre></div>
<p>However, we can save an empty pptx with the desired theme and use it as a template</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="auto-report.html#cb15-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>(<span class="fu">file.path</span>(<span class="st">&quot;input&quot;</span>,<span class="st">&quot;templates&quot;</span>,<span class="st">&quot;integral.pptx&quot;</span>))</span>
<span id="cb15-2"><a href="auto-report.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout_summary</span>(pptx_obj)</span></code></pre></div>
<p>We can even load a template with more than one theme</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="auto-report.html#cb16-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>(<span class="fu">file.path</span>(<span class="st">&quot;input&quot;</span>,<span class="st">&quot;templates&quot;</span>,<span class="st">&quot;multmasters.pptx&quot;</span>))</span>
<span id="cb16-2"><a href="auto-report.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout_summary</span>(pptx_obj)</span></code></pre></div>
</div>
<div id="selection-pane" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Selection Pane</h3>
</div>
<div id="key-functions-read_pptxpath-layout_summaryx-layout_propertiesx-add_slidex-layout-master-on_slidex-index-slide_summaryx-index-null" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Key functions: read_pptx(path), layout_summary(x), layout_properties(x), add_slide(x, layout, master), on_slide(x, index), slide_summary(x, index = NULL)</h3>
</div>
<div id="example-code" class="section level3" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Example Code</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="auto-report.html#cb17-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb17-2"><a href="auto-report.html#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="auto-report.html#cb17-3" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> <span class="co"># add slide</span></span>
<span id="cb17-4"><a href="auto-report.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb17-5"><a href="auto-report.html#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="auto-report.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">layout_summary</span>(pptx_obj) <span class="co"># contains only basic layouts</span></span>
<span id="cb17-7"><a href="auto-report.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">layout_properties</span>(pptx_obj) <span class="co"># additional detail</span></span>
<span id="cb17-8"><a href="auto-report.html#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="auto-report.html#cb17-9" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb17-10"><a href="auto-report.html#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">on_slide</span>(<span class="at">index =</span> <span class="dv">1</span>) <span class="co"># set active slide</span></span>
<span id="cb17-11"><a href="auto-report.html#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">slide_summary</span>(pptx_obj) <span class="co"># slide is empty</span></span></code></pre></div>
</div>
</div>
<div id="placeholders" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Placeholders</h2>
<div id="placeholders-and-shapes" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Placeholders and Shapes</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="auto-report.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 1</span></span>
<span id="cb18-2"><a href="auto-report.html#cb18-2" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;My functions are:&quot;</span>,<span class="st">&quot;ph_with&quot;</span>,<span class="st">&quot;ph_location_type&quot;</span>)</span>
<span id="cb18-3"><a href="auto-report.html#cb18-3" aria-hidden="true" tabindex="-1"></a>my_type <span class="ot">&lt;-</span> <span class="st">&quot;body&quot;</span></span>
<span id="cb18-4"><a href="auto-report.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="auto-report.html#cb18-5" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb18-6"><a href="auto-report.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="auto-report.html#cb18-7" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="auto-report.html#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb18-9"><a href="auto-report.html#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="auto-report.html#cb18-10" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="auto-report.html#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data,<span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> my_type))</span>
<span id="cb18-12"><a href="auto-report.html#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="auto-report.html#cb18-13" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="auto-report.html#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test2.1.pptx&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="auto-report.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 2: </span></span>
<span id="cb19-2"><a href="auto-report.html#cb19-2" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">head</span>(mtcars)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb19-3"><a href="auto-report.html#cb19-3" aria-hidden="true" tabindex="-1"></a>my_type <span class="ot">&lt;-</span> <span class="st">&quot;body&quot;</span></span>
<span id="cb19-4"><a href="auto-report.html#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="auto-report.html#cb19-5" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb19-6"><a href="auto-report.html#cb19-6" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb19-7"><a href="auto-report.html#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb19-8"><a href="auto-report.html#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="auto-report.html#cb19-9" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="auto-report.html#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> my_type)) </span>
<span id="cb19-11"><a href="auto-report.html#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="auto-report.html#cb19-12" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="auto-report.html#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test2.2.pptx&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="auto-report.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 3</span></span>
<span id="cb20-2"><a href="auto-report.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We add a text box item in a custom position</span></span>
<span id="cb20-3"><a href="auto-report.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The same can be done for an image, logo, custom objects, etc.</span></span>
<span id="cb20-4"><a href="auto-report.html#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="auto-report.html#cb20-5" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="st">&quot;My text&quot;</span></span>
<span id="cb20-6"><a href="auto-report.html#cb20-6" aria-hidden="true" tabindex="-1"></a>my_type <span class="ot">&lt;-</span> <span class="st">&quot;body&quot;</span></span>
<span id="cb20-7"><a href="auto-report.html#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="auto-report.html#cb20-8" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb20-9"><a href="auto-report.html#cb20-9" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="auto-report.html#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb20-11"><a href="auto-report.html#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="auto-report.html#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">#ph_location is a subfunction which takes as argument </span></span>
<span id="cb20-13"><a href="auto-report.html#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#left/top/width/height, units are inches</span></span>
<span id="cb20-14"><a href="auto-report.html#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="auto-report.html#cb20-15" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="auto-report.html#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data, <span class="at">location =</span> <span class="fu">ph_location</span>(<span class="at">left =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="dv">3</span>, <span class="at">height =</span> <span class="dv">1</span>))</span>
<span id="cb20-17"><a href="auto-report.html#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="auto-report.html#cb20-18" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="auto-report.html#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test2.3.pptx&quot;</span>) </span></code></pre></div>
</div>
<div id="key-functions-ph_with" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Key functions: ph_with()</h3>
</div>
</div>
<div id="text-1" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Text</h2>
<div id="working-with-text" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Working with Text</h3>
<p>Each new text item added to a PowerPoint via officer is a paragraph object
fpar() (“formatted paragraph”) creates this object</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="auto-report.html#cb21-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;My text&quot;</span>)</span>
<span id="cb21-2"><a href="auto-report.html#cb21-2" aria-hidden="true" tabindex="-1"></a>my_type <span class="ot">&lt;-</span> <span class="st">&quot;body&quot;</span></span>
<span id="cb21-3"><a href="auto-report.html#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="auto-report.html#cb21-4" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb21-5"><a href="auto-report.html#cb21-5" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="auto-report.html#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>)</span>
<span id="cb21-7"><a href="auto-report.html#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="auto-report.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Add paragraph</span></span>
<span id="cb21-9"><a href="auto-report.html#cb21-9" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="auto-report.html#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> my_type))</span>
<span id="cb21-11"><a href="auto-report.html#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="auto-report.html#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Try to add a second paragraph</span></span>
<span id="cb21-13"><a href="auto-report.html#cb21-13" aria-hidden="true" tabindex="-1"></a>my_data2 <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;My other text&quot;</span>)</span>
<span id="cb21-14"><a href="auto-report.html#cb21-14" aria-hidden="true" tabindex="-1"></a>my_type <span class="ot">&lt;-</span> <span class="st">&quot;body&quot;</span></span>
<span id="cb21-15"><a href="auto-report.html#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="auto-report.html#cb21-16" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb21-17"><a href="auto-report.html#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data2, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> my_type) )</span>
<span id="cb21-18"><a href="auto-report.html#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="auto-report.html#cb21-19" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb21-20"><a href="auto-report.html#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test3.1.pptx&quot;</span>) </span>
<span id="cb21-21"><a href="auto-report.html#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="do">## As we see, this code doesn’t produce bullet points as we might hope</span></span></code></pre></div>
<p>block_list() allows us to wrap multiple paragraphs together</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="auto-report.html#cb22-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;My text&quot;</span>)</span>
<span id="cb22-2"><a href="auto-report.html#cb22-2" aria-hidden="true" tabindex="-1"></a>blank_line <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb22-3"><a href="auto-report.html#cb22-3" aria-hidden="true" tabindex="-1"></a>my_data2 <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;My other text&quot;</span>)</span>
<span id="cb22-4"><a href="auto-report.html#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="auto-report.html#cb22-5" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">block_list</span>(my_data, blank_line, my_data2)</span>
<span id="cb22-6"><a href="auto-report.html#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="auto-report.html#cb22-7" aria-hidden="true" tabindex="-1"></a>my_type <span class="ot">&lt;-</span> <span class="st">&quot;body&quot;</span></span>
<span id="cb22-8"><a href="auto-report.html#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="auto-report.html#cb22-9" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb22-10"><a href="auto-report.html#cb22-10" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="auto-report.html#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-12"><a href="auto-report.html#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_list, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> my_type) )</span>
<span id="cb22-13"><a href="auto-report.html#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="auto-report.html#cb22-14" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb22-15"><a href="auto-report.html#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test3.2.pptx&quot;</span>) </span></code></pre></div>
<p>Use ftext() (“formatted text”) to edit the text before pasting into paragraphs. ftext() requires a second argument called prop which contains the formatting properties.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="auto-report.html#cb23-1" aria-hidden="true" tabindex="-1"></a>my_prop <span class="ot">&lt;-</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">font.size =</span> <span class="dv">16</span>)</span>
<span id="cb23-2"><a href="auto-report.html#cb23-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="fu">ftext</span>(<span class="st">&quot;Hello&quot;</span>, <span class="at">prop =</span> my_prop)</span>
<span id="cb23-3"><a href="auto-report.html#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="auto-report.html#cb23-4" aria-hidden="true" tabindex="-1"></a>my_par <span class="ot">&lt;-</span> <span class="fu">fpar</span>(my_text) <span class="do">## formatted</span></span>
<span id="cb23-5"><a href="auto-report.html#cb23-5" aria-hidden="true" tabindex="-1"></a>blank_line <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb23-6"><a href="auto-report.html#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="auto-report.html#cb23-7" aria-hidden="true" tabindex="-1"></a>my_par2 <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;My other text&quot;</span>) <span class="do">## unformatted</span></span>
<span id="cb23-8"><a href="auto-report.html#cb23-8" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">block_list</span>(my_par,blank_line, my_par2)</span>
<span id="cb23-9"><a href="auto-report.html#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="auto-report.html#cb23-10" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="co"># new empty file</span></span>
<span id="cb23-11"><a href="auto-report.html#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="auto-report.html#cb23-12" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="auto-report.html#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-14"><a href="auto-report.html#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_list, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> my_type) )</span>
<span id="cb23-15"><a href="auto-report.html#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="auto-report.html#cb23-16" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb23-17"><a href="auto-report.html#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test3.3.pptx&quot;</span>) </span></code></pre></div>
</div>
<div id="key-functions-fpar-ftext-fp_text-block_list" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Key functions: fpar(), ftext(), fp_text(), block_list()</h3>
</div>
<div id="example-code-1" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Example Code</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="auto-report.html#cb24-1" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">block_list</span>(</span>
<span id="cb24-2"><a href="auto-report.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fpar</span>(<span class="fu">ftext</span>(<span class="st">&quot;Hello&quot;</span>, <span class="at">prop =</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">font.size =</span> <span class="dv">16</span>))) ,</span>
<span id="cb24-3"><a href="auto-report.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fpar</span>(<span class="fu">ftext</span>(<span class="st">&quot;World&quot;</span>, <span class="at">prop =</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">font.size =</span> <span class="dv">14</span>))) )</span>
<span id="cb24-4"><a href="auto-report.html#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="auto-report.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The hierarchy is:</span></span>
<span id="cb24-6"><a href="auto-report.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># block_list &gt; fpar &gt; ftext &gt; fp_text</span></span>
<span id="cb24-7"><a href="auto-report.html#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="auto-report.html#cb24-8" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="auto-report.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="auto-report.html#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> <span class="fu">block_list</span>(</span>
<span id="cb24-11"><a href="auto-report.html#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fpar</span>(<span class="fu">ftext</span>(<span class="st">&quot;Hello&quot;</span>, <span class="at">prop =</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">font.size =</span> <span class="dv">16</span>))) ,</span>
<span id="cb24-12"><a href="auto-report.html#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fpar</span>(<span class="fu">ftext</span>(<span class="st">&quot;World&quot;</span>, <span class="at">prop =</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">font.size =</span> <span class="dv">14</span>)))),</span>
<span id="cb24-13"><a href="auto-report.html#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>)</span>
<span id="cb24-14"><a href="auto-report.html#cb24-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="auto-report.html#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test3.4.pptx&quot;</span>) </span></code></pre></div>
</div>
</div>
<div id="tables" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Tables</h2>
<div id="basic-code" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Basic Code</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="auto-report.html#cb25-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">head</span>(mtcars)</span>
<span id="cb25-2"><a href="auto-report.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="auto-report.html#cb25-3" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="auto-report.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="auto-report.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> <span class="fu">head</span>(mtcars), <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="auto-report.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test4.1.pptx&quot;</span>) </span></code></pre></div>
</div>
<div id="introduction-to-flextable" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Introduction to flextable</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="auto-report.html#cb26-1" aria-hidden="true" tabindex="-1"></a>base_table <span class="ot">&lt;-</span> tutorial_data[[<span class="st">&quot;Age&quot;</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="auto-report.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="auto-report.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="at">name =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="auto-report.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Count =</span> <span class="fu">as.integer</span>(Count)) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="auto-report.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percent =</span> <span class="fu">format_percent</span>(Count <span class="sc">/</span> <span class="fu">sum</span>(Count), <span class="at">num_decimals =</span> <span class="dv">2</span>))</span>
<span id="cb26-6"><a href="auto-report.html#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="auto-report.html#cb26-7" aria-hidden="true" tabindex="-1"></a>base_table </span></code></pre></div>
<p>flextable: create attractive tables with predefined formatting. Use of %&gt;% is recommended for readability</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="auto-report.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb27-2"><a href="auto-report.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="auto-report.html#cb27-3" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> base_table <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="auto-report.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span>
<span id="cb27-5"><a href="auto-report.html#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="auto-report.html#cb27-6" aria-hidden="true" tabindex="-1"></a>ft_table <span class="co"># see preliminary result in Viewer tab of RStudio</span></span></code></pre></div>
</div>
<div id="demonstration" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Demonstration</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="auto-report.html#cb28-1" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> base_table <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="auto-report.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="auto-report.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span> <span class="co"># straightforward, column width</span></span>
<span id="cb28-4"><a href="auto-report.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ALIGNMENT</span></span>
<span id="cb28-5"><a href="auto-report.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alignment of header: we use part argument</span></span>
<span id="cb28-6"><a href="auto-report.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">&quot;center&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="auto-report.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alignment of content: we can use part = &quot;body&quot; or specify exact lines </span></span>
<span id="cb28-8"><a href="auto-report.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(base_table), <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(base_table), <span class="at">align =</span> <span class="st">&quot;center&quot;</span>) </span>
<span id="cb28-9"><a href="auto-report.html#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="auto-report.html#cb28-10" aria-hidden="true" tabindex="-1"></a>ft_table</span></code></pre></div>
<p>Set font and characters</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="auto-report.html#cb29-1" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">=</span> ft_table <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="auto-report.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># FONT AND CHARACTERS</span></span>
<span id="cb29-3"><a href="auto-report.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># each command is independent, there are no nested functions as in officer</span></span>
<span id="cb29-4"><a href="auto-report.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bold</span>(<span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="co"># first row, all cols</span></span>
<span id="cb29-5"><a href="auto-report.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">italic</span>(<span class="at">i =</span> <span class="dv">3</span>, <span class="at">j =</span> <span class="sc">~</span>Age<span class="sc">+</span>Count<span class="sc">+</span>Percent) <span class="sc">%&gt;%</span> <span class="co"># first row, all cols, using ~ notation</span></span>
<span id="cb29-6"><a href="auto-report.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-7"><a href="auto-report.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">i =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">16</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="auto-report.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> <span class="st">&quot;Calibri&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># since no i or j are input, change is for all data</span></span>
<span id="cb29-9"><a href="auto-report.html#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> <span class="st">&quot;Roboto&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#different font for header</span></span>
<span id="cb29-10"><a href="auto-report.html#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">i =</span> <span class="dv">3</span>, <span class="at">j =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="auto-report.html#cb29-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-12"><a href="auto-report.html#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># WIDTH AND HEIGHT</span></span>
<span id="cb29-13"><a href="auto-report.html#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># all measurements are in inches</span></span>
<span id="cb29-14"><a href="auto-report.html#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="co"># column 1 wider</span></span>
<span id="cb29-15"><a href="auto-report.html#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">height</span>(<span class="at">i =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> <span class="co"># row 8 change</span></span>
<span id="cb29-16"><a href="auto-report.html#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># CELL COLORS (background) </span></span>
<span id="cb29-17"><a href="auto-report.html#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">bg =</span> <span class="st">&quot;#0088FF&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># a custom background for the header</span></span>
<span id="cb29-18"><a href="auto-report.html#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">i =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">bg =</span> <span class="st">&quot;#C5C5C5&quot;</span>) <span class="co"># a custom background for some cells</span></span>
<span id="cb29-19"><a href="auto-report.html#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="auto-report.html#cb29-20" aria-hidden="true" tabindex="-1"></a>ft_table</span></code></pre></div>
<p>Set borders</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="auto-report.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BORDERS</span></span>
<span id="cb30-2"><a href="auto-report.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For borders we need to use nested functions (similar to fpar&gt;ftext&gt;fp_text)</span></span>
<span id="cb30-3"><a href="auto-report.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fp_border() is the second level function we will use to specify border&quot;s characteristics</span></span>
<span id="cb30-4"><a href="auto-report.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># as argument it takes color, style, and width</span></span>
<span id="cb30-5"><a href="auto-report.html#cb30-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-6"><a href="auto-report.html#cb30-6" aria-hidden="true" tabindex="-1"></a>my_border <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">style =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">width =</span> <span class="dv">2</span>)</span>
<span id="cb30-7"><a href="auto-report.html#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="auto-report.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We use this second level function inside various main border functions</span></span>
<span id="cb30-9"><a href="auto-report.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># border_outer()</span></span>
<span id="cb30-10"><a href="auto-report.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># border_inner()</span></span>
<span id="cb30-11"><a href="auto-report.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># border_inner_h()</span></span>
<span id="cb30-12"><a href="auto-report.html#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># border_inner_v()</span></span>
<span id="cb30-13"><a href="auto-report.html#cb30-13" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> ft_table <span class="sc">%&gt;%</span></span>
<span id="cb30-14"><a href="auto-report.html#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_outer</span>(<span class="at">part =</span> <span class="st">&quot;all&quot;</span>, <span class="at">border =</span> my_border) <span class="sc">%&gt;%</span> <span class="co"># using predefined border</span></span>
<span id="cb30-15"><a href="auto-report.html#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner</span>(<span class="at">part =</span> <span class="st">&quot;body&quot;</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">style =</span> <span class="st">&quot;dashed&quot;</span>))</span>
<span id="cb30-16"><a href="auto-report.html#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="auto-report.html#cb30-17" aria-hidden="true" tabindex="-1"></a>ft_table</span></code></pre></div>
</div>
<div id="demonstration-output" class="section level3" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Demonstration Output</h3>
</div>
<div id="reformat-original-example" class="section level3" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> Reformat original example</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="auto-report.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ft parameters</span></span>
<span id="cb31-2"><a href="auto-report.html#cb31-2" aria-hidden="true" tabindex="-1"></a>header_background_color <span class="ot">=</span> a_green</span>
<span id="cb31-3"><a href="auto-report.html#cb31-3" aria-hidden="true" tabindex="-1"></a>body_background_color <span class="ot">=</span> a_cream</span>
<span id="cb31-4"><a href="auto-report.html#cb31-4" aria-hidden="true" tabindex="-1"></a>header_text_col <span class="ot">=</span> a_cream</span>
<span id="cb31-5"><a href="auto-report.html#cb31-5" aria-hidden="true" tabindex="-1"></a>body_text_col <span class="ot">=</span> a_dark_grey</span>
<span id="cb31-6"><a href="auto-report.html#cb31-6" aria-hidden="true" tabindex="-1"></a>total_text_col <span class="ot">=</span> a_red</span>
<span id="cb31-7"><a href="auto-report.html#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="auto-report.html#cb31-8" aria-hidden="true" tabindex="-1"></a>border_solid <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> a_dark_grey, <span class="at">width =</span> <span class="dv">2</span>)</span>
<span id="cb31-9"><a href="auto-report.html#cb31-9" aria-hidden="true" tabindex="-1"></a>border_dashed <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> a_dark_grey, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">style =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb31-10"><a href="auto-report.html#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="auto-report.html#cb31-11" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> summary_table <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="auto-report.html#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="auto-report.html#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> font_name, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="auto-report.html#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> font_size, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-15"><a href="auto-report.html#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="auto-report.html#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="auto-report.html#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_outer</span>(<span class="at">border =</span> border_solid) <span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="auto-report.html#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_v</span>(<span class="at">border =</span> border_solid, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-19"><a href="auto-report.html#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">border =</span> border_dashed, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-20"><a href="auto-report.html#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_v</span>(<span class="at">border =</span> border_solid, <span class="at">part =</span> <span class="st">&quot;body&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-21"><a href="auto-report.html#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner_h</span>(<span class="at">border =</span> border_dashed, <span class="at">part =</span> <span class="st">&quot;body&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-22"><a href="auto-report.html#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">bg =</span> header_background_color, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-23"><a href="auto-report.html#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">bg =</span> body_background_color, <span class="at">part =</span> <span class="st">&quot;body&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-24"><a href="auto-report.html#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">&quot;center&quot;</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-25"><a href="auto-report.html#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">color =</span> header_text_col, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-26"><a href="auto-report.html#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">color =</span> body_text_col, <span class="at">part =</span> <span class="st">&quot;body&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-27"><a href="auto-report.html#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">color =</span> total_text_col, <span class="at">part =</span> <span class="st">&quot;body&quot;</span>, <span class="at">i =</span> <span class="fu">nrow</span>(summary_table)) <span class="sc">%&gt;%</span></span>
<span id="cb31-28"><a href="auto-report.html#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">italic</span>(<span class="at">part =</span> <span class="st">&quot;body&quot;</span>, <span class="at">i =</span> <span class="fu">nrow</span>(summary_table)) <span class="sc">%&gt;%</span></span>
<span id="cb31-29"><a href="auto-report.html#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;body&quot;</span>, <span class="at">i =</span> <span class="fu">nrow</span>(summary_table)) <span class="sc">%&gt;%</span></span>
<span id="cb31-30"><a href="auto-report.html#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>(<span class="at">add_w =</span> <span class="dv">1</span>)</span>
<span id="cb31-31"><a href="auto-report.html#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="auto-report.html#cb31-32" aria-hidden="true" tabindex="-1"></a>ft</span>
<span id="cb31-33"><a href="auto-report.html#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Add table to slide</span></span>
<span id="cb31-34"><a href="auto-report.html#cb31-34" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-35"><a href="auto-report.html#cb31-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-36"><a href="auto-report.html#cb31-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> ft, <span class="fu">ph_location</span>(<span class="at">left =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="dv">4</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb31-37"><a href="auto-report.html#cb31-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/test4.7.pptx&quot;</span>) </span>
<span id="cb31-38"><a href="auto-report.html#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="co"># positions are fixed. We can find exact positions to center the table</span></span></code></pre></div>
</div>
<div id="key-functions-flextable-align-bold-font-color-bg-height-width-border_outer-border_inner-border_inner_h-border_inner_v-autofit" class="section level3" number="7.5.6">
<h3><span class="header-section-number">7.5.6</span> key functions: flextable(), align(), bold(), font(), color(), bg(), height() &amp; width(), border_outer() &amp; border_inner() &amp; border_inner_h() &amp; border_inner_v(), autofit()</h3>
<p>Additional function to learn: merge(), compose() &amp; as_chunk(), style()</p>
<p>fix_border_issues()</p>
</div>
</div>
<div id="charts" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Charts</h2>
<div id="adding-charts-as-images" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Adding charts as images</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="auto-report.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We have preloaded a function to plot the chart.</span></span>
<span id="cb32-2"><a href="auto-report.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the function is using ggplot2 as plotting library</span></span>
<span id="cb32-3"><a href="auto-report.html#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="auto-report.html#cb32-4" aria-hidden="true" tabindex="-1"></a>chart_to_plot <span class="ot">&lt;-</span> sample_data_list[[<span class="st">&#39;Sample 1&#39;</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="auto-report.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_jar_chart</span>() <span class="co"># code to create a ggplot2 item, we will skip the contents</span></span>
<span id="cb32-6"><a href="auto-report.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chart_to_plot) <span class="co"># see in Plots Window</span></span></code></pre></div>
<div id="rvg-example" class="section level4" number="7.6.1.1">
<h4><span class="header-section-number">7.6.1.1</span> rvg Example</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="auto-report.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the output is a ggplot2 object</span></span>
<span id="cb33-2"><a href="auto-report.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="auto-report.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># To add this object as a rvg object on a slide, we will use the ph_with_vg</span></span>
<span id="cb33-4"><a href="auto-report.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ph_with_vg replaces the ph_with for a rvg object</span></span>
<span id="cb33-5"><a href="auto-report.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ph_with_vg_at allows to input a precise position for a chart, using the top/left we know already</span></span>
<span id="cb33-6"><a href="auto-report.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># all units are in inches</span></span>
<span id="cb33-7"><a href="auto-report.html#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># argument code requires print(chart), argument type is a specific place on slide (&quot;body&quot; or other)</span></span>
<span id="cb33-8"><a href="auto-report.html#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="auto-report.html#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="auto-report.html#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="do">## IMPORTANT: ph_with_vg is is deprecated.</span></span>
<span id="cb33-11"><a href="auto-report.html#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#old syntaxis ph_with_vg(code = print(chart_to_plot), type = &quot;body&quot;) </span></span>
<span id="cb33-12"><a href="auto-report.html#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="auto-report.html#cb33-13" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="auto-report.html#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-15"><a href="auto-report.html#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> <span class="fu">dml</span>(<span class="at">ggobj =</span> chart_to_plot), <span class="at">location  =</span>  <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&#39;body&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-16"><a href="auto-report.html#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/5.2.rvg1.pptx&quot;</span>) </span>
<span id="cb33-17"><a href="auto-report.html#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="auto-report.html#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="do">## IMPORTANT: ph_with_vg_at is is deprecated.</span></span>
<span id="cb33-19"><a href="auto-report.html#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co"># old syntaxis ph_with_vg_at(code = print(chart_to_plot), left = 1, top = 1, width = 8, height = 6) </span></span>
<span id="cb33-20"><a href="auto-report.html#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="auto-report.html#cb33-21" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-22"><a href="auto-report.html#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-23"><a href="auto-report.html#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> <span class="fu">dml</span>(<span class="at">ggobj =</span> chart_to_plot), <span class="at">location =</span>  <span class="fu">ph_location</span>(<span class="at">left =</span> <span class="dv">1</span>, <span class="at">top =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb33-24"><a href="auto-report.html#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/5.2.rvg2.pptx&quot;</span>) </span>
<span id="cb33-25"><a href="auto-report.html#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="auto-report.html#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co"># all items on the chart inside the pptx are now editable, just click on any and see </span></span>
<span id="cb33-27"><a href="auto-report.html#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># the Shape Format tab in PowerPoint</span></span></code></pre></div>
</div>
</div>
<div id="mschart-package" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> mschart Package</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="auto-report.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample dataframe</span></span>
<span id="cb34-2"><a href="auto-report.html#cb34-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> sample_data_list[[<span class="st">&#39;Sample 1&#39;</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="auto-report.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Variable,Response) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span>
<span id="cb34-4"><a href="auto-report.html#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="auto-report.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># syntaxis is similar to ggplot2&quot;s aes() with x,y,group</span></span>
<span id="cb34-6"><a href="auto-report.html#cb34-6" aria-hidden="true" tabindex="-1"></a>my_barchart <span class="ot">&lt;-</span> <span class="fu">ms_barchart</span>(<span class="at">data =</span> mydata, <span class="at">x =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">y =</span> <span class="st">&quot;n&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Response&quot;</span>)</span>
<span id="cb34-7"><a href="auto-report.html#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="auto-report.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># to add the object to a powerpoint slide we can use the officer&quot;s native ph_with</span></span>
<span id="cb34-9"><a href="auto-report.html#cb34-9" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="auto-report.html#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="auto-report.html#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_barchart, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="auto-report.html#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&quot;output/5.3.msoffice.pptx&quot;</span>) </span>
<span id="cb34-13"><a href="auto-report.html#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="auto-report.html#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># if we would open a rvg slide and an ms office slide and click on the slide</span></span>
<span id="cb34-15"><a href="auto-report.html#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># for the rvg slide the only menu that appear is shape format</span></span>
<span id="cb34-16"><a href="auto-report.html#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># While for the msoffice chart we have now the chart design option with all msoffice functionalities</span></span>
<span id="cb34-17"><a href="auto-report.html#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co"># by using chart_settings() functions one can customise in R the charts</span></span></code></pre></div>
</div>
</div>
<div id="word-1" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Word</h2>
<div id="word-documents" class="section level3" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> Word documents</h3>
<p>Formats share similarities</p>
<p>body_add_*()</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="auto-report.html#cb35-1" aria-hidden="true" tabindex="-1"></a>my_doc <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="auto-report.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;My Text&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="auto-report.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Other Text&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="auto-report.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Conclusion&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="auto-report.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&#39;output/6.1.mydoc.docx&#39;</span>)</span></code></pre></div>
<p>body_add_break()</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="auto-report.html#cb36-1" aria-hidden="true" tabindex="-1"></a>my_doc <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="auto-report.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;My Text&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="auto-report.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_break</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="auto-report.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Conclusion&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="auto-report.html#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&#39;output/6.2.mydoc.docx&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="auto-report.html#cb37-1" aria-hidden="true" tabindex="-1"></a>my_format <span class="ot">&lt;-</span> <span class="fu">fp_text</span>(<span class="at">font.family =</span> <span class="st">&#39;Calibri&#39;</span>, <span class="at">font.size =</span> <span class="dv">14</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb37-2"><a href="auto-report.html#cb37-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="fu">ftext</span>(<span class="st">&#39;My dataset is:&#39;</span>, my_format)</span>
<span id="cb37-3"><a href="auto-report.html#cb37-3" aria-hidden="true" tabindex="-1"></a>my_par <span class="ot">&lt;-</span> <span class="fu">fpar</span>(my_text)</span>
<span id="cb37-4"><a href="auto-report.html#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="auto-report.html#cb37-5" aria-hidden="true" tabindex="-1"></a>doc <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-6"><a href="auto-report.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Table of content&quot;</span>, <span class="at">style =</span> <span class="st">&quot;heading 1&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="auto-report.html#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="auto-report.html#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_fpar</span>(my_par, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#formatted paragraph function</span></span>
<span id="cb37-9"><a href="auto-report.html#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-10"><a href="auto-report.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_table</span>(<span class="at">value =</span> <span class="fu">head</span>(mtcars)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">style =</span> <span class="st">&quot;table_template&quot;</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-11"><a href="auto-report.html#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">&#39;output/6.3.mydoc.docx&#39;</span>)</span>
<span id="cb37-12"><a href="auto-report.html#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="auto-report.html#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> <span class="fu">styles_info</span>() </span></code></pre></div>

</div>
</div>
</div>



</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>In <code>conditionalFormatting()</code>, you can specify to which <code>rows</code> and <code>cols</code> the formatting applies. In this example, <code>cols</code> takes <code>v+1</code> because the first column contains the row names.<a href="auto-report.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-viz.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-collection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["i2ds4scc_bookdown.pdf", "i2ds4scc_bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
