<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Automated Reporting | Data Science for Sensory and Consumer Scientists</title>
  <meta name="description" content="Open development of data science book for sensory and consumer scientists.." />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Automated Reporting | Data Science for Sensory and Consumer Scientists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Open development of data science book for sensory and consumer scientists.." />
  <meta name="github-repo" content="john-aigora/i2ds4scc_bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Automated Reporting | Data Science for Sensory and Consumer Scientists" />
  
  <meta name="twitter:description" content="Open development of data science book for sensory and consumer scientists.." />
  

<meta name="author" content="Thierry Worch, Julien Delarue, Vanessa Rios de Souza, and John Ennis" />


<meta name="date" content="2022-12-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-viz.html"/>
<link rel="next" href="example-projects.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<link href="libs/tabwid/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Sensory and Consumer Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-read-this-book"><i class="fa fa-check"></i>Who Should Read This Book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-is-this-book-structured"><i class="fa fa-check"></i>How Is This Book Structured</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How To Use This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="bienvenue.html"><a href="bienvenue.html"><i class="fa fa-check"></i><b>1</b> Bienvenue!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="bienvenue.html"><a href="bienvenue.html#why-data-science-for-sensory-and-consumer-science"><i class="fa fa-check"></i><b>1.1</b> Why Data Science for Sensory and Consumer Science?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="bienvenue.html"><a href="bienvenue.html#core-principles-in-sensory-and-consumer-science"><i class="fa fa-check"></i><b>1.1.1</b> Core principles in Sensory and Consumer Science</a></li>
<li class="chapter" data-level="1.1.2" data-path="bienvenue.html"><a href="bienvenue.html#computational-sensory-science"><i class="fa fa-check"></i><b>1.1.2</b> Computational Sensory Science</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start-R.html"><a href="start-R.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="start-R.html"><a href="start-R.html#introduction-to-r"><i class="fa fa-check"></i><b>2.1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="start-R.html"><a href="start-R.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
<li class="chapter" data-level="2.1.2" data-path="start-R.html"><a href="start-R.html#why-learning-r-or-any-programming-language"><i class="fa fa-check"></i><b>2.1.2</b> Why Learning R (or any Programming Language)?</a></li>
<li class="chapter" data-level="2.1.3" data-path="start-R.html"><a href="start-R.html#why-r"><i class="fa fa-check"></i><b>2.1.3</b> Why R?</a></li>
<li class="chapter" data-level="2.1.4" data-path="start-R.html"><a href="start-R.html#rstudio"><i class="fa fa-check"></i><b>2.1.4</b> Why RStudio/Posit?</a></li>
<li class="chapter" data-level="2.1.5" data-path="start-R.html"><a href="start-R.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.1.5</b> Installing R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="start-R.html"><a href="start-R.html#getting-started-in-r"><i class="fa fa-check"></i><b>2.2</b> Getting Started in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="start-R.html"><a href="start-R.html#packages"><i class="fa fa-check"></i><b>2.2.1</b> Conventions</a></li>
<li class="chapter" data-level="2.2.2" data-path="start-R.html"><a href="start-R.html#install-and-load-packages"><i class="fa fa-check"></i><b>2.2.2</b> Install and Load Packages</a></li>
<li class="chapter" data-level="2.2.3" data-path="start-R.html"><a href="start-R.html#first-analysis-in-r"><i class="fa fa-check"></i><b>2.2.3</b> First Analysis in R</a></li>
<li class="chapter" data-level="2.2.4" data-path="start-R.html"><a href="start-R.html#scripts"><i class="fa fa-check"></i><b>2.2.4</b> R Scripts</a></li>
<li class="chapter" data-level="2.2.5" data-path="start-R.html"><a href="start-R.html#rprojects"><i class="fa fa-check"></i><b>2.2.5</b> Create a Local Project</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="start-R.html"><a href="start-R.html#further-tips-on-how-to-read-this-book"><i class="fa fa-check"></i><b>2.3</b> Further tips on <em>how to read this book?</em></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="start-R.html"><a href="start-R.html#pipes"><i class="fa fa-check"></i><b>2.3.1</b> Introduction to the <code>{magrittr}</code> and the notion of <em>pipes</em></a></li>
<li class="chapter" data-level="2.3.2" data-path="start-R.html"><a href="start-R.html#tibbles"><i class="fa fa-check"></i><b>2.3.2</b> Tibbles</a></li>
<li class="chapter" data-level="2.3.3" data-path="start-R.html"><a href="start-R.html#calling-variables"><i class="fa fa-check"></i><b>2.3.3</b> Calling Variables</a></li>
<li class="chapter" data-level="2.3.4" data-path="start-R.html"><a href="start-R.html#print-save"><i class="fa fa-check"></i><b>2.3.4</b> Printing vs. Saving results</a></li>
<li class="chapter" data-level="2.3.5" data-path="start-R.html"><a href="start-R.html#running-code-and-handling-errors"><i class="fa fa-check"></i><b>2.3.5</b> Running code and handling errors</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="start-R.html"><a href="start-R.html#git-and-github"><i class="fa fa-check"></i><b>2.4</b> Version Control / Git and GitHub</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="start-R.html"><a href="start-R.html#git"><i class="fa fa-check"></i><b>2.4.1</b> Git</a></li>
<li class="chapter" data-level="2.4.2" data-path="start-R.html"><a href="start-R.html#github"><i class="fa fa-check"></i><b>2.4.2</b> GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data_science.html"><a href="data_science.html"><i class="fa fa-check"></i><b>3</b> Why Data Science?</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data_science.html"><a href="data_science.html#history-and-definition"><i class="fa fa-check"></i><b>3.1</b> History and Definition</a></li>
<li class="chapter" data-level="3.2" data-path="data_science.html"><a href="data_science.html#benefits-of-data-science"><i class="fa fa-check"></i><b>3.2</b> Benefits of Data Science</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data_science.html"><a href="data_science.html#reproducible-research"><i class="fa fa-check"></i><b>3.2.1</b> Reproducible Research</a></li>
<li class="chapter" data-level="3.2.2" data-path="data_science.html"><a href="data_science.html#standardized-reporting"><i class="fa fa-check"></i><b>3.2.2</b> Standardized Reporting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data_science.html"><a href="data_science.html#data-scientific-workflow"><i class="fa fa-check"></i><b>3.3</b> Data Scientific Workflow</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data_science.html"><a href="data_science.html#data-collection2"><i class="fa fa-check"></i><b>3.3.1</b> Data Collection</a></li>
<li class="chapter" data-level="3.3.2" data-path="data_science.html"><a href="data_science.html#data-preparation"><i class="fa fa-check"></i><b>3.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="3.3.3" data-path="data_science.html"><a href="data_science.html#data-analysis2"><i class="fa fa-check"></i><b>3.3.3</b> Data Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="data_science.html"><a href="data_science.html#value-delivery2"><i class="fa fa-check"></i><b>3.3.4</b> Value Delivery</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data_science.html"><a href="data_science.html#how-to-learn-data-science"><i class="fa fa-check"></i><b>3.4</b> How to Learn Data Science</a></li>
<li class="chapter" data-level="3.5" data-path="data_science.html"><a href="data_science.html#cautions-dont-that-everybody-does"><i class="fa fa-check"></i><b>3.5</b> Cautions: Don’t that Everybody Does</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manip.html"><a href="data-manip.html#why-manipulating-data"><i class="fa fa-check"></i><b>4.1</b> Why Manipulating Data?</a></li>
<li class="chapter" data-level="4.2" data-path="data-manip.html"><a href="data-manip.html#tidy-data"><i class="fa fa-check"></i><b>4.2</b> Tidying Data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-manip.html"><a href="data-manip.html#simple-manipulations"><i class="fa fa-check"></i><b>4.2.1</b> Simple Manipulations</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-manip.html"><a href="data-manip.html#pivots"><i class="fa fa-check"></i><b>4.2.2</b> Reshaping Data</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-manip.html"><a href="data-manip.html#transformation-that-alters-the-data"><i class="fa fa-check"></i><b>4.2.3</b> Transformation that Alters the Data</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-manip.html"><a href="data-manip.html#combining-data-from-different-sources"><i class="fa fa-check"></i><b>4.2.4</b> Combining Data from Different Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-viz.html"><a href="data-viz.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="data-viz.html"><a href="data-viz.html#design-principles"><i class="fa fa-check"></i><b>5.2</b> Design Principles</a></li>
<li class="chapter" data-level="5.3" data-path="data-viz.html"><a href="data-viz.html#table_making"><i class="fa fa-check"></i><b>5.3</b> Table Making</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-viz.html"><a href="data-viz.html#flextable"><i class="fa fa-check"></i><b>5.3.1</b> Introduction to <code>{flextable}</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="data-viz.html"><a href="data-viz.html#introdution-to-gt"><i class="fa fa-check"></i><b>5.3.2</b> Introdution to <code>{gt}</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-viz.html"><a href="data-viz.html#chart-making"><i class="fa fa-check"></i><b>5.4</b> Chart Making</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-viz.html"><a href="data-viz.html#philosophy-of-ggplot2"><i class="fa fa-check"></i><b>5.4.1</b> Philosophy of <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="data-viz.html"><a href="data-viz.html#getting-started-with-ggplot2"><i class="fa fa-check"></i><b>5.4.2</b> Getting started with <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="5.4.3" data-path="data-viz.html"><a href="data-viz.html#common-charts"><i class="fa fa-check"></i><b>5.4.3</b> Common Charts</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-viz.html"><a href="data-viz.html#miscealleneous"><i class="fa fa-check"></i><b>5.4.4</b> Miscealleneous</a></li>
<li class="chapter" data-level="5.4.5" data-path="data-viz.html"><a href="data-viz.html#few-additional-tips-and-tricks"><i class="fa fa-check"></i><b>5.4.5</b> Few Additional Tips and Tricks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="auto-report.html"><a href="auto-report.html"><i class="fa fa-check"></i><b>6</b> Automated Reporting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="auto-report.html"><a href="auto-report.html#what-and-why-automated-reporting"><i class="fa fa-check"></i><b>6.1</b> What and why Automated Reporting?</a></li>
<li class="chapter" data-level="6.2" data-path="auto-report.html"><a href="auto-report.html#integrating-reports-within-analyses-scripts"><i class="fa fa-check"></i><b>6.2</b> Integrating reports within analyses scripts</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="auto-report.html"><a href="auto-report.html#excel"><i class="fa fa-check"></i><b>6.2.1</b> Excel</a></li>
<li class="chapter" data-level="6.2.2" data-path="auto-report.html"><a href="auto-report.html#powerpoint"><i class="fa fa-check"></i><b>6.2.2</b> PowerPoint</a></li>
<li class="chapter" data-level="6.2.3" data-path="auto-report.html"><a href="auto-report.html#word"><i class="fa fa-check"></i><b>6.2.3</b> Word</a></li>
<li class="chapter" data-level="6.2.4" data-path="auto-report.html"><a href="auto-report.html#notes-on-applying-corporate-branding"><i class="fa fa-check"></i><b>6.2.4</b> Notes on applying corporate branding</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="auto-report.html"><a href="auto-report.html#integrating-analyses-scripts-within-your-reporting-tool"><i class="fa fa-check"></i><b>6.3</b> Integrating analyses scripts within your reporting tool</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="auto-report.html"><a href="auto-report.html#what-is-rmarkdown"><i class="fa fa-check"></i><b>6.3.1</b> What is <code>{rmarkdown}</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="auto-report.html"><a href="auto-report.html#starting-with-rmarkdown"><i class="fa fa-check"></i><b>6.3.2</b> Starting with {rmarkdown}</a></li>
<li class="chapter" data-level="6.3.3" data-path="auto-report.html"><a href="auto-report.html#rmarkdown-through-a-simple-example"><i class="fa fa-check"></i><b>6.3.3</b> <code>{rmarkdown}</code> through a Simple Example</a></li>
<li class="chapter" data-level="6.3.4" data-path="auto-report.html"><a href="auto-report.html#creating-a-document-using-knitr"><i class="fa fa-check"></i><b>6.3.4</b> Creating a document using <code>{knitr}</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="auto-report.html"><a href="auto-report.html#example-of-applications"><i class="fa fa-check"></i><b>6.3.5</b> Example of applications</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="auto-report.html"><a href="auto-report.html#to-go-further"><i class="fa fa-check"></i><b>6.4</b> To go further…</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="example-projects.html"><a href="example-projects.html"><i class="fa fa-check"></i><b>7</b> Example Project: The Biscuit Study</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example-projects.html"><a href="example-projects.html#objective-of-the-test"><i class="fa fa-check"></i><b>7.1</b> Objective of the Test</a></li>
<li class="chapter" data-level="7.2" data-path="example-projects.html"><a href="example-projects.html#products"><i class="fa fa-check"></i><b>7.2</b> Products</a></li>
<li class="chapter" data-level="7.3" data-path="example-projects.html"><a href="example-projects.html#consumer-test"><i class="fa fa-check"></i><b>7.3</b> Consumer test</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="example-projects.html"><a href="example-projects.html#participants"><i class="fa fa-check"></i><b>7.3.1</b> Participants</a></li>
<li class="chapter" data-level="7.3.2" data-path="example-projects.html"><a href="example-projects.html#test-design"><i class="fa fa-check"></i><b>7.3.2</b> Test design</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="example-projects.html"><a href="example-projects.html#sensory-descriptive-analysis-data"><i class="fa fa-check"></i><b>7.4</b> Sensory descriptive analysis data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>8</b> Data Collection</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-collection.html"><a href="data-collection.html#designs-of-sensory-doe-experiments"><i class="fa fa-check"></i><b>8.1</b> Designs of sensory (DoE) experiments</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="data-collection.html"><a href="data-collection.html#general-approach"><i class="fa fa-check"></i><b>8.1.1</b> General approach</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-collection.html"><a href="data-collection.html#Crossover"><i class="fa fa-check"></i><b>8.1.2</b> Crossover designs</a></li>
<li class="chapter" data-level="8.1.3" data-path="data-collection.html"><a href="data-collection.html#BIBD"><i class="fa fa-check"></i><b>8.1.3</b> Balanced incomplete block designs (BIBD)</a></li>
<li class="chapter" data-level="8.1.4" data-path="data-collection.html"><a href="data-collection.html#incomplete-designs-for-hedonic-tests-sensory-informed-designs"><i class="fa fa-check"></i><b>8.1.4</b> Incomplete designs for hedonic tests: Sensory informed designs</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-collection.html"><a href="data-collection.html#product-related-designs"><i class="fa fa-check"></i><b>8.2</b> Product-related designs</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="data-collection.html"><a href="data-collection.html#factorial-designs"><i class="fa fa-check"></i><b>8.2.1</b> Factorial designs</a></li>
<li class="chapter" data-level="8.2.2" data-path="data-collection.html"><a href="data-collection.html#mixture-designs"><i class="fa fa-check"></i><b>8.2.2</b> Mixture designs</a></li>
<li class="chapter" data-level="8.2.3" data-path="data-collection.html"><a href="data-collection.html#screening-designs"><i class="fa fa-check"></i><b>8.2.3</b> Screening designs</a></li>
<li class="chapter" data-level="8.2.4" data-path="data-collection.html"><a href="data-collection.html#sensory-informed-designs"><i class="fa fa-check"></i><b>8.2.4</b> Sensory informed designs</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="data-collection.html"><a href="data-collection.html#execute-1"><i class="fa fa-check"></i><b>8.3</b> Execute</a></li>
<li class="chapter" data-level="8.4" data-path="data-collection.html"><a href="data-collection.html#data-import"><i class="fa fa-check"></i><b>8.4</b> Import</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="data-collection.html"><a href="data-collection.html#importing-structured-excel-file"><i class="fa fa-check"></i><b>8.4.1</b> Importing Structured Excel File</a></li>
<li class="chapter" data-level="8.4.2" data-path="data-collection.html"><a href="data-collection.html#importing-unstructured-excel-file"><i class="fa fa-check"></i><b>8.4.2</b> Importing Unstructured Excel File</a></li>
<li class="chapter" data-level="8.4.3" data-path="data-collection.html"><a href="data-collection.html#import-mult-sheet"><i class="fa fa-check"></i><b>8.4.3</b> Importing Data Stored in Multiple Sheets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>9</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-prep.html"><a href="data-prep.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="data-prep.html"><a href="data-prep.html#inspect"><i class="fa fa-check"></i><b>9.2</b> Inspect</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-prep.html"><a href="data-prep.html#data-inspection"><i class="fa fa-check"></i><b>9.2.1</b> Data Inspection</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-prep.html"><a href="data-prep.html#missing-data"><i class="fa fa-check"></i><b>9.2.2</b> Missing Data</a></li>
<li class="chapter" data-level="9.2.3" data-path="data-prep.html"><a href="data-prep.html#design-inspection"><i class="fa fa-check"></i><b>9.2.3</b> Design Inspection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-prep.html"><a href="data-prep.html#clean"><i class="fa fa-check"></i><b>9.3</b> Clean</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="data-prep.html"><a href="data-prep.html#handling-data-type"><i class="fa fa-check"></i><b>9.3.1</b> Handling Data Type</a></li>
<li class="chapter" data-level="9.3.2" data-path="data-prep.html"><a href="data-prep.html#converting-between-types"><i class="fa fa-check"></i><b>9.3.2</b> Converting between Types</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>10</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-analysis.html"><a href="data-analysis.html#sensory-analysis"><i class="fa fa-check"></i><b>10.1</b> Sensory Data</a></li>
<li class="chapter" data-level="10.2" data-path="data-analysis.html"><a href="data-analysis.html#demographic-and-questionnaire-data"><i class="fa fa-check"></i><b>10.2</b> Demographic and Questionnaire Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-analysis.html"><a href="data-analysis.html#demographic-data-frequency-and-proportion"><i class="fa fa-check"></i><b>10.2.1</b> Demographic Data: Frequency and Proportion</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-analysis.html"><a href="data-analysis.html#eating-behavior-traits-tfeq-data"><i class="fa fa-check"></i><b>10.2.2</b> Eating behavior traits: TFEQ data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-analysis.html"><a href="data-analysis.html#tibble-use"><i class="fa fa-check"></i><b>10.3</b> Consumer Data</a></li>
<li class="chapter" data-level="10.4" data-path="data-analysis.html"><a href="data-analysis.html#combining-sensory-and-consumer-data"><i class="fa fa-check"></i><b>10.4</b> Combining Sensory and Consumer Data</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="data-analysis.html"><a href="data-analysis.html#internal-preference-mapping"><i class="fa fa-check"></i><b>10.4.1</b> Internal Preference Mapping</a></li>
<li class="chapter" data-level="10.4.2" data-path="data-analysis.html"><a href="data-analysis.html#hac"><i class="fa fa-check"></i><b>10.4.2</b> Consumers Clustering</a></li>
<li class="chapter" data-level="10.4.3" data-path="data-analysis.html"><a href="data-analysis.html#drivers-of-liking"><i class="fa fa-check"></i><b>10.4.3</b> Drivers of Liking</a></li>
<li class="chapter" data-level="10.4.4" data-path="data-analysis.html"><a href="data-analysis.html#prefmap"><i class="fa fa-check"></i><b>10.4.4</b> External Preference Mapping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="value-delivery.html"><a href="value-delivery.html"><i class="fa fa-check"></i><b>11</b> Value Delivery</a>
<ul>
<li class="chapter" data-level="11.1" data-path="value-delivery.html"><a href="value-delivery.html#how-to-communicate"><i class="fa fa-check"></i><b>11.1</b> How to Communicate?</a></li>
<li class="chapter" data-level="11.2" data-path="value-delivery.html"><a href="value-delivery.html#exploratory-explanatory-and-predictive-analysis"><i class="fa fa-check"></i><b>11.2</b> Exploratory, Explanatory and Predictive Analysis</a></li>
<li class="chapter" data-level="11.3" data-path="value-delivery.html"><a href="value-delivery.html#audience-awareness"><i class="fa fa-check"></i><b>11.3</b> Audience Awareness</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="value-delivery.html"><a href="value-delivery.html#technical-audience"><i class="fa fa-check"></i><b>11.3.1</b> Technical Audience</a></li>
<li class="chapter" data-level="11.3.2" data-path="value-delivery.html"><a href="value-delivery.html#management"><i class="fa fa-check"></i><b>11.3.2</b> Management</a></li>
<li class="chapter" data-level="11.3.3" data-path="value-delivery.html"><a href="value-delivery.html#general-interest"><i class="fa fa-check"></i><b>11.3.3</b> General Interest</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="value-delivery.html"><a href="value-delivery.html#methods-to-communicate"><i class="fa fa-check"></i><b>11.4</b> Methods to Communicate</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="value-delivery.html"><a href="value-delivery.html#consider-the-mechanism"><i class="fa fa-check"></i><b>11.4.1</b> Consider the Mechanism</a></li>
<li class="chapter" data-level="11.4.2" data-path="value-delivery.html"><a href="value-delivery.html#pick-the-correct-format"><i class="fa fa-check"></i><b>11.4.2</b> Pick the Correct Format</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="value-delivery.html"><a href="value-delivery.html#storytelling"><i class="fa fa-check"></i><b>11.5</b> Storytelling</a></li>
<li class="chapter" data-level="11.6" data-path="value-delivery.html"><a href="value-delivery.html#reformulate2"><i class="fa fa-check"></i><b>11.6</b> Reformulate</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>12</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="machine-learning.html"><a href="machine-learning.html#introduction-2"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="machine-learning.html"><a href="machine-learning.html#introduction-of-the-data"><i class="fa fa-check"></i><b>12.2</b> Introduction of the Data</a></li>
<li class="chapter" data-level="12.3" data-path="machine-learning.html"><a href="machine-learning.html#machine-learning-methods"><i class="fa fa-check"></i><b>12.3</b> Machine Learning Methods</a></li>
<li class="chapter" data-level="12.4" data-path="machine-learning.html"><a href="machine-learning.html#unsupervised-machine-learning"><i class="fa fa-check"></i><b>12.4</b> Unsupervised Machine learning</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="machine-learning.html"><a href="machine-learning.html#dimensionality-reduction"><i class="fa fa-check"></i><b>12.4.1</b> Dimensionality Reduction</a></li>
<li class="chapter" data-level="12.4.2" data-path="machine-learning.html"><a href="machine-learning.html#clustering"><i class="fa fa-check"></i><b>12.4.2</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="machine-learning.html"><a href="machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>12.5</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="machine-learning.html"><a href="machine-learning.html#workflow"><i class="fa fa-check"></i><b>12.5.1</b> Workflow</a></li>
<li class="chapter" data-level="12.5.2" data-path="machine-learning.html"><a href="machine-learning.html#regression"><i class="fa fa-check"></i><b>12.5.2</b> Regression</a></li>
<li class="chapter" data-level="12.5.3" data-path="machine-learning.html"><a href="machine-learning.html#other-common-supervised-ml-algorithms"><i class="fa fa-check"></i><b>12.5.3</b> Other common Supervised ML algorithms</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="machine-learning.html"><a href="machine-learning.html#practical-guide-to-supervised-machine-learning"><i class="fa fa-check"></i><b>12.6</b> Practical Guide to Supervised Machine Learning</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="machine-learning.html"><a href="machine-learning.html#introduction-to-the-tidymodels-framework"><i class="fa fa-check"></i><b>12.6.1</b> Introduction to the <code>{tidymodels}</code> framework</a></li>
<li class="chapter" data-level="12.6.2" data-path="machine-learning.html"><a href="machine-learning.html#sampling-the-data"><i class="fa fa-check"></i><b>12.6.2</b> Sampling the data</a></li>
<li class="chapter" data-level="12.6.3" data-path="machine-learning.html"><a href="machine-learning.html#cross-validation"><i class="fa fa-check"></i><b>12.6.3</b> Cross Validation</a></li>
<li class="chapter" data-level="12.6.4" data-path="machine-learning.html"><a href="machine-learning.html#data-preprocessing-recipes"><i class="fa fa-check"></i><b>12.6.4</b> Data Preprocessing <code>{recipes}</code></a></li>
<li class="chapter" data-level="12.6.5" data-path="machine-learning.html"><a href="machine-learning.html#model-definition"><i class="fa fa-check"></i><b>12.6.5</b> Model definition</a></li>
<li class="chapter" data-level="12.6.6" data-path="machine-learning.html"><a href="machine-learning.html#set-the-whole-process-into-a-workflow"><i class="fa fa-check"></i><b>12.6.6</b> Set the whole Process into a workflow</a></li>
<li class="chapter" data-level="12.6.7" data-path="machine-learning.html"><a href="machine-learning.html#tuning-the-parameters"><i class="fa fa-check"></i><b>12.6.7</b> Tuning the parameters</a></li>
<li class="chapter" data-level="12.6.8" data-path="machine-learning.html"><a href="machine-learning.html#model-training"><i class="fa fa-check"></i><b>12.6.8</b> Model training</a></li>
<li class="chapter" data-level="12.6.9" data-path="machine-learning.html"><a href="machine-learning.html#model-evaluation"><i class="fa fa-check"></i><b>12.6.9</b> Model evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>13</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="text-analysis.html"><a href="text-analysis.html#introduction-to-natural-language-processing"><i class="fa fa-check"></i><b>13.1</b> Introduction to Natural Language Processing</a></li>
<li class="chapter" data-level="13.2" data-path="text-analysis.html"><a href="text-analysis.html#application-of-text-analysis-in-sensory-and-consumer-science"><i class="fa fa-check"></i><b>13.2</b> Application of Text Analysis in Sensory and Consumer Science</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="text-analysis.html"><a href="text-analysis.html#text-analysis-as-way-to-describe-products"><i class="fa fa-check"></i><b>13.2.1</b> Text analysis as way to describe products</a></li>
<li class="chapter" data-level="13.2.2" data-path="text-analysis.html"><a href="text-analysis.html#objectives-of-text-analysis"><i class="fa fa-check"></i><b>13.2.2</b> Objectives of Text Analysis</a></li>
<li class="chapter" data-level="13.2.3" data-path="text-analysis.html"><a href="text-analysis.html#classical-text-analysis-workflow"><i class="fa fa-check"></i><b>13.2.3</b> Classical <em>text analysis</em> workflow</a></li>
<li class="chapter" data-level="13.2.4" data-path="text-analysis.html"><a href="text-analysis.html#warnings"><i class="fa fa-check"></i><b>13.2.4</b> Warnings</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="text-analysis.html"><a href="text-analysis.html#illustration-using-sorting-task-data"><i class="fa fa-check"></i><b>13.3</b> Illustration using Sorting Task Data</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="text-analysis.html"><a href="text-analysis.html#data-pre-processing"><i class="fa fa-check"></i><b>13.3.1</b> Data Pre-processing</a></li>
<li class="chapter" data-level="13.3.2" data-path="text-analysis.html"><a href="text-analysis.html#introduction-to-working-with-strings-stringr"><i class="fa fa-check"></i><b>13.3.2</b> Introduction to working with strings (<code>{stringr}</code>)</a></li>
<li class="chapter" data-level="13.3.3" data-path="text-analysis.html"><a href="text-analysis.html#tokenization"><i class="fa fa-check"></i><b>13.3.3</b> Tokenization</a></li>
<li class="chapter" data-level="13.3.4" data-path="text-analysis.html"><a href="text-analysis.html#simple-transformations"><i class="fa fa-check"></i><b>13.3.4</b> Simple Transformations</a></li>
<li class="chapter" data-level="13.3.5" data-path="text-analysis.html"><a href="text-analysis.html#splitting-further-the-tokens"><i class="fa fa-check"></i><b>13.3.5</b> Splitting further the tokens</a></li>
<li class="chapter" data-level="13.3.6" data-path="text-analysis.html"><a href="text-analysis.html#stopwords"><i class="fa fa-check"></i><b>13.3.6</b> Stopwords</a></li>
<li class="chapter" data-level="13.3.7" data-path="text-analysis.html"><a href="text-analysis.html#stemming-and-lemmatization"><i class="fa fa-check"></i><b>13.3.7</b> Stemming and Lemmatization</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="text-analysis.html"><a href="text-analysis.html#text-analysis-1"><i class="fa fa-check"></i><b>13.4</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="text-analysis.html"><a href="text-analysis.html#raw-frequencies-and-visualization"><i class="fa fa-check"></i><b>13.4.1</b> Raw Frequencies and Visualization</a></li>
<li class="chapter" data-level="13.4.2" data-path="text-analysis.html"><a href="text-analysis.html#bigrams-n-grams"><i class="fa fa-check"></i><b>13.4.2</b> Bigrams, <em>n</em>-grams</a></li>
<li class="chapter" data-level="13.4.3" data-path="text-analysis.html"><a href="text-analysis.html#word-embedding"><i class="fa fa-check"></i><b>13.4.3</b> Word Embedding</a></li>
<li class="chapter" data-level="13.4.4" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>13.4.4</b> Sentiment Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="text-analysis.html"><a href="text-analysis.html#to-go-further-1"><i class="fa fa-check"></i><b>13.5</b> To go further…</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>14</b> Dashboards</a>
<ul>
<li class="chapter" data-level="14.1" data-path="dashboards.html"><a href="dashboards.html#objectives"><i class="fa fa-check"></i><b>14.1</b> Objectives</a></li>
<li class="chapter" data-level="14.2" data-path="dashboards.html"><a href="dashboards.html#introduction-to-shiny-through-an-example"><i class="fa fa-check"></i><b>14.2</b> Introduction to Shiny through an Example</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="dashboards.html"><a href="dashboards.html#what-is-a-shiny-application"><i class="fa fa-check"></i><b>14.2.1</b> What is a Shiny application?</a></li>
<li class="chapter" data-level="14.2.2" data-path="dashboards.html"><a href="dashboards.html#starting-with-shiny"><i class="fa fa-check"></i><b>14.2.2</b> Starting with Shiny</a></li>
<li class="chapter" data-level="14.2.3" data-path="dashboards.html"><a href="dashboards.html#illustration"><i class="fa fa-check"></i><b>14.2.3</b> Illustration</a></li>
<li class="chapter" data-level="14.2.4" data-path="dashboards.html"><a href="dashboards.html#deploying-the-application"><i class="fa fa-check"></i><b>14.2.4</b> Deploying the Application</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="dashboards.html"><a href="dashboards.html#to-go-further-2"><i class="fa fa-check"></i><b>14.3</b> To go further…</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="dashboards.html"><a href="dashboards.html#personalizing-and-tuning-your-application"><i class="fa fa-check"></i><b>14.3.1</b> Personalizing and Tuning your application</a></li>
<li class="chapter" data-level="14.3.2" data-path="dashboards.html"><a href="dashboards.html#upgrading-tables"><i class="fa fa-check"></i><b>14.3.2</b> Upgrading Tables</a></li>
<li class="chapter" data-level="14.3.3" data-path="dashboards.html"><a href="dashboards.html#building-dashboard"><i class="fa fa-check"></i><b>14.3.3</b> Building Dashboard</a></li>
<li class="chapter" data-level="14.3.4" data-path="dashboards.html"><a href="dashboards.html#interactive-graphics"><i class="fa fa-check"></i><b>14.3.4</b> Interactive Graphics</a></li>
<li class="chapter" data-level="14.3.5" data-path="dashboards.html"><a href="dashboards.html#interactive-documents"><i class="fa fa-check"></i><b>14.3.5</b> Interactive Documents</a></li>
<li class="chapter" data-level="14.3.6" data-path="dashboards.html"><a href="dashboards.html#documentation-and-books"><i class="fa fa-check"></i><b>14.3.6</b> Documentation and Books</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>15</b> Conclusion and Next Steps</a>
<ul>
<li class="chapter" data-level="15.1" data-path="next-steps.html"><a href="next-steps.html#other-recommended-resources"><i class="fa fa-check"></i><b>15.1</b> Other Recommended Resources</a></li>
<li class="chapter" data-level="15.2" data-path="next-steps.html"><a href="next-steps.html#useful-r-packages"><i class="fa fa-check"></i><b>15.2</b> Useful R Packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Sensory and Consumer Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="auto-report" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Automated Reporting<a href="auto-report.html#auto-report" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>Learning a programming language is not only useful for the freedom it provides, it also increases largely the speed of the analysis thanks to the re-usability of the code. When many projects are built using the same base (e.g. similar questionnaires), the same analyses are often performed, also leading to similar reports. Automating the analysis process is simple by applying the same code to different dataset. But what about the reports? Should a new report be built manually for each project?
In this section, we will show you how to build your own report directly from your code next to your analyses (or integrate your analysis within your reporting process). Such procedure has three main benefits, 1) build a new standardized report automatically for each new dataset analyzed, 2) mass-produce slides automatically, and 3) save you time for the interpretation of the results and the story-telling.</p>
</blockquote>
<div id="what-and-why-automated-reporting" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> What and why Automated Reporting?<a href="auto-report.html#what-and-why-automated-reporting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Effective communication of results is among the essential duties of sensory scientists…and so is the data collection, data preparation, data analysis etc. Worst, the sometimes tedious mechanics of report production together with the sheer volume of data that many scientists must process combine to make reporting design and nice story-telling an afterthought in too many cases.
Although this should preferably not be happening, it is necessary sometimes as presentation deadlines approach and time becomes limited.
Add to this work-load some last-minute changes due to either a change in the data, in the analysis, or maybe an error (e.g. copy/paste the wrong column, etc.) you have just been detected…how can we be sure that the latest version of the report is fully up-to-date, and that all the results/conclusions are correct? As the statistical software (e.g. R) is often separated from the reporting tool (e.g. Microsoft Office), it is easy to miss to transfer updated statistical outputs (e.g. values, tables, figures, etc.) to the report, hence creating inconsistencies.</p>
<p>Let’s consider another scenario, in which all the preliminary steps have been successfully done. After a week of analyses and reporting, you present your report to your manager or clients, and they come with a question such as: “Can we deep-dive into the results by looking at a particular group of consumers (e.g. gender split, or cluster split)?” Do you feel like going through the entire process again?</p>
<p>How would you feel if we would tell you that there is a way to build your report while running the analysis, by using the same script file? This means that in few clicks, say after updating the data to analyze (e.g. filter to the target group of consumers only), your report gets automatically re-generated with all the new updated results. Such solution seems ideal since it increases efficiency while reducing errors due to manual processing of results. More importantly, this gain in time and effort allow you designing nicer slides and building a better story.</p>
</div>
<div id="integrating-reports-within-analyses-scripts" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Integrating reports within analyses scripts<a href="auto-report.html#integrating-reports-within-analyses-scripts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, let’s integrate our report building process within our data analysis. By doing so, we do not focus on building a story yet. Instead, we improve our way of working by exporting directly all the statistical outputs that could<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a> be useful for our future story-telling. By doing so, we increase efficiency (especially if code can then be re-used for other studies) by <em>killing two birds with one stone</em>: We simultaneously run our analysis, create usable content for our final presentation, while reducing errors due to manual processing.</p>
<p>Since Microsoft Office is often the tool used for sharing results, we will focus our attention in exporting results to Excel, PowerPoint, and Word.</p>
<p>As usual, let’s start by loading the general package that we would need for our analyses (more specific packages being mentioned later.)</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="auto-report.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb165-2"><a href="auto-report.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb165-3"><a href="auto-report.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
<p>Note that in this chapter on automated reporting, some results (tables, figures) that are being created in one of the section may be re-used in subsequent sections. In case you do not read this chapter linearly, you might get errors as you might be calling objects that do not exist yet in your environment. If that should be the case, read through the previous sections to find the code where these elements are being generated, run it, and resume your read.</p>
<div id="excel" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Excel<a href="auto-report.html#excel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although Excel is not our preferred tool for automated reporting, it is still one of the major ways to access and share data. Most data collection software offer the possibility to export data and results in Excel, while most data analysis software accept Excel format as inputs. With the large use of Excel, it is no surprise that many colleagues and/or clients like to share data and results using spreadsheets. It is even less a surprise that R provides multiple solutions to import/export results from/to Excel.</p>
<p>For importing Excel files, we have already presented the package <code>{readxl}</code> among others (see REF). For exporting results, two complementary packages (yet again, among others!) in terms of ease of use and flexibility in the outcome are proposed: <code>{writexl}</code> and <code>{openxlsx}</code>.</p>
<p>As its name suggests, <code>{writexl}</code> is dedicated to exporting tables to Excel through the <code>write_xlsx()</code> function. Its use is very simple as it only takes as inputs the table (or list of tables)<a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a> to export to the file specified in the <code>path</code> parameter.</p>
<p>Let’s illustrate this by using our <em>biscuits_sensory_profile.xlsx</em> file: Let’s imagine that we would like to reduce our data set by only considering products that are high in Protein:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="auto-report.html#cb166-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;biscuits_sensory_profile.xlsx&quot;</span>)</span>
<span id="cb166-2"><a href="auto-report.html#cb166-2" aria-hidden="true" tabindex="-1"></a>product_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="at">path=</span>file_path, <span class="at">sheet=</span><span class="st">&quot;Product Info&quot;</span>, <span class="at">range=</span><span class="st">&quot;A1:D12&quot;</span>, <span class="at">col_names=</span><span class="cn">TRUE</span>)</span>
<span id="cb166-3"><a href="auto-report.html#cb166-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a href="auto-report.html#cb166-4" aria-hidden="true" tabindex="-1"></a>high_prot <span class="ot">&lt;-</span> product_info <span class="sc">%&gt;%</span> </span>
<span id="cb166-5"><a href="auto-report.html#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Protein <span class="sc">%in%</span> <span class="st">&quot;High&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb166-6"><a href="auto-report.html#cb166-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Product)</span>
<span id="cb166-7"><a href="auto-report.html#cb166-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-8"><a href="auto-report.html#cb166-8" aria-hidden="true" tabindex="-1"></a>high_prot_data <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="at">path=</span>file_path, <span class="at">sheet=</span><span class="st">&quot;Data&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb166-9"><a href="auto-report.html#cb166-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Product <span class="sc">%in%</span> high_prot)</span></code></pre></div>
<p>We then export this data into an excel sheet called <em>export.xlsx</em> that will be contained in our folder called <em>output</em><a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a>:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="auto-report.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb167-2"><a href="auto-report.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(high_prot_data, <span class="at">path=</span><span class="st">&quot;output/export.xlsx&quot;</span>, <span class="at">col_names=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>The export of tables using <code>{writexl}</code> is intuitive and easy, yet simplistic as it does not allow formatting the tables (except for some minor possibilities for the header), nor does it allow exporting multiple tables within the same sheet. For more advanced exporting options, the use of <code>{openxlsx}</code> is preferred as it allows more flexibility in structuring and formatting the Excel output.</p>
<p>With <code>{openxlsx}</code>, the procedure starts with creating a workbook object (e.g. <code>wb</code>) using <code>createWorkbook()</code>. We can add worksheets to <code>wb</code> through <code>addWorksheet()</code>.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="auto-report.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb168-2"><a href="auto-report.html#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="auto-report.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create workbook object</span></span>
<span id="cb168-4"><a href="auto-report.html#cb168-4" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> openxlsx<span class="sc">::</span><span class="fu">createWorkbook</span>()</span>
<span id="cb168-5"><a href="auto-report.html#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="auto-report.html#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new worksheet</span></span>
<span id="cb168-7"><a href="auto-report.html#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="at">sheetName =</span> <span class="st">&quot;Mean&quot;</span>, <span class="at">gridLines =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Note that with <code>addWorksheet()</code>, it is possible to control the appearance of the worksheet:</p>
<ul>
<li>show/hide grid lines using <code>gridLines</code>;</li>
<li>color the sheet using <code>tabColour</code>;</li>
<li>change the zoom on the sheet through <code>zoom</code>;</li>
<li>show/hide the tab using <code>visible</code>;</li>
<li>format the worksheet by specifying its size (<code>paperSize</code>) and orientation (<code>orientation</code>).</li>
</ul>
<p>On a given worksheet, any table can be exported using <code>writeData()</code> or <code>writeDataTable()</code>, which controls where to write the table through the <code>startRow</code> and <code>startCol</code> options.</p>
<p>Let’s imagine we want to compute the sensory profiles of the products, and we want to export that into Excel. Rather then simply exporting the results, we want to customize the output a little bit by applying the Excel style named <em>TabelStyleLight9</em>:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="auto-report.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the Sensory Profiles with some Product Information</span></span>
<span id="cb169-2"><a href="auto-report.html#cb169-2" aria-hidden="true" tabindex="-1"></a>p_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(file_path, <span class="at">sheet =</span> <span class="st">&quot;Product Info&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb169-3"><a href="auto-report.html#cb169-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Type)</span>
<span id="cb169-4"><a href="auto-report.html#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-5"><a href="auto-report.html#cb169-5" aria-hidden="true" tabindex="-1"></a>sensory <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Data&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb169-6"><a href="auto-report.html#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(p_info, <span class="at">by=</span><span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb169-7"><a href="auto-report.html#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Protein<span class="sc">:</span>Fiber, <span class="at">.after=</span>Product)</span>
<span id="cb169-8"><a href="auto-report.html#cb169-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-9"><a href="auto-report.html#cb169-9" aria-hidden="true" tabindex="-1"></a>senso_mean <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb169-10"><a href="auto-report.html#cb169-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Shiny<span class="sc">:</span>Melting, <span class="at">names_to=</span><span class="st">&quot;Attribute&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb169-11"><a href="auto-report.html#cb169-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Judge) <span class="sc">%&gt;%</span> </span>
<span id="cb169-12"><a href="auto-report.html#cb169-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Attribute, <span class="at">values_from=</span>Score, <span class="at">values_fn=</span>mean)</span>
<span id="cb169-13"><a href="auto-report.html#cb169-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-14"><a href="auto-report.html#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Exporting the Results to Excel</span></span>
<span id="cb169-15"><a href="auto-report.html#cb169-15" aria-hidden="true" tabindex="-1"></a><span class="fu">writeDataTable</span>(wb, <span class="at">sheet=</span><span class="st">&quot;Mean&quot;</span>, <span class="at">x=</span>senso_mean, <span class="at">startCol=</span><span class="dv">1</span>, <span class="at">startRow=</span><span class="dv">1</span>, <span class="at">colNames=</span><span class="cn">TRUE</span>, <span class="at">rowNames=</span><span class="cn">FALSE</span>, <span class="at">tableStyle=</span><span class="st">&quot;TableStyleLight9&quot;</span>)</span></code></pre></div>
<p>At any time, you can visualize the Excel file that is being produced without exporting it yet using <code>openXL()</code>. This function comes very handy as it allows you checking that the output looks like what you would wish for.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="auto-report.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">openXL</span>(wb)</span></code></pre></div>
<p>As can be seen, <code>writeData()</code> and <code>writeDataTable()</code> give us a lot of control on our export. For instance, we can:</p>
<ul>
<li>control where to print the data by using <code>startRow</code> and <code>startCol</code> (or alternatively <code>xy</code>: <code>xy = c("B",12)</code> prints the table starting in cell B12), hence allowing exporting multiple tables within the same sheet;</li>
<li>include the row names and column names through <code>rowNames</code> and <code>colNames</code>;</li>
<li>format the header using <code>headerStyle</code> (incl. color of the text and/or background, font, font size, etc.);</li>
<li>apply a specific style to our table using <code>tableStyle</code>;</li>
<li>shape the borders using predefined solutions through <code>borders</code>, or customizing them with <code>borderStyle</code> and <code>borderColour</code>;</li>
<li>add a filter to the table using <code>withFilter</code>;</li>
<li>convert missing data to “#N/A” or any other string using <code>keepNA</code> and <code>na.string</code>.</li>
</ul>
<p>Rather than using some pre-defined formatting as was the case with <code>tableStyle</code>, let’s consider some more advanced options in which we control (almost) everything. Let’s start with setting up the formatting style we would like to apply:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="auto-report.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-define options to control the borders </span></span>
<span id="cb171-2"><a href="auto-report.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.borderColour&quot;</span> <span class="ot">=</span> <span class="st">&quot;#4F80BD&quot;</span>)</span>
<span id="cb171-3"><a href="auto-report.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.borderStyle&quot;</span> <span class="ot">=</span> <span class="st">&quot;thin&quot;</span>)</span>
<span id="cb171-4"><a href="auto-report.html#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="auto-report.html#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatically set Number formats to 1 value after the decimal</span></span>
<span id="cb171-6"><a href="auto-report.html#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;openxlsx.numFmt&quot;</span> <span class="ot">=</span> <span class="st">&quot;0.0&quot;</span>)</span>
<span id="cb171-7"><a href="auto-report.html#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="auto-report.html#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the font to Calibri size 10</span></span>
<span id="cb171-9"><a href="auto-report.html#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="fu">modifyBaseFont</span>(wb,<span class="at">fontName =</span> <span class="st">&quot;Calibri&quot;</span>, <span class="at">fontSize =</span> <span class="dv">10</span>)</span>
<span id="cb171-10"><a href="auto-report.html#cb171-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-11"><a href="auto-report.html#cb171-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Header Style (blue background, top/bottom borders, text centered/bold)</span></span>
<span id="cb171-12"><a href="auto-report.html#cb171-12" aria-hidden="true" tabindex="-1"></a>headSty <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fgFill=</span><span class="st">&quot;#DCE6F1&quot;</span>, <span class="at">border=</span><span class="st">&quot;TopBottom&quot;</span>, <span class="at">halign=</span><span class="st">&quot;center&quot;</span>, <span class="at">textDecoration=</span><span class="st">&quot;bold&quot;</span>)</span></code></pre></div>
<p>Note that many more formatting options can be configured through:</p>
<ul>
<li><code>options()</code> to pre-define number formatting, border colors and style, etc.;</li>
<li><code>modifyBaseFont()</code> to define the font name and font size;</li>
<li><code>freezePane()</code> to freeze the first row and/or column of the table;</li>
<li><code>createStyle()</code> to pre-define a style, or <code>addStyle()</code> to apply the styling to selected cells;</li>
<li><code>setColWidths()</code> to control column width;</li>
<li><code>conditionalFormatting()</code> to format cells based on pre-defined conditions (see next for an example).</li>
</ul>
<p>Let’s export again the sensory profiles in a second sheet after applying these formatting options:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="auto-report.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="at">sheetName =</span> <span class="st">&quot;Mean (manual formatting)&quot;</span>, <span class="at">gridLines =</span> <span class="cn">FALSE</span>)</span>
<span id="cb172-2"><a href="auto-report.html#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="auto-report.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Freeze first row and first column</span></span>
<span id="cb172-4"><a href="auto-report.html#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="fu">freezePane</span>(wb, <span class="at">sheet=</span><span class="dv">2</span>, <span class="at">firstRow=</span><span class="cn">TRUE</span>, <span class="at">firstCol=</span><span class="cn">TRUE</span>)</span>
<span id="cb172-5"><a href="auto-report.html#cb172-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-6"><a href="auto-report.html#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Export the data using writeData</span></span>
<span id="cb172-7"><a href="auto-report.html#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet=</span><span class="dv">2</span>, <span class="at">x=</span>senso_mean, <span class="at">startCol=</span><span class="dv">1</span>, <span class="at">startRow=</span><span class="dv">1</span>, <span class="at">colNames=</span><span class="cn">TRUE</span>, <span class="at">rowNames=</span><span class="cn">FALSE</span>, <span class="at">headerStyle=</span>headSty)</span></code></pre></div>
<p>You’ll notice that the same table is now presented in a different way (use <code>openXL(wb)</code> to view it).</p>
<p>Let’s now consider a third export of the sensory profiles, with an additional twist: for a given variable (i.e. column), the value is colored in red (resp. blue) if it is higher (resp. lower) than its mean. To do so, we need to use conditional formatting.</p>
<p>Let’s start with creating two pre-defined parameters called <code>pos_style</code> (red) and <code>neg_style</code> (blue) using <code>createStyle()</code>that we will use to color the different cells. Let’s also compute the overall mean per attribute.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="auto-report.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Styles for conditional formatting</span></span>
<span id="cb173-2"><a href="auto-report.html#cb173-2" aria-hidden="true" tabindex="-1"></a>pos_style <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fontColour =</span> <span class="st">&quot;firebrick3&quot;</span>, <span class="at">bgFill =</span> <span class="st">&quot;mistyrose1&quot;</span>)</span>
<span id="cb173-3"><a href="auto-report.html#cb173-3" aria-hidden="true" tabindex="-1"></a>neg_style <span class="ot">&lt;-</span> <span class="fu">createStyle</span>(<span class="at">fontColour =</span> <span class="st">&quot;navy&quot;</span>, <span class="at">bgFill =</span> <span class="st">&quot;lightsteelblue&quot;</span>)</span>
<span id="cb173-4"><a href="auto-report.html#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="auto-report.html#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the overall mean</span></span>
<span id="cb173-6"><a href="auto-report.html#cb173-6" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span> </span>
<span id="cb173-7"><a href="auto-report.html#cb173-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean))</span></code></pre></div>
<p>Let’s then create a new worksheet in which we print the data of interest:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="auto-report.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="at">sheetName =</span> <span class="st">&quot;Conditional Formatting&quot;</span>, <span class="at">gridLines=</span><span class="cn">FALSE</span>)</span>
<span id="cb174-2"><a href="auto-report.html#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">writeDataTable</span>(wb, <span class="at">sheet=</span><span class="dv">3</span>, <span class="at">x=</span>senso_mean, <span class="at">startCol=</span><span class="dv">1</span>, <span class="at">startRow=</span><span class="dv">1</span>, <span class="at">colNames=</span><span class="cn">TRUE</span>, <span class="at">rowNames=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>Finally, we color the cells according to the rules that was defined earlier. To do so, the decision whether <code>pos_style</code> or <code>neg_style</code> should be used is defined by the <code>rule</code> parameter from the <code>conditionalFormatting()</code><a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a> function.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="auto-report.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding formatting to the second column</span></span>
<span id="cb175-2"><a href="auto-report.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(overall_mean)){</span>
<span id="cb175-3"><a href="auto-report.html#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conditionalFormatting</span>(wb, <span class="at">sheet=</span><span class="dv">3</span>, <span class="at">cols=</span>v<span class="sc">+</span><span class="dv">3</span>, <span class="at">rows=</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(senso_mean), <span class="at">rule=</span><span class="fu">paste0</span>(<span class="st">&quot;&gt;&quot;</span>, overall_mean[<span class="dv">1</span>,v]), <span class="at">style=</span>pos_style)</span>
<span id="cb175-4"><a href="auto-report.html#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conditionalFormatting</span>(wb, <span class="at">sheet=</span><span class="dv">3</span>, <span class="at">cols=</span>v<span class="sc">+</span><span class="dv">3</span>, <span class="at">rows=</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(senso_mean), <span class="at">rule=</span><span class="fu">paste0</span>(<span class="st">&quot;&lt;&quot;</span>, overall_mean[<span class="dv">1</span>,v]), <span class="at">style=</span>neg_style)</span>
<span id="cb175-5"><a href="auto-report.html#cb175-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Few comments regarding this code:</p>
<ul>
<li>We want to run this for each sensory attribute, hence the <code>for</code> loop that goes from 1 to the number of columns stored in <code>overall_mean</code> (<code>overall_mean</code> only contains the overall mean scores for the sensory attributes);</li>
<li><code>senso_mean</code> however contains 3 extra columns: <code>Product</code>, <code>Protein</code>, and <code>Fiber</code> hence the parameter <code>cols = v + 3</code>;</li>
<li>We apply the formatting to all the rows except the header, hence <code>rows = 1 + 1:nrow(senso_mean)</code>;</li>
<li>Finally, we apply <code>pos_style</code> (resp. <code>neg_style</code>) if the value is larger (resp. lower) than the overall mean for that attribute using <code>rule = paste0("&gt;", overall_mean[1,v])</code> (resp. <code>rule = paste0("&lt;", overall_mean[1,v])</code>).</li>
</ul>
<p>Once the spreadsheet is complete, we export the results using <code>saveWorkbook()</code> by specifying the name of the workbook (<code>wb</code>) and its path through <code>file</code>. In case such workbook already exists, it can be overwritten using <code>overwrite=TRUE</code>.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="auto-report.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWorkbook</span>(wb, <span class="at">file=</span><span class="st">&quot;output/export2.xlsx&quot;</span>)</span></code></pre></div>
<p>For more information regarding <code>{openxlsx}</code>, please visit (<a href="https://rdrr.io/cran/openxlsx/" class="uri">https://rdrr.io/cran/openxlsx/</a>)<a href="https://rdrr.io/cran/openxlsx/" class="uri">https://rdrr.io/cran/openxlsx/</a>.</p>
</div>
<div id="powerpoint" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> PowerPoint<a href="auto-report.html#powerpoint" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="creating-a-powerpoint-deck" class="section level4 hasAnchor" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> Creating a PowerPoint Deck<a href="auto-report.html#creating-a-powerpoint-deck" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Throughout the years, PowerPoint became one of the main supports for presenting results, whether it is in academia, in conference, or in companies. It is hence important to show how reports can be generated in PowerPoint from R. Many solutions exist, however the <code>{officer}</code> package is used here as its application is vast while still remaining easy to use.</p>
<blockquote>
<p><code>{officer}</code> contains a conflicting function with <code>{readxl}</code> in <code>read_xlsx()</code>. To ensure you use the right function, call the function from the package of interest (e.g. <code>readxl::read_xlsx()</code>).]</p>
</blockquote>
<p>With <code>{officer}</code>, the procedure starts with creating a PowerPoint object (<code>pptx_obj</code>) using the <code>read_pptx()</code> function.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="auto-report.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)</span>
<span id="cb177-2"><a href="auto-report.html#cb177-2" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() </span></code></pre></div>
<p>A blank deck is set up with the <em>Office Theme</em>. To use a custom theme and custom slides, a pre-defined deck from PowerPoint software can be used as input. Let’s import the <em>example.pptx</em> template that we created for you:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="auto-report.html#cb178-1" aria-hidden="true" tabindex="-1"></a>pptx_obj_custom <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>(<span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;example.pptx&quot;</span>))</span></code></pre></div>
<p>The content of the template can be inspected through <code>layout_summary()</code>:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="auto-report.html#cb179-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="auto-report.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_summary</span>()</span></code></pre></div>
<pre><code>##              layout       master
## 1       Title Slide Office Theme
## 2 Title and Content Office Theme
## 3    Section Header Office Theme
## 4       Two Content Office Theme
## 5        Comparison Office Theme
## 6        Title Only Office Theme
## 7             Blank Office Theme</code></pre>
<p>As can be seen by <code>layout_summary()</code>, the default template imported (also called <em>master</em>, which is defined here as <em>Office Theme</em>) proposes 7 types of slides including <em>Title Slide</em>, <em>Title and Content</em>, <em>Section Header</em>, <em>Two Content</em>, <em>Comparison</em>, <em>Title Only</em>, and finally <em>Blank</em>. The <em>example.pptx</em> template has 11 different types of slides, and contains custom <em>master slides</em> called <em>Integral</em><a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a>.</p>
<p>Each of these slides present some pre-defined properties (e.g. a box for text of tables/images, a header etc.). Let’s look at the properties of <em>Title and Content</em> using <code>layout_properties()</code>:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="auto-report.html#cb181-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb181-2"><a href="auto-report.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout_properties</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb181-3"><a href="auto-report.html#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;Title and Content&quot;</span>)</span></code></pre></div>
<pre><code>##    master_name              name   type id
## 1 Office Theme Title and Content   body  3
## 2 Office Theme Title and Content     dt  4
## 3 Office Theme Title and Content    ftr  5
## 4 Office Theme Title and Content sldNum  6
## 5 Office Theme Title and Content  title  2
##                     ph_label
## 1      Content Placeholder 2
## 2         Date Placeholder 3
## 3       Footer Placeholder 4
## 4 Slide Number Placeholder 5
## 5                    Title 1
##                                            ph  offx
## 1                             &lt;p:ph idx=&quot;1&quot;/&gt; 0.500
## 2        &lt;p:ph type=&quot;dt&quot; sz=&quot;half&quot; idx=&quot;10&quot;/&gt; 0.500
## 3    &lt;p:ph type=&quot;ftr&quot; sz=&quot;quarter&quot; idx=&quot;11&quot;/&gt; 3.417
## 4 &lt;p:ph type=&quot;sldNum&quot; sz=&quot;quarter&quot; idx=&quot;12&quot;/&gt; 7.167
## 5                        &lt;p:ph type=&quot;title&quot;/&gt; 0.500
##     offy    cx     cy rotation
## 1 1.7500 9.000 4.9497       NA
## 2 6.9514 2.333 0.3993       NA
## 3 6.9514 3.167 0.3993       NA
## 4 6.9514 2.333 0.3993       NA
## 5 0.3003 9.000 1.2500       NA
##                                   fld_id
## 1                                   &lt;NA&gt;
## 2 {E6744CE3-0875-4B69-89C0-6F72D8139561}
## 3                                   &lt;NA&gt;
## 4 {8DADB20D-508E-4C6D-A9E4-257D5607B0F6}
## 5                                   &lt;NA&gt;
##            fld_type
## 1              &lt;NA&gt;
## 2 datetimeFigureOut
## 3              &lt;NA&gt;
## 4          slidenum
## 5              &lt;NA&gt;</code></pre>
<p>This code provides more details about the elements available in each type of slides, including their identifiers and positions on the slide. This information is required to export content in some specific elements.</p>
<blockquote>
<p>Unfortunately, <code>{officer}</code> does not provide a function similar to <code>openxlsx::openXL()</code> that allows visualizing the file that is currently being build. Instead, the document needs to be saved on the disk using the <code>print()</code> function, which takes as entries the PowerPoint file to export (here <code>pptx_obj</code>) and its output location.</p>
</blockquote>
</div>
<div id="addingmovingremoving-slides" class="section level4 hasAnchor" number="6.2.2.2">
<h4><span class="header-section-number">6.2.2.2</span> Adding/Moving/Removing Slides<a href="auto-report.html#addingmovingremoving-slides" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>With <code>{officer}</code>, various actions can be done on the slides. The first logical action consists in adding a new slide to a presentation, in which we will later on export some text, tables, figures, etc. Such action can be done using <code>add_slide()</code>, in which the type of slide and the master<a href="#fn34" class="footnote-ref" id="fnref34"><sup>34</sup></a> are informed:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="auto-report.html#cb183-1" aria-hidden="true" tabindex="-1"></a>master <span class="ot">&lt;-</span> <span class="st">&quot;Office Theme&quot;</span></span>
<span id="cb183-2"><a href="auto-report.html#cb183-2" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb183-3"><a href="auto-report.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&#39;Title and Content&#39;</span>, <span class="at">master =</span> master)</span></code></pre></div>
<p>This code adds slide of type <em>Title and Content</em> to your deck.</p>
<p>Additional operations on the slides themselves can be done. In particular, you can re-organize your deck by changing the orders of your slides using <code>move_slide()</code>, delete slides that are no longer needed through <code>remove_slide()</code>, or modify a pre-existing slides by making it active using <code>on_slide()</code> (by default, the last slide created is the active one).</p>
<p>For example, let’s add another slide of type <em>Two Content</em>:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="auto-report.html#cb184-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb184-2"><a href="auto-report.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="st">&quot;Two Content&quot;</span>, <span class="at">master=</span>master)</span></code></pre></div>
<p>In case we would want to move this slide to eventually be first, the following code is used:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="auto-report.html#cb185-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb185-2"><a href="auto-report.html#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">move_slide</span>(<span class="at">index=</span><span class="dv">2</span>, <span class="at">to=</span><span class="dv">1</span>)</span></code></pre></div>
<p>Ultimately, this slide (now position as first slide) can be removed (by default, <code>index=NULL</code> and the active slide is deleted):</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="auto-report.html#cb186-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb186-2"><a href="auto-report.html#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_slide</span>(<span class="at">index=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="positioning-information-on-the-slide" class="section level4 hasAnchor" number="6.2.2.3">
<h4><span class="header-section-number">6.2.2.3</span> Positioning Information on the Slide<a href="auto-report.html#positioning-information-on-the-slide" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>On a given slide, any type of content (text, graph, table, etc.) can be exported. To do so, we need to inform <em>where</em> to write <em>what</em>.</p>
<p>As we will see in the next sections, the <em>what</em> can be any R element including simple text, tables, figures, etc. So let’s ignore it for the moment, and let’s focus on <em>where</em>.</p>
<p>To inform where to print elements on the slide, the function <code>ph_with()</code> (<em>ph</em> stands for <em>placeholder</em>) is used. In practice, <code>ph_with()</code> comes with the parameter <code>location</code>, which takes as input a <em>placeholder location object</em> pre-defined by the function <code>ph_location()</code> or one of its derivative, one of the most useful one being <code>ph_location_type()</code>. To do so, simply provide the name stored in the column type from the <code>layout_properties()</code> output presented before, as following:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="auto-report.html#cb187-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;My functions are:&quot;</span>, <span class="st">&quot;ph_with&quot;</span>, <span class="st">&quot;ph_location_type&quot;</span>)</span>
<span id="cb187-2"><a href="auto-report.html#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="auto-report.html#cb187-3" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb187-4"><a href="auto-report.html#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> <span class="st">&quot;My first title&quot;</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;title&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb187-5"><a href="auto-report.html#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&#39;body&#39;</span>))</span></code></pre></div>
<p>This code adds a title (“My first title”) and the text stored in <code>my_data</code> to the <em>body</em> of the slide (<em>Title and Content</em>) created previously.</p>
<p>Other pre-defined alternatives to <code>ph_location()</code> include:</p>
<ul>
<li><code>ph_location_fullsize()</code> to produce an output that covers the entire slide;</li>
<li><code>ph_location_left()</code> and <code>ph_location_right()</code> to write in the left/right box in <em>Two Content</em> types of slide;</li>
<li><code>ph_location_label()</code> is similar to <code>ph_location_type()</code> except that it uses the label rather than the type.</li>
</ul>
<p>For a full control of the position where to print your element, <code>ph_location()</code> is used as it allows specifying the exact location (for left/top/width/height, units are expressed in inches):</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="auto-report.html#cb188-1" aria-hidden="true" tabindex="-1"></a>my_data2 <span class="ot">&lt;-</span> <span class="st">&quot;My new text positioned using ph_location()&quot;</span></span>
<span id="cb188-2"><a href="auto-report.html#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="auto-report.html#cb188-3" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb188-4"><a href="auto-report.html#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> master) <span class="sc">%&gt;%</span> </span>
<span id="cb188-5"><a href="auto-report.html#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data2, <span class="at">location =</span> <span class="fu">ph_location</span>(<span class="at">left =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="dv">3</span>, <span class="at">height =</span> <span class="dv">1</span>))</span></code></pre></div>
<p>To visualize the different steps done so far, let’s save the results on our computers in an object called <em>my export.pptx</em> stored in the folder <em>output</em>:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="auto-report.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pptx_obj, <span class="st">&quot;output/my export.pptx&quot;</span>)</span></code></pre></div>
</div>
<div id="exporting-text" class="section level4 hasAnchor" number="6.2.2.4">
<h4><span class="header-section-number">6.2.2.4</span> Exporting Text<a href="auto-report.html#exporting-text" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the previous section, we already exported text to slides. Let’s go a bit deeper in the process by also showing how to format the text.</p>
<p>By default, each new text item added to a PowerPoint via <code>{officer}</code> is a paragraph object. To further format the paragraph, three main functions are being used:</p>
<ul>
<li><code>fpar()</code> (<em>formatted paragraph</em>) creates the paragraph;</li>
<li><code>ftext()</code> (<em>formatted text</em>) allows editing the text before pasting into paragraphs. <code>ftext()</code> requires a second argument called <code>prop</code> which contains the formatting properties;</li>
<li><code>block_list()</code> allows us to wrap multiple paragraphs together.</li>
</ul>
<p>Additionally, the text itself can be formated (font, size, color, etc.) using <code>fp_text()</code>. Let’s go through an example to illustrate the use of these functions:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="auto-report.html#cb190-1" aria-hidden="true" tabindex="-1"></a>my_prop <span class="ot">&lt;-</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">font.size =</span> <span class="dv">14</span>) <span class="co"># Formatting option</span></span>
<span id="cb190-2"><a href="auto-report.html#cb190-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="fu">ftext</span>(<span class="st">&quot;First Line in Red&quot;</span>, <span class="at">prop =</span> my_prop) <span class="co"># First line of text, formatted</span></span>
<span id="cb190-3"><a href="auto-report.html#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="auto-report.html#cb190-4" aria-hidden="true" tabindex="-1"></a>my_par <span class="ot">&lt;-</span> <span class="fu">fpar</span>(my_text) <span class="co"># text into a paragraph</span></span>
<span id="cb190-5"><a href="auto-report.html#cb190-5" aria-hidden="true" tabindex="-1"></a>blank_line <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;&quot;</span>) <span class="co"># other empty paragraph to introduce an empty line</span></span>
<span id="cb190-6"><a href="auto-report.html#cb190-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-7"><a href="auto-report.html#cb190-7" aria-hidden="true" tabindex="-1"></a>my_par2 <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;Second Line&quot;</span>) <span class="co"># second line of text, unformatted</span></span>
<span id="cb190-8"><a href="auto-report.html#cb190-8" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">block_list</span>(my_par, blank_line, my_par2) <span class="co"># Final block with the two lines of text separated by the empty line</span></span>
<span id="cb190-9"><a href="auto-report.html#cb190-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-10"><a href="auto-report.html#cb190-10" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb190-11"><a href="auto-report.html#cb190-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> master) <span class="sc">%&gt;%</span> </span>
<span id="cb190-12"><a href="auto-report.html#cb190-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_list, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>) )</span></code></pre></div>
<p>Again, if you want to visualize the results, simply print the results as earliere:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="auto-report.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pptx_obj, <span class="at">target =</span> <span class="st">&quot;output/my export.pptx&quot;</span>)</span></code></pre></div>
<p>This add an additional slide to our previous PowerPoint deck with our formatted text.</p>
<p>Last element of formatting to consider is the hierarchy in bullet points. Let’s add a slide containing three bullet points with a hierarchy so that the 1st and 3rd lines are primary points, and the second line is a secondary point. Such hierarchy is informed using the <code>level_list</code> parameter, which informs the hierarchy of each element:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="auto-report.html#cb192-1" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;FIRST SENTENCE&quot;</span>)</span>
<span id="cb192-2"><a href="auto-report.html#cb192-2" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;second sentence&quot;</span>)</span>
<span id="cb192-3"><a href="auto-report.html#cb192-3" aria-hidden="true" tabindex="-1"></a>text3 <span class="ot">&lt;-</span> <span class="fu">fpar</span>(<span class="st">&quot;THIRD SENTENCE&quot;</span>)</span>
<span id="cb192-4"><a href="auto-report.html#cb192-4" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">block_list</span>(text1, text2, text3)</span>
<span id="cb192-5"><a href="auto-report.html#cb192-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-6"><a href="auto-report.html#cb192-6" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb192-7"><a href="auto-report.html#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> master) <span class="sc">%&gt;%</span> </span>
<span id="cb192-8"><a href="auto-report.html#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_data, <span class="at">level_list =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&#39;body&#39;</span>))</span></code></pre></div>
</div>
<div id="exporting-tables" class="section level4 hasAnchor" number="6.2.2.5">
<h4><span class="header-section-number">6.2.2.5</span> Exporting Tables<a href="auto-report.html#exporting-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After exporting formatted text to slides, let’s export tables.</p>
<p>This can be done by rendering a data frame rather than text as <code>ph_with()</code> accepts it and exports it in a default format. Let’s use a subset of <code>senso_mean</code><a href="#fn35" class="footnote-ref" id="fnref35"><sup>35</sup></a> for illustration:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="auto-report.html#cb193-1" aria-hidden="true" tabindex="-1"></a>ft_data <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="auto-report.html#cb193-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Product, Salty, Sweet, Sour, Bitter) <span class="sc">%&gt;%</span> </span>
<span id="cb193-3"><a href="auto-report.html#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) </span>
<span id="cb193-4"><a href="auto-report.html#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="auto-report.html#cb193-5" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb193-6"><a href="auto-report.html#cb193-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> master) <span class="sc">%&gt;%</span></span>
<span id="cb193-7"><a href="auto-report.html#cb193-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> ft_data, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>))</span></code></pre></div>
<p>Although this solution works fine, it does not allow formatting the table as much as we would want. Instead, we prefer to use another package called <code>{flextable}</code> (see Section <a href="data-viz.html#flextable">5.3.1</a> for an introduction) which was developed by the same author as <code>{officer}</code>.</p>
<p>Remember that with <code>{flextable}</code>, the procedure starts with creating a <em>flextable</em> object (here <code>ft_table</code>) using the <code>flextable()</code> function.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="auto-report.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb194-2"><a href="auto-report.html#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="auto-report.html#cb194-3" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> ft_data <span class="sc">%&gt;%</span> </span>
<span id="cb194-4"><a href="auto-report.html#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Product) <span class="sc">%&gt;%</span> </span>
<span id="cb194-5"><a href="auto-report.html#cb194-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code></pre></div>
<p>This table can be customized in various ways such as:</p>
<ul>
<li><code>align()</code> and <code>rotate()</code> controls for the text alignment and its rotation;</li>
<li><code>bold()</code> and <code>italic()</code> writes the text in bold or italic;</li>
<li><code>font()</code> and <code>fontsize()</code> controls the font type and the size to use;</li>
<li><code>color()</code> and <code>bg()</code> allows changing the color of the text and of the background.</li>
</ul>
<p>All these functions require informing the rows (parameter <code>i</code>) and the columns (<code>j</code>) as well as the <code>part</code> (<code>"body"</code>, <code>"header"</code>, <code>"footer"</code>, or <code>"all"</code>) to modify.</p>
<p>Additionally, further formatting can be applied to the table itself through the following functions:</p>
<ul>
<li><code>height()</code> &amp; <code>width()</code> control for the row height and column width;</li>
<li><code>border_outer()</code>, <code>border_inner()</code>, <code>border_inner_h()</code> &amp; <code>border_inner_v()</code> help design the table by adding borders;</li>
<li><code>autofit()</code> and <code>padding()</code> are used to control the final size of the table.</li>
</ul>
<p>For illustration, let’s apply some of these functions to <code>ft_table</code>:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="auto-report.html#cb195-1" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> ft_table <span class="sc">%&gt;%</span> </span>
<span id="cb195-2"><a href="auto-report.html#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-3"><a href="auto-report.html#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formatting the header</span></span>
<span id="cb195-4"><a href="auto-report.html#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> <span class="st">&quot;Roboto&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-5"><a href="auto-report.html#cb195-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-6"><a href="auto-report.html#cb195-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-7"><a href="auto-report.html#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">&quot;center&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-8"><a href="auto-report.html#cb195-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">bg =</span> <span class="st">&quot;#324C63&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-9"><a href="auto-report.html#cb195-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formatting the body</span></span>
<span id="cb195-10"><a href="auto-report.html#cb195-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> <span class="st">&quot;Calibri&quot;</span>, <span class="at">part =</span> <span class="st">&quot;body&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb195-11"><a href="auto-report.html#cb195-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ft_data), <span class="at">bg =</span> <span class="st">&quot;#EDEDED&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb195-12"><a href="auto-report.html#cb195-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formatting the last row of the table</span></span>
<span id="cb195-13"><a href="auto-report.html#cb195-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">i =</span> <span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ft_data)) <span class="sc">%&gt;%</span> </span>
<span id="cb195-14"><a href="auto-report.html#cb195-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">italic</span>(<span class="at">i =</span> <span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="sc">~</span>Product <span class="sc">+</span> Salty <span class="sc">+</span> Sweet <span class="sc">+</span> Sour <span class="sc">+</span> Bitter) <span class="sc">%&gt;%</span></span>
<span id="cb195-15"><a href="auto-report.html#cb195-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">i =</span>  <span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="sc">~</span>Sour, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-16"><a href="auto-report.html#cb195-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">i =</span>  <span class="fu">nrow</span>(ft_data), <span class="at">j =</span> <span class="sc">~</span>Sweet, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb195-17"><a href="auto-report.html#cb195-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>()</span>
<span id="cb195-18"><a href="auto-report.html#cb195-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-19"><a href="auto-report.html#cb195-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the border style</span></span>
<span id="cb195-20"><a href="auto-report.html#cb195-20" aria-hidden="true" tabindex="-1"></a>my_border <span class="ot">&lt;-</span> <span class="fu">fp_border</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">style =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb195-21"><a href="auto-report.html#cb195-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-22"><a href="auto-report.html#cb195-22" aria-hidden="true" tabindex="-1"></a>ft_table <span class="ot">&lt;-</span> ft_table <span class="sc">%&gt;%</span></span>
<span id="cb195-23"><a href="auto-report.html#cb195-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_outer</span>(<span class="at">part =</span> <span class="st">&quot;all&quot;</span>, <span class="at">border =</span> my_border) <span class="sc">%&gt;%</span></span>
<span id="cb195-24"><a href="auto-report.html#cb195-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">border_inner</span>(<span class="at">part =</span> <span class="st">&quot;body&quot;</span>, <span class="at">border =</span> <span class="fu">fp_border</span>(<span class="at">style =</span> <span class="st">&quot;dashed&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb195-25"><a href="auto-report.html#cb195-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p>This is just an overview of the most relevant and used functions in <code>{flextable}</code>, yet there are more possibilities.
To go further, you can also consider the following functions (among many more):</p>
<ul>
<li><code>merge()</code> merges vertically or horizontally cells with the same content;</li>
<li><code>compose()</code>, <code>as_chunk()</code>, and <code>as_paragraph()</code> works hands in hands to create more complex text formatting (e.g. sentence with parts of the text colored differently, or with sub/superscript);</li>
<li><code>style()</code> applies a set of formatting properties to the same selection of the rows/columns.</li>
</ul>
<p>Finally, to export a <em>flextable</em> table to a PowerPoint deck, simply export it as we have seen before:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="auto-report.html#cb196-1" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="auto-report.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> master) <span class="sc">%&gt;%</span></span>
<span id="cb196-3"><a href="auto-report.html#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> ft_table, <span class="fu">ph_location</span>(<span class="at">left =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="dv">4</span>))</span></code></pre></div>
</div>
<div id="exporting-plots" class="section level4 hasAnchor" number="6.2.2.6">
<h4><span class="header-section-number">6.2.2.6</span> Exporting Plots<a href="auto-report.html#exporting-plots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The last type of R outputs to export to PowerPoint are figures. Before showing how to export them, let’s build a simple bar chart from <code>senso_mean</code> using <code>{ggplot2}</code>:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="auto-report.html#cb197-1" aria-hidden="true" tabindex="-1"></a>chart_to_export <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="auto-report.html#cb197-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Product, Salty, Sweet, Sour, Bitter) <span class="sc">%&gt;%</span> </span>
<span id="cb197-3"><a href="auto-report.html#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Product) <span class="sc">%&gt;%</span> </span>
<span id="cb197-4"><a href="auto-report.html#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Salty<span class="sc">:</span>Bitter, <span class="at">names_to =</span> <span class="st">&#39;Attribute&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Value&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb197-5"><a href="auto-report.html#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Product, <span class="at">y =</span> Value, <span class="at">fill =</span> Attribute)) <span class="sc">+</span> </span>
<span id="cb197-6"><a href="auto-report.html#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)<span class="sc">+</span></span>
<span id="cb197-7"><a href="auto-report.html#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb197-8"><a href="auto-report.html#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>To export any <em>ggplot2</em> object to PowerPoint, the package <code>{rvg}</code> is required.
This package provides two graphics devices that produces Vector Graphics outputs in <em>DrawingML</em> format for Microsoft PowerPoint with <code>dml_pptx()</code> and for Microsoft Excel with <code>dml_xlsx()</code>, meaninFg the the graphics is being ‘rebuilt’ in PowerPoint or Word. To simplify, the generic <code>dml()</code> function is used, and depending on the output format, the corresponding function is being called.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="auto-report.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvg)</span>
<span id="cb198-2"><a href="auto-report.html#cb198-2" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb198-3"><a href="auto-report.html#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> master) <span class="sc">%&gt;%</span></span>
<span id="cb198-4"><a href="auto-report.html#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> <span class="fu">dml</span>(<span class="at">ggobj =</span> chart_to_export), <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&#39;body&#39;</span>))</span></code></pre></div>
<p>With <code>{rvg}</code>, the graphics are being <em>rebuilt</em> in PowerPoint, meaning that they are completely editable. It is hence possible to change color, re-write text, move labels, etc.</p>
<p>To go further, the <code>{mschart}</code> package creates the graphs directly in PowerPoint or Word. These graphics have then the advantage to be interactive. However, this package is only limited to simple graphics (such as line chart, bar charts, etc.)</p>
<p>To produce such interact graphs, <code>ggplot2</code> graphs are not needed. Instead, functions such as <code>ms_barchart()</code> are called to produce them.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="auto-report.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mschart)</span>
<span id="cb199-2"><a href="auto-report.html#cb199-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-3"><a href="auto-report.html#cb199-3" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span></span>
<span id="cb199-4"><a href="auto-report.html#cb199-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Product, Salty, Sweet, Sour, Bitter) <span class="sc">%&gt;%</span> </span>
<span id="cb199-5"><a href="auto-report.html#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Product) <span class="sc">%&gt;%</span> </span>
<span id="cb199-6"><a href="auto-report.html#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Salty<span class="sc">:</span>Bitter, <span class="at">names_to =</span> <span class="st">&#39;Attribute&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Value&#39;</span>)</span>
<span id="cb199-7"><a href="auto-report.html#cb199-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-8"><a href="auto-report.html#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Building the barchart using ms_barchart()</span></span>
<span id="cb199-9"><a href="auto-report.html#cb199-9" aria-hidden="true" tabindex="-1"></a>my_barchart <span class="ot">&lt;-</span> <span class="fu">ms_barchart</span>(<span class="at">data=</span>mydata, <span class="at">x=</span><span class="st">&quot;Product&quot;</span>, <span class="at">y=</span><span class="st">&quot;Value&quot;</span>, <span class="at">group=</span><span class="st">&quot;Attribute&quot;</span>)</span>
<span id="cb199-10"><a href="auto-report.html#cb199-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-11"><a href="auto-report.html#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="co"># The chart is a PowerPoint native object and can be viewed using the preview option in print</span></span>
<span id="cb199-12"><a href="auto-report.html#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_barchart, <span class="at">preview =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## * &quot;ms_barchart&quot; object
## 
## * original data [44,3] (sample):
##   Product Attribute  Value
## 1     P01     Salty  5.100
## 2     P01     Sweet 22.200
## 3     P01      Sour  0.000
## 4     P01    Bitter  8.000
## 5     P02     Salty  2.933
## 
## * series data [11,5] (sample):
##   Product Bitter Salty Sour Sweet
## 1     P01  8.000 5.100    0  22.2
## 2     P02  4.933 2.933    0  15.8
## 3     P03  7.800 4.667    0  10.4
## 4     P04  4.267 3.600    0  16.6
## 5     P05  6.733 5.867    3  21.0</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="auto-report.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To add the object to a PowerPoint slide we can use the officer&#39;s native ph_with() function</span></span>
<span id="cb201-2"><a href="auto-report.html#cb201-2" aria-hidden="true" tabindex="-1"></a>pptx_obj <span class="ot">&lt;-</span> pptx_obj <span class="sc">%&gt;%</span></span>
<span id="cb201-3"><a href="auto-report.html#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_slide</span>(<span class="at">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="at">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb201-4"><a href="auto-report.html#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ph_with</span>(<span class="at">value =</span> my_barchart, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">&quot;body&quot;</span>))</span></code></pre></div>
<p>Now the full deck is being created, let’s save in one last time using <code>print()</code>:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="auto-report.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pptx_obj, <span class="at">target =</span> <span class="st">&quot;output/my export.pptx&quot;</span>)</span></code></pre></div>
<p>If you open the PowerPoint just exported, on the final slide, you’ll find the barchart generated by <code>{mschart}</code>. By clicking the graph, you’ll find a ‘funnel’ icon on the right side, which allows you filter attributes or products, hence making your graph interactive.</p>
<p>At last, <code>{officer}</code> also allows you adding images that are stored on your computer into a PowerPoint deck. This can be done through the <code>external_img()</code> function, which takes as input the location of the file. Like for any other graph, simply apply this function within <code>ph_with()</code> by specifying the location where to print the image.</p>
</div>
</div>
<div id="word" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Word<a href="auto-report.html#word" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The process for building Word document directly from R is very similar to the one for PowerPoint, since it is also handled though <code>{officer}</code>.</p>
<p>To start a new Word document, the <code>read_docx()</code> function is being used. Since Word documents are more <em>text oriented</em> than PowerPoint, blocks of text are defined as paragraph. To introduce a new paragraph, the <code>body_add_par()</code> function is called. Note that paragraphs are automatically separated by line breaks:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="auto-report.html#cb203-1" aria-hidden="true" tabindex="-1"></a>docx_obj <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb203-2"><a href="auto-report.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;My Text&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-3"><a href="auto-report.html#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Other Text&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb203-4"><a href="auto-report.html#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Conclusion&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>)</span></code></pre></div>
<p>Here again, the results can be exported to your computer using <code>print()</code>:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="auto-report.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(docx_obj, <span class="at">target =</span> <span class="st">&quot;output/my export.docx&quot;</span>)</span></code></pre></div>
<p>Of course, it is not required to use the default formatting options from the word document in use. Instead, we can format it directly from R using <code>body_add_fpar()</code> to add a formatted text paragraph, or apply pre-defined styles to the previous function suggested (as is the case here with <code>style = "heading 1"</code> to set the text as a title of level 1).</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="auto-report.html#cb205-1" aria-hidden="true" tabindex="-1"></a>my_format <span class="ot">&lt;-</span> <span class="fu">fp_text</span>(<span class="at">font.family =</span> <span class="st">&#39;Calibri&#39;</span>, <span class="at">font.size =</span> <span class="dv">14</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb205-2"><a href="auto-report.html#cb205-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="fu">ftext</span>(<span class="st">&#39;Here is another example of text&#39;</span>, my_format)</span>
<span id="cb205-3"><a href="auto-report.html#cb205-3" aria-hidden="true" tabindex="-1"></a>my_par <span class="ot">&lt;-</span> <span class="fu">fpar</span>(my_text)</span>
<span id="cb205-4"><a href="auto-report.html#cb205-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-5"><a href="auto-report.html#cb205-5" aria-hidden="true" tabindex="-1"></a>docx_obj <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb205-6"><a href="auto-report.html#cb205-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Document Title&quot;</span>, <span class="at">style =</span> <span class="st">&quot;heading 1&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb205-7"><a href="auto-report.html#cb205-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb205-8"><a href="auto-report.html#cb205-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_fpar</span>(my_par, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>)</span></code></pre></div>
<p>To export tables or figures, additional functions including <code>body_add_table()</code> (for tables) and <code>body_add_gg()</code><a href="#fn36" class="footnote-ref" id="fnref36"><sup>36</sup></a>) (for <code>ggplot()</code> figures) are used. These can be combined to <code>body_add_caption()</code> to add a caption to your table/figure:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="auto-report.html#cb206-1" aria-hidden="true" tabindex="-1"></a>table_num <span class="ot">&lt;-</span> <span class="fu">run_autonum</span>(<span class="at">seq_id =</span> <span class="st">&quot;tab&quot;</span>, <span class="at">pre_label =</span> <span class="st">&quot;Table &quot;</span>, <span class="at">bkm =</span> <span class="st">&quot;tables&quot;</span>)</span>
<span id="cb206-2"><a href="auto-report.html#cb206-2" aria-hidden="true" tabindex="-1"></a>figure_num <span class="ot">&lt;-</span> <span class="fu">run_autonum</span>(<span class="at">seq_id =</span> <span class="st">&quot;fig&quot;</span>, <span class="at">pre_label =</span> <span class="st">&quot;Figure &quot;</span>, <span class="at">bkm =</span> <span class="st">&quot;figures&quot;</span>)</span>
<span id="cb206-3"><a href="auto-report.html#cb206-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-4"><a href="auto-report.html#cb206-4" aria-hidden="true" tabindex="-1"></a>docx_obj <span class="ot">&lt;-</span> docx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb206-5"><a href="auto-report.html#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Exporting Tables&quot;</span>, <span class="at">style =</span> <span class="st">&quot;heading 2&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-6"><a href="auto-report.html#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-7"><a href="auto-report.html#cb206-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Here is my first table:&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-8"><a href="auto-report.html#cb206-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-9"><a href="auto-report.html#cb206-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_table</span>(<span class="at">value =</span> <span class="fu">head</span>(mtcars)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">style =</span> <span class="st">&quot;table_template&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-10"><a href="auto-report.html#cb206-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_caption</span>(<span class="fu">block_caption</span>(<span class="st">&quot;My first table.&quot;</span>, <span class="at">style=</span><span class="st">&quot;centered&quot;</span>, <span class="at">autonum=</span>table_num)) <span class="sc">%&gt;%</span> </span>
<span id="cb206-11"><a href="auto-report.html#cb206-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Exporting Figures&quot;</span>, <span class="at">style =</span> <span class="st">&quot;heading 2&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-12"><a href="auto-report.html#cb206-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-13"><a href="auto-report.html#cb206-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Here is my first figure:&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-14"><a href="auto-report.html#cb206-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;&quot;</span>, <span class="at">style =</span> <span class="st">&quot;Normal&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb206-15"><a href="auto-report.html#cb206-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_gg</span>(<span class="at">value =</span> chart_to_export) <span class="sc">%&gt;%</span> </span>
<span id="cb206-16"><a href="auto-report.html#cb206-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_caption</span>(<span class="fu">block_caption</span>(<span class="st">&quot;My first figure.&quot;</span>, <span class="at">style=</span><span class="st">&quot;centered&quot;</span>, <span class="at">autonum=</span>figure_num))</span></code></pre></div>
<p>As can be seen, <code>body_add_caption()</code> is combined to <code>block_caption()</code>, and can have some automated numbering, as defined previously using <code>table_num</code> for tables, and <code>figure_num</code> for figures.</p>
<p>Unlike a PowerPoint file that contains separate slides, a word document is a continuous object. Hence, to emphasize a break and add content to a new page, <code>body_add_break()</code> needs to be called. Additionally, tables of content can be generated using <code>body_add_toc()</code>:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="auto-report.html#cb207-1" aria-hidden="true" tabindex="-1"></a>docx_obj <span class="ot">&lt;-</span> docx_obj <span class="sc">%&gt;%</span> </span>
<span id="cb207-2"><a href="auto-report.html#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_break</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb207-3"><a href="auto-report.html#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">&quot;Conclusion&quot;</span>, <span class="at">style =</span> <span class="st">&quot;heading 1&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb207-4"><a href="auto-report.html#cb207-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_break</span>() <span class="sc">%&gt;%</span></span>
<span id="cb207-5"><a href="auto-report.html#cb207-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="st">&quot;Table of Contents&quot;</span>, <span class="at">style =</span> <span class="st">&quot;heading 1&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb207-6"><a href="auto-report.html#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_toc</span>(<span class="at">level =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Finally, let’s export the final version of the word document to visualize it:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="auto-report.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(docx_obj, <span class="at">target =</span> <span class="st">&quot;output/my export.docx&quot;</span>)</span></code></pre></div>
<p>As can be seen, it is possible to format a nice report in Word directly from R, that integrates text, tables, figures and more. For more information regarding <code>{officer}</code>, and on how to export results to Word and PowerPoint, please visit (<a href="https://ardata-fr.github.io/officeverse/index.html" class="uri">https://ardata-fr.github.io/officeverse/index.html</a>)<a href="https://ardata-fr.github.io/officeverse/index.html" class="uri">https://ardata-fr.github.io/officeverse/index.html</a>.</p>
<blockquote>
<p>It is worth mentioning that <code>{officer}</code> also allows extracting information from existing reports (Word and PowerPoint). It is however outside the scope of this book and will not be further described.</p>
</blockquote>
</div>
<div id="notes-on-applying-corporate-branding" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Notes on applying corporate branding<a href="auto-report.html#notes-on-applying-corporate-branding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may have noticed that we have been consistent with our approach to export results to reports, regardless of the final output:
We start with pre-defining our styling parameters that we then apply to our different tables, slides, paragraphs, etc. This is not a formal rule, yet we strongly recommend you adopting this way of working. Indeed, by creating your different styling parameters at the start of your script file, these lines of code do not interfere with your analyses. At a later stage, you will thank yourself for keeping well-structured code as it gains in clarity, and hence facilitates debugging your code in case of error or changes.</p>
<p>To go one step further, we would recommend you storing all these styling parameters in a separate file you load any time you need them through <code>source()</code>. This process reduces the size of your script file, hence increasing its clarity, while harmonizing all your exports by centralizing your formatting code in one unique place. The last point is crucial since any changes only need to be done once, and yet will be applied to all your reports.</p>
<p>As we have seen, <code>{officer}</code> gives you the opportunity to import pre-defined templates (PowerPoint or Word). This is very valuable as your report can easily match your corporate style.</p>
<p>Ultimately, to ensure optimal efficiency, we advise you to spend a bit more time when constructing your report by ensuring that as many details are being taken care of, so that later on, you can spend more time in the story building part and less on the analysis and slide generation. For instance, don’t be afraid of mass-exporting results, as it is easier to remove slides, tables, or figures (in case they are not needed for your story) then it is to re-generate them at a later stage (if missing).</p>
</div>
</div>
<div id="integrating-analyses-scripts-within-your-reporting-tool" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Integrating analyses scripts within your reporting tool<a href="auto-report.html#integrating-analyses-scripts-within-your-reporting-tool" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we have just seen, we can generate reports in the Microsoft Office suit directly from our R script. Although the results are being showed, the script used to reach these results is completely hidden. Of course, we could add them as text, but the logic would suggest that the researcher can just get back to the script to decode how certain outputs have been obtained.</p>
<p>Let’s now change our way of thinking by proposing an alternative in which we integrate our R analysis directly within a reporting tool. For that, we need to introduce another useful package for reporting and document building: <code>{rmarkdown}</code>.</p>
<div id="what-is-rmarkdown" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> What is <code>{rmarkdown}</code><a href="auto-report.html#what-is-rmarkdown" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Markdown is an ecosystem specific to text document, in which authors <em>script</em> their reports by controlling various features including:</p>
<ul>
<li>paragraphs and inline formatting (e.g. bold, italic, etc.)</li>
<li>(section) headers</li>
<li>blocks (code, or quotations)</li>
<li>(un)numbered lists</li>
<li>horizontal rules</li>
<li>tables and figures (including legends)</li>
<li>LaTeX math expressions, formulas, and theorems</li>
<li>links, citations, and footnotes</li>
</ul>
<p>Limiting the creation of Markdown document to this list of elements is more an advantage than a drawback as it suffice to create technical and non-technical documents while still keeping it simple.</p>
<p>In practice, R Markdown provides an authoring framework for data science, as it can be use for saving/documenting/executing code and generating high quality reports. Once the document is being created, you can then compile it to build it in the output format of your choice (e.g. word, pdf, html, etc.)</p>
</div>
<div id="starting-with-rmarkdown" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Starting with {rmarkdown}<a href="auto-report.html#starting-with-rmarkdown" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To start, you need to install the <code>{rmarkdown}</code> package using the <code>install.packages()</code> function. To load this package, just type <code>library(rmarkdown)</code>. If you intend to build your report in pdf, you also need to install a LaTeX library. For its simplicity, we recommend you installing the TinyTeX library using <code>install.packages("tinytex")</code>.</p>
<p>Let’s start with a simple example that is provided by RStudio. To start a RMarkdown document, click <em>File</em> &gt; <em>New File</em> &gt; <em>R Markdown…</em> This opens a new window in which you can inform the name of your file, the author name, and the type of report to create (HTML, PDF, or Word). Once set, click <em>OK</em>. A new script file of type <em>.Rmd</em> opens.</p>
<p>In this document, there are three components: metadata, text, and code.</p>
<p>The document starts with the metadata. It is easily recognizable as it starts and ends with 3 successive dashes (<code>---</code>), and its syntax is YAML (YAML Ain’t Markup Language). In this part, information regarding the properties of the final document is being stored. This includes (amongst other) the title, authorship, date, export format, etc. of the final document.</p>
<p>Be aware that indentation matters in YAML, so follow the rules to ensure that your document compiles correctly.</p>
<p>Right after the metadata is the body of document. The syntax for the text is Markdown, and the main features will be presented in the next section. Within the body, computer code can be added, either as a chunk, or within the text.</p>
</div>
<div id="rmarkdown-through-a-simple-example" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> <code>{rmarkdown}</code> through a Simple Example<a href="auto-report.html#rmarkdown-through-a-simple-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To illustrate the use of <code>{rmarkdown}</code>, let’s consider this simple document (inspired from REF):</p>
<!-- Insert a Print Screen of RMarkdown example.RMD -->
<p>The top of the document contains the metadata, which (in our case) will generate the report in an HTML document.</p>
<p>Next, we have a first chunk of code that sets the main options on how the code should be handled. If all the code chunks are handled in the same way, it is handy to set it at the start. However, when different chunks of code should be handled differently, it may be easier to define for each section how it should be handled.</p>
<p>There are mainly four ways to handle code.</p>
<p>The first way is defined here on the code chunk <em>header</em> as <code>include = FALSE</code><a href="#fn37" class="footnote-ref" id="fnref37"><sup>37</sup></a>: <code>include</code> always run the code, yet it allows printing (<code>include = TRUE</code>) or not (<code>include = FALSE</code>) the code and its outputs in the final document.</p>
<p>The second option is <code>echo</code>. In this code chunk, we automatically set that all the code chunk should be defined as <code>echo = TRUE</code>, which means that the code will run and be printed (together with its output) in the document. This seems very similar to <code>include</code>, yet it differs from it as <code>echo = FALSE</code> runs the code, prints the outputs, but not the code.</p>
<p>If you only want to show some code without running it, the <code>eval</code> parameter is used (<code>eval = FALSE</code> means that the code will be displayed but will not run). This is useful for displaying example code, or for disabling large or time-consuming chunk of codes without having to set it up as comment.</p>
<p>Last, we can control whether outputs should be shown or hidden using <code>results</code> (printed output) and <code>fig.show</code> (plots). By default, the results are shown, unless it is set as <code>results = "hide"</code> or <code>fig.show = "hide"</code>.</p>
<p>The document then continues with a section header, which starts with <em>#</em>. The hierarchy of headers is defined by the number of adjacent <em>#</em> (for a header of level 3, starts the header with <em>###</em>).</p>
<p>In this section, a first paragraph is being written. This is plain text, except for two particular words, one written between two “`” (backticks), and one written between 2 double “*” (stars). Here, the backticks are used to write text in R font (or as we will see later, to render results from R), whereas the double stars write the text in bold (double “_” (underscore) could also be used). For italic, one single star (or one single underscore) are used.</p>
<p>If the following section and sub-section, we introduce numbered and unnumbered list of elements. For numbered list, starts with a <em>number</em> followed by a <em>.</em> (numbers will be incremented automatically). For unnumbered list, you can either start with a “-” (dash), or with “*” (star) for bullet points. For sub-list, indent your marker by pressing the <em>Tab</em> key.</p>
<p>In the next section called <em>Analysis</em>, we are running our first lines of code.</p>
<p>The first code chunk runs a regression model. In the text under the second chunk of code, we are retrieving automatically a value from R by including a <em>r</em> at the starts of two <em>backticks</em> followed by the element to retrieve. In our final report, this code will automatically be replaced by the value 3.93.</p>
<p>The second code chunk shows how the results can be printed, either directly from R, or in a nicer way using the <code>knitr::kable()</code> function.</p>
<p>Finally, the last code chunk of this section creates a plot with a caption, that is automatically numbered.</p>
</div>
<div id="creating-a-document-using-knitr" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Creating a document using <code>{knitr}</code><a href="auto-report.html#creating-a-document-using-knitr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once the document is ready, you can neat it using the <code>knit</code> button. This will create the report in the format of interest (here HTML).</p>
</div>
<div id="example-of-applications" class="section level3 hasAnchor" number="6.3.5">
<h3><span class="header-section-number">6.3.5</span> Example of applications<a href="auto-report.html#example-of-applications" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>{rmarkdown}</code> is a very powerful tool for building report, in particular in the context of reproducible research since it allows sharing code, and running analyses within the report (part of the text around the code can justify the decisions made in terms of analyses to ensure transparency). The latter point is particularly interesting since any change in the data will automatically provide updated results throughout the report, without you having to change them manually.</p>
<p>Its application is various, and can go from report, to teaching material, publication or even books (this book has been written in <code>{rmarkdown}</code> and its extension <code>{bookdown}</code>), emails, websites, dashboards, surveys etc. Even more interestingly, <code>{rmarkdown}</code> can also be combined to <code>{shiny}</code> to build interactive reports, dashboards, or teaching materials in which users would (say) import their data set, select the variables to analyze through buttons, chose which analyses and which options to perform, and the results will automatically be generated accordingly.</p>
<p>For more information on <code>{rmarkdown}</code> and related packages, please see:
* (<a href="https://bookdown.org/yihui/bookdown/" class="uri">https://bookdown.org/yihui/bookdown/</a>)<a href="https://bookdown.org/yihui/bookdown/" class="uri">https://bookdown.org/yihui/bookdown/</a>
* (<a href="https://bookdown.org/yihui/rmarkdown-cookbook/" class="uri">https://bookdown.org/yihui/rmarkdown-cookbook/</a>)<a href="https://bookdown.org/yihui/rmarkdown-cookbook/" class="uri">https://bookdown.org/yihui/rmarkdown-cookbook/</a>
* (<a href="https://bookdown.org/yihui/rmarkdown/" class="uri">https://bookdown.org/yihui/rmarkdown/</a>)<a href="https://bookdown.org/yihui/rmarkdown/" class="uri">https://bookdown.org/yihui/rmarkdown/</a></p>
<p>As mentioned earlier, R Markdown can also be used to generate other types of documents, including presentations. This can be done directly from the <code>{rmarkdown}</code> package using <em>ioslides</em> presentation (<code>output: ioslides_presentation</code> in the metadata), <em>Slidy</em> presentation (<code>output: slidy_presentation</code>), or <em>PowerPoint</em> presentation (<code>output: powerpoint_presentation</code> with <code>reference_doc: my-styles.pptx</code> to apply your own template) just to name a few. It can also be done using additional packages such as <code>{xarigan}</code>.</p>
</div>
</div>
<div id="to-go-further" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> To go further…<a href="auto-report.html#to-go-further" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If R allows you saving time by creating your report within your R-script, or by running your analysis within your report document, it cannot communicate the presentation to your partners/clients for you. However, if the report is very standard (say only key results, tables or figures), or running routinely (say in quality control), R could automatically run the analysis as soon as new data is available, build the report, and send it automatically to you, your manager or your colleagues and partners by email.</p>
<p>Such process can be done thanks to the <code>{blastula}</code> package (see REF).</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="29">
<li id="fn29"><p>We say <em>could</em> as we are in a process of mass-exportation of results, most of them being used for building the story although they may not be kept in the final deck.<a href="auto-report.html#fnref29" class="footnote-back">↩︎</a></p></li>
<li id="fn30"><p>List of tables will generate multiple sheets within the same spreadsheet, one table being placed in each sheet.<a href="auto-report.html#fnref30" class="footnote-back">↩︎</a></p></li>
<li id="fn31"><p>If the <em>output</em> folder does not exist, this code will return an error so make sure to create one.<a href="auto-report.html#fnref31" class="footnote-back">↩︎</a></p></li>
<li id="fn32"><p>In <code>conditionalFormatting()</code>, you can specify to which <code>rows</code> and <code>cols</code> the formatting applies.<a href="auto-report.html#fnref32" class="footnote-back">↩︎</a></p></li>
<li id="fn33"><p>It is out of the scope of this book to describe how to build your own custom master slides. However, a quick internet search will provide you with all the information that you would need.<a href="auto-report.html#fnref33" class="footnote-back">↩︎</a></p></li>
<li id="fn34"><p>In practice, a unique template can contain slides from different masters.<a href="auto-report.html#fnref34" class="footnote-back">↩︎</a></p></li>
<li id="fn35"><p><code>senso_mean</code> was built in Section <a href="auto-report.html#excel">6.2.1</a>.<a href="auto-report.html#fnref35" class="footnote-back">↩︎</a></p></li>
<li id="fn36"><p>Note that <code>body_add_img()</code> and <code>body_add_plot()</code> can also be used.<a href="auto-report.html#fnref36" class="footnote-back">↩︎</a></p></li>
<li id="fn37"><p>When set manually, this is where you should indicate how to handle each chunk of code<a href="auto-report.html#fnref37" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-viz.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-projects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/06-auto-report.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
