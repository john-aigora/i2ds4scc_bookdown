<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Data Analysis | Data Science for Sensory and Consumer Scientists</title>
  <meta name="description" content="Open development of data science book for sensory and consumer scientists." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Data Analysis | Data Science for Sensory and Consumer Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Open development of data science book for sensory and consumer scientists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Data Analysis | Data Science for Sensory and Consumer Scientists" />
  
  <meta name="twitter:description" content="Open development of data science book for sensory and consumer scientists." />
  

<meta name="author" content="John Ennis, Julien Delarue, and Thierry Worch" />


<meta name="date" content="2022-01-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-prep.html"/>
<link rel="next" href="value-delivery.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Sensory and Consumer Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-read-this-book"><i class="fa fa-check"></i>Who Should Read This Book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to Use This Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="bienvenue.html"><a href="bienvenue.html"><i class="fa fa-check"></i><b>1</b> Bienvenue!</a>
<ul>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#why-data-science-for-sensory-and-consumer-science"><i class="fa fa-check"></i>Why Data Science for Sensory and Consumer Science?</a>
<ul>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#core-principles-in-sensory-and-consumer-science"><i class="fa fa-check"></i>Core principles in Sensory and Consumer Science</a></li>
<li class="chapter" data-level="" data-path="bienvenue.html"><a href="bienvenue.html#computational-sensory-science"><i class="fa fa-check"></i>Computational Sensory Science</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Apéritifs</b></span></li>
<li class="chapter" data-level="2" data-path="start-R.html"><a href="start-R.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="start-R.html"><a href="start-R.html#r"><i class="fa fa-check"></i><b>2.1</b> R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="start-R.html"><a href="start-R.html#why-learn-a-programming-language"><i class="fa fa-check"></i><b>2.1.1</b> Why Learn a Programming Language?</a></li>
<li class="chapter" data-level="2.1.2" data-path="start-R.html"><a href="start-R.html#why-r"><i class="fa fa-check"></i><b>2.1.2</b> Why R?</a></li>
<li class="chapter" data-level="2.1.3" data-path="start-R.html"><a href="start-R.html#steps-to-install-r"><i class="fa fa-check"></i><b>2.1.3</b> Steps to Install R</a></li>
<li class="chapter" data-level="2.1.4" data-path="start-R.html"><a href="start-R.html#introduction-to-the-magrittr-and-the-notion-of-pipes"><i class="fa fa-check"></i><b>2.1.4</b> Introduction to the <code>{magrittr}</code> and the notion of <em>pipes</em></a></li>
<li class="chapter" data-level="2.1.5" data-path="start-R.html"><a href="start-R.html#tips-on-how-to-read-this-book"><i class="fa fa-check"></i><b>2.1.5</b> Tips on <em>how to read this book?</em></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="start-R.html"><a href="start-R.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> RStudio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="start-R.html"><a href="start-R.html#steps-to-install-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> Steps to Install RStudio</a></li>
<li class="chapter" data-level="2.2.2" data-path="start-R.html"><a href="start-R.html#create-a-local-project"><i class="fa fa-check"></i><b>2.2.2</b> Create a Local Project</a></li>
<li class="chapter" data-level="2.2.3" data-path="start-R.html"><a href="start-R.html#install-and-load-packages"><i class="fa fa-check"></i><b>2.2.3</b> Install and Load Packages</a></li>
<li class="chapter" data-level="2.2.4" data-path="start-R.html"><a href="start-R.html#run-sample-code"><i class="fa fa-check"></i><b>2.2.4</b> Run Sample Code</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="start-R.html"><a href="start-R.html#git-and-github"><i class="fa fa-check"></i><b>2.3</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="start-R.html"><a href="start-R.html#git"><i class="fa fa-check"></i><b>2.3.1</b> Git</a></li>
<li class="chapter" data-level="2.3.2" data-path="start-R.html"><a href="start-R.html#github"><i class="fa fa-check"></i><b>2.3.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="start-R.html"><a href="start-R.html#raw-material"><i class="fa fa-check"></i><b>2.4</b> RAW MATERIAL</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="start-R.html"><a href="start-R.html#principles"><i class="fa fa-check"></i><b>2.4.1</b> Principles</a></li>
<li class="chapter" data-level="2.4.2" data-path="start-R.html"><a href="start-R.html#tools"><i class="fa fa-check"></i><b>2.4.2</b> Tools</a></li>
<li class="chapter" data-level="2.4.3" data-path="start-R.html"><a href="start-R.html#documentation"><i class="fa fa-check"></i><b>2.4.3</b> Documentation</a></li>
<li class="chapter" data-level="2.4.4" data-path="start-R.html"><a href="start-R.html#version-control"><i class="fa fa-check"></i><b>2.4.4</b> Version control</a></li>
<li class="chapter" data-level="2.4.5" data-path="start-R.html"><a href="start-R.html#online-repositories-for-team-collaboration"><i class="fa fa-check"></i><b>2.4.5</b> Online repositories for team collaboration</a></li>
<li class="chapter" data-level="2.4.6" data-path="start-R.html"><a href="start-R.html#building-a-code-base"><i class="fa fa-check"></i><b>2.4.6</b> Building a code base</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Hors d’Oeuvres</b></span></li>
<li class="chapter" data-level="3" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>3</b> Why Data Science?</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-science.html"><a href="data-science.html#history-and-definition"><i class="fa fa-check"></i><b>3.1</b> History and Definition</a></li>
<li class="chapter" data-level="3.2" data-path="data-science.html"><a href="data-science.html#benefits-of-data-science"><i class="fa fa-check"></i><b>3.2</b> Benefits of Data Science</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-science.html"><a href="data-science.html#reproducible-research"><i class="fa fa-check"></i><b>3.2.1</b> Reproducible Research</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-science.html"><a href="data-science.html#standardized-reporting"><i class="fa fa-check"></i><b>3.2.2</b> Standardized Reporting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-science.html"><a href="data-science.html#data-scientific-workflow"><i class="fa fa-check"></i><b>3.3</b> Data Scientific Workflow</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-science.html"><a href="data-science.html#data-collection2"><i class="fa fa-check"></i><b>3.3.1</b> Data Collection</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-science.html"><a href="data-science.html#data-preparation"><i class="fa fa-check"></i><b>3.3.2</b> Data Preparation</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-science.html"><a href="data-science.html#data-analysis2"><i class="fa fa-check"></i><b>3.3.3</b> Data Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-science.html"><a href="data-science.html#value-delivery2"><i class="fa fa-check"></i><b>3.3.4</b> Value Delivery</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-science.html"><a href="data-science.html#how-to-learn-data-science"><i class="fa fa-check"></i><b>3.4</b> How to Learn Data Science</a></li>
<li class="chapter" data-level="3.5" data-path="data-science.html"><a href="data-science.html#cautions-dont-that-everybody-does"><i class="fa fa-check"></i><b>3.5</b> Cautions: Don’t that Everybody Does</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manip.html"><a href="data-manip.html#tidy-data"><i class="fa fa-check"></i><b>4.1</b> Tidying Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-manip.html"><a href="data-manip.html#simple-manipulations"><i class="fa fa-check"></i><b>4.1.1</b> Simple Manipulations</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-manip.html"><a href="data-manip.html#reshaping-the-data"><i class="fa fa-check"></i><b>4.1.2</b> Reshaping the Data</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-manip.html"><a href="data-manip.html#transformation-that-alters-the-data"><i class="fa fa-check"></i><b>4.1.3</b> Transformation that Alters the Data</a></li>
<li class="chapter" data-level="4.1.4" data-path="data-manip.html"><a href="data-manip.html#combining-data-from-different-sources"><i class="fa fa-check"></i><b>4.1.4</b> Combining Data from Different Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-viz.html"><a href="data-viz.html#design-principles"><i class="fa fa-check"></i><b>5.1</b> Design Principles</a></li>
<li class="chapter" data-level="5.2" data-path="data-viz.html"><a href="data-viz.html#table-making"><i class="fa fa-check"></i><b>5.2</b> Table Making</a></li>
<li class="chapter" data-level="5.3" data-path="data-viz.html"><a href="data-viz.html#chart-making"><i class="fa fa-check"></i><b>5.3</b> Chart Making</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-viz.html"><a href="data-viz.html#philosophy-of-ggplot2"><i class="fa fa-check"></i><b>5.3.1</b> Philosophy of <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="data-viz.html"><a href="data-viz.html#getting-started-with-ggplot2"><i class="fa fa-check"></i><b>5.3.2</b> Getting started with <code>{ggplot2}</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="data-viz.html"><a href="data-viz.html#common-charts"><i class="fa fa-check"></i><b>5.3.3</b> Common Charts</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-viz.html"><a href="data-viz.html#miscealleneous"><i class="fa fa-check"></i><b>5.3.4</b> Miscealleneous</a></li>
<li class="chapter" data-level="5.3.5" data-path="data-viz.html"><a href="data-viz.html#few-tips-and-tricks"><i class="fa fa-check"></i><b>5.3.5</b> Few Tips and Tricks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="auto-report.html"><a href="auto-report.html"><i class="fa fa-check"></i><b>6</b> Automated Reporting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="auto-report.html"><a href="auto-report.html#what-and-why-automated-reporting"><i class="fa fa-check"></i><b>6.1</b> What and why Automated Reporting?</a></li>
<li class="chapter" data-level="6.2" data-path="auto-report.html"><a href="auto-report.html#integrating-reports-within-analyses-scripts"><i class="fa fa-check"></i><b>6.2</b> Integrating reports within analyses scripts</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="auto-report.html"><a href="auto-report.html#excel"><i class="fa fa-check"></i><b>6.2.1</b> Excel</a></li>
<li class="chapter" data-level="6.2.2" data-path="auto-report.html"><a href="auto-report.html#powerpoint"><i class="fa fa-check"></i><b>6.2.2</b> PowerPoint</a></li>
<li class="chapter" data-level="6.2.3" data-path="auto-report.html"><a href="auto-report.html#word"><i class="fa fa-check"></i><b>6.2.3</b> Word</a></li>
<li class="chapter" data-level="6.2.4" data-path="auto-report.html"><a href="auto-report.html#notes-on-applying-corporate-branding"><i class="fa fa-check"></i><b>6.2.4</b> Notes on applying corporate branding</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="auto-report.html"><a href="auto-report.html#integrating-analyses-scripts-within-your-reporting-tool"><i class="fa fa-check"></i><b>6.3</b> Integrating analyses scripts within your reporting tool</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="auto-report.html"><a href="auto-report.html#what-is-rmarkdown"><i class="fa fa-check"></i><b>6.3.1</b> What is <code>{rmarkdown}</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="auto-report.html"><a href="auto-report.html#starting-with-rmarkdown"><i class="fa fa-check"></i><b>6.3.2</b> Starting with {rmarkdown}</a></li>
<li class="chapter" data-level="6.3.3" data-path="auto-report.html"><a href="auto-report.html#rmarkdown-through-a-simple-example"><i class="fa fa-check"></i><b>6.3.3</b> <code>{rmarkdown}</code> through a Simple Example</a></li>
<li class="chapter" data-level="6.3.4" data-path="auto-report.html"><a href="auto-report.html#creating-a-document-using-knitr"><i class="fa fa-check"></i><b>6.3.4</b> Creating a document using <code>{knitr}</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="auto-report.html"><a href="auto-report.html#example-of-applications"><i class="fa fa-check"></i><b>6.3.5</b> Example of applications</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="auto-report.html"><a href="auto-report.html#to-go-further"><i class="fa fa-check"></i><b>6.4</b> To go further…</a></li>
</ul></li>
<li class="part"><span><b>Bon Appétit</b></span></li>
<li class="chapter" data-level="7" data-path="example-projects.html"><a href="example-projects.html"><i class="fa fa-check"></i><b>7</b> Example Project: The Biscuit Study</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example-projects.html"><a href="example-projects.html#products"><i class="fa fa-check"></i><b>7.1</b> Products</a></li>
<li class="chapter" data-level="7.2" data-path="example-projects.html"><a href="example-projects.html#consumer-test"><i class="fa fa-check"></i><b>7.2</b> Consumer test</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="example-projects.html"><a href="example-projects.html#participants"><i class="fa fa-check"></i><b>7.2.1</b> Participants</a></li>
<li class="chapter" data-level="7.2.2" data-path="example-projects.html"><a href="example-projects.html#test-design"><i class="fa fa-check"></i><b>7.2.2</b> Test design</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="example-projects.html"><a href="example-projects.html#sensory-descriptive-analysis-data"><i class="fa fa-check"></i><b>7.3</b> Sensory descriptive analysis data</a></li>
<li class="chapter" data-level="7.4" data-path="example-projects.html"><a href="example-projects.html#summary-of-the-datasets"><i class="fa fa-check"></i><b>7.4</b> Summary of the datasets</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-collection.html"><a href="data-collection.html"><i class="fa fa-check"></i><b>8</b> Data Collection</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-collection.html"><a href="data-collection.html#design-1"><i class="fa fa-check"></i><b>8.1</b> Design</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="data-collection.html"><a href="data-collection.html#designs-of-sensory-experiments"><i class="fa fa-check"></i><b>8.1.1</b> Designs of sensory experiments</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-collection.html"><a href="data-collection.html#product-related-design"><i class="fa fa-check"></i><b>8.1.2</b> Product-related design</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-collection.html"><a href="data-collection.html#execute-1"><i class="fa fa-check"></i><b>8.2</b> Execute</a></li>
<li class="chapter" data-level="8.3" data-path="data-collection.html"><a href="data-collection.html#data-import"><i class="fa fa-check"></i><b>8.3</b> Import</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-collection.html"><a href="data-collection.html#importing-structured-excel-file"><i class="fa fa-check"></i><b>8.3.1</b> Importing Structured Excel File</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-collection.html"><a href="data-collection.html#importing-unstructured-excel-file"><i class="fa fa-check"></i><b>8.3.2</b> Importing Unstructured Excel File</a></li>
<li class="chapter" data-level="8.3.3" data-path="data-collection.html"><a href="data-collection.html#import-mult-sheet"><i class="fa fa-check"></i><b>8.3.3</b> Importing Data Stored in Multiple Sheets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>9</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-prep.html"><a href="data-prep.html#inspect"><i class="fa fa-check"></i><b>9.1</b> Inspect</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-prep.html"><a href="data-prep.html#data-inspection"><i class="fa fa-check"></i><b>9.1.1</b> Data Inspection</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-prep.html"><a href="data-prep.html#design-inspection"><i class="fa fa-check"></i><b>9.1.2</b> Design Inspection</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-prep.html"><a href="data-prep.html#missing-data-inspection"><i class="fa fa-check"></i><b>9.1.3</b> Missing Data Inspection</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-prep.html"><a href="data-prep.html#checks-for-consistency-and-reliability"><i class="fa fa-check"></i><b>9.1.4</b> Checks for Consistency and Reliability</a></li>
<li class="chapter" data-level="9.1.5" data-path="data-prep.html"><a href="data-prep.html#preliminary-tables-and-charts"><i class="fa fa-check"></i><b>9.1.5</b> Preliminary Tables and Charts</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-prep.html"><a href="data-prep.html#clean"><i class="fa fa-check"></i><b>9.2</b> Clean</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-prep.html"><a href="data-prep.html#renaming-variables-1"><i class="fa fa-check"></i><b>9.2.1</b> Renaming Variables</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-prep.html"><a href="data-prep.html#handling-data-type"><i class="fa fa-check"></i><b>9.2.2</b> Handling Data Type</a></li>
<li class="chapter" data-level="9.2.3" data-path="data-prep.html"><a href="data-prep.html#converting-between-types"><i class="fa fa-check"></i><b>9.2.3</b> Converting between Types</a></li>
<li class="chapter" data-level="9.2.4" data-path="data-prep.html"><a href="data-prep.html#handling-missing-values"><i class="fa fa-check"></i><b>9.2.4</b> Handling Missing Values</a></li>
<li class="chapter" data-level="9.2.5" data-path="data-prep.html"><a href="data-prep.html#restructuring-data"><i class="fa fa-check"></i><b>9.2.5</b> Restructuring Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>10</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-analysis.html"><a href="data-analysis.html#sensory-data"><i class="fa fa-check"></i><b>10.1</b> Sensory Data</a></li>
<li class="chapter" data-level="10.2" data-path="data-analysis.html"><a href="data-analysis.html#demographic-and-questionnaire-data"><i class="fa fa-check"></i><b>10.2</b> Demographic and Questionnaire Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-analysis.html"><a href="data-analysis.html#demographic-data-frequency-and-proportion"><i class="fa fa-check"></i><b>10.2.1</b> Demographic Data: Frequency and Proportion</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-analysis.html"><a href="data-analysis.html#personality-traits-and-eating-behavior-tfeq-data"><i class="fa fa-check"></i><b>10.2.2</b> Personality traits and eating behavior: TFEQ data</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-analysis.html"><a href="data-analysis.html#consumer-data"><i class="fa fa-check"></i><b>10.3</b> Consumer Data</a></li>
<li class="chapter" data-level="10.4" data-path="data-analysis.html"><a href="data-analysis.html#combining-sensory-and-consumer-data"><i class="fa fa-check"></i><b>10.4</b> Combining Sensory and Consumer Data</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="data-analysis.html"><a href="data-analysis.html#internal-preference-mapping"><i class="fa fa-check"></i><b>10.4.1</b> Internal Preference Mapping</a></li>
<li class="chapter" data-level="10.4.2" data-path="data-analysis.html"><a href="data-analysis.html#consumers-clustering"><i class="fa fa-check"></i><b>10.4.2</b> Consumers Clustering</a></li>
<li class="chapter" data-level="10.4.3" data-path="data-analysis.html"><a href="data-analysis.html#drivers-of-liking"><i class="fa fa-check"></i><b>10.4.3</b> Drivers of Liking</a></li>
<li class="chapter" data-level="10.4.4" data-path="data-analysis.html"><a href="data-analysis.html#external-preference-mapping"><i class="fa fa-check"></i><b>10.4.4</b> External Preference Mapping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="value-delivery.html"><a href="value-delivery.html"><i class="fa fa-check"></i><b>11</b> Value Delivery</a>
<ul>
<li class="chapter" data-level="11.1" data-path="value-delivery.html"><a href="value-delivery.html#communicate2"><i class="fa fa-check"></i><b>11.1</b> Communicate</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="value-delivery.html"><a href="value-delivery.html#audience-awareness"><i class="fa fa-check"></i><b>11.1.1</b> Audience Awareness</a></li>
<li class="chapter" data-level="11.1.2" data-path="value-delivery.html"><a href="value-delivery.html#method-to-communicate"><i class="fa fa-check"></i><b>11.1.2</b> Method to Communicate</a></li>
<li class="chapter" data-level="11.1.3" data-path="value-delivery.html"><a href="value-delivery.html#storytelling"><i class="fa fa-check"></i><b>11.1.3</b> Storytelling</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="value-delivery.html"><a href="value-delivery.html#to-go-further-1"><i class="fa fa-check"></i><b>11.2</b> To go further…</a></li>
</ul></li>
<li class="part"><span><b>Haute Cuisine</b></span></li>
<li class="chapter" data-level="12" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>12</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="machine-learning.html"><a href="machine-learning.html#overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="machine-learning.html"><a href="machine-learning.html#key-topics"><i class="fa fa-check"></i><b>12.2</b> Key Topics</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="machine-learning.html"><a href="machine-learning.html#model-validation"><i class="fa fa-check"></i><b>12.2.1</b> Model Validation</a></li>
<li class="chapter" data-level="12.2.2" data-path="machine-learning.html"><a href="machine-learning.html#unsupervised-learning"><i class="fa fa-check"></i><b>12.2.2</b> Unsupervised learning</a></li>
<li class="chapter" data-level="12.2.3" data-path="machine-learning.html"><a href="machine-learning.html#semisupervised-learning"><i class="fa fa-check"></i><b>12.2.3</b> Semisupervised learning</a></li>
<li class="chapter" data-level="12.2.4" data-path="machine-learning.html"><a href="machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>12.2.4</b> Supervised learning</a></li>
<li class="chapter" data-level="12.2.5" data-path="machine-learning.html"><a href="machine-learning.html#interpretability"><i class="fa fa-check"></i><b>12.2.5</b> Interpretability</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="machine-learning.html"><a href="machine-learning.html#common-applications"><i class="fa fa-check"></i><b>12.3</b> Common Applications</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="machine-learning.html"><a href="machine-learning.html#predicting-sensory-profiles-from-instrumental-data"><i class="fa fa-check"></i><b>12.3.1</b> Predicting sensory profiles from instrumental data</a></li>
<li class="chapter" data-level="12.3.2" data-path="machine-learning.html"><a href="machine-learning.html#predicting-consumer-response-from-sensory-profiles"><i class="fa fa-check"></i><b>12.3.2</b> Predicting consumer response from sensory profiles</a></li>
<li class="chapter" data-level="12.3.3" data-path="machine-learning.html"><a href="machine-learning.html#characterizing-consumer-clusters"><i class="fa fa-check"></i><b>12.3.3</b> Characterizing consumer clusters</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="machine-learning.html"><a href="machine-learning.html#code-examples"><i class="fa fa-check"></i><b>12.4</b> Code Examples</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="machine-learning.html"><a href="machine-learning.html#data-prep-1"><i class="fa fa-check"></i><b>12.4.1</b> Data Prep</a></li>
<li class="chapter" data-level="12.4.2" data-path="machine-learning.html"><a href="machine-learning.html#classification-code"><i class="fa fa-check"></i><b>12.4.2</b> Classification Code</a></li>
<li class="chapter" data-level="12.4.3" data-path="machine-learning.html"><a href="machine-learning.html#regression-code"><i class="fa fa-check"></i><b>12.4.3</b> Regression Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>13</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.0.1" data-path="text-analysis.html"><a href="text-analysis.html#applicaion-of-text-analysis-in-sensory-and-consumer-science"><i class="fa fa-check"></i><b>13.0.1</b> Applicaion of Text Analysis in Sensory and Consumer Science</a></li>
<li class="chapter" data-level="13.0.2" data-path="text-analysis.html"><a href="text-analysis.html#objectives-of-text-analysis"><i class="fa fa-check"></i><b>13.0.2</b> Objectives of Text Analysis</a></li>
<li class="chapter" data-level="13.0.3" data-path="text-analysis.html"><a href="text-analysis.html#warnings"><i class="fa fa-check"></i><b>13.0.3</b> Warnings</a></li>
<li class="chapter" data-level="13.1" data-path="text-analysis.html"><a href="text-analysis.html#illustration-using-sorting-task-data"><i class="fa fa-check"></i><b>13.1</b> Illustration using Sorting Task Data</a></li>
<li class="chapter" data-level="13.2" data-path="text-analysis.html"><a href="text-analysis.html#data-pre-processing"><i class="fa fa-check"></i><b>13.2</b> Data Pre-processing</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="text-analysis.html"><a href="text-analysis.html#introduction-to-working-with-strings-stringr"><i class="fa fa-check"></i><b>13.2.1</b> Introduction to working with strings (<code>{stringr}</code>)</a></li>
<li class="chapter" data-level="13.2.2" data-path="text-analysis.html"><a href="text-analysis.html#tokenization"><i class="fa fa-check"></i><b>13.2.2</b> Tokenization</a></li>
<li class="chapter" data-level="13.2.3" data-path="text-analysis.html"><a href="text-analysis.html#simple-transformation-lowercase"><i class="fa fa-check"></i><b>13.2.3</b> Simple Transformation (lowercase)</a></li>
<li class="chapter" data-level="13.2.4" data-path="text-analysis.html"><a href="text-analysis.html#stopwords"><i class="fa fa-check"></i><b>13.2.4</b> Stopwords</a></li>
<li class="chapter" data-level="13.2.5" data-path="text-analysis.html"><a href="text-analysis.html#stemming-and-lemmatization"><i class="fa fa-check"></i><b>13.2.5</b> Stemming and Lemmatization</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="text-analysis.html"><a href="text-analysis.html#text-analysis-1"><i class="fa fa-check"></i><b>13.3</b> Text Analysis</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="text-analysis.html"><a href="text-analysis.html#raw-frequencies-and-visualization"><i class="fa fa-check"></i><b>13.3.1</b> Raw Frequencies and Visualization</a></li>
<li class="chapter" data-level="13.3.2" data-path="text-analysis.html"><a href="text-analysis.html#bigrams-n-grams"><i class="fa fa-check"></i><b>13.3.2</b> Bigrams, <em>n</em>-grams</a></li>
<li class="chapter" data-level="13.3.3" data-path="text-analysis.html"><a href="text-analysis.html#word-embedding"><i class="fa fa-check"></i><b>13.3.3</b> Word Embedding</a></li>
<li class="chapter" data-level="13.3.4" data-path="text-analysis.html"><a href="text-analysis.html#sentiment-analysis"><i class="fa fa-check"></i><b>13.3.4</b> Sentiment Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="text-analysis.html"><a href="text-analysis.html#to-go-further-2"><i class="fa fa-check"></i><b>13.4</b> To go further…</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="dashboards.html"><a href="dashboards.html"><i class="fa fa-check"></i><b>14</b> Dashboards</a>
<ul>
<li class="chapter" data-level="14.1" data-path="dashboards.html"><a href="dashboards.html#objectives"><i class="fa fa-check"></i><b>14.1</b> Objectives</a></li>
<li class="chapter" data-level="14.2" data-path="dashboards.html"><a href="dashboards.html#introduction-to-shiny-through-an-example"><i class="fa fa-check"></i><b>14.2</b> Introduction to Shiny through an Example</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="dashboards.html"><a href="dashboards.html#what-is-shiny"><i class="fa fa-check"></i><b>14.2.1</b> What is Shiny</a></li>
<li class="chapter" data-level="14.2.2" data-path="dashboards.html"><a href="dashboards.html#starting-with-shiny"><i class="fa fa-check"></i><b>14.2.2</b> Starting with Shiny</a></li>
<li class="chapter" data-level="14.2.3" data-path="dashboards.html"><a href="dashboards.html#functionalities"><i class="fa fa-check"></i><b>14.2.3</b> Functionalities</a></li>
<li class="chapter" data-level="14.2.4" data-path="dashboards.html"><a href="dashboards.html#tips"><i class="fa fa-check"></i><b>14.2.4</b> Tips</a></li>
<li class="chapter" data-level="14.2.5" data-path="dashboards.html"><a href="dashboards.html#deploying-the-application"><i class="fa fa-check"></i><b>14.2.5</b> Deploying the Application</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="dashboards.html"><a href="dashboards.html#to-go-further-3"><i class="fa fa-check"></i><b>14.3</b> To go further…</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="dashboards.html"><a href="dashboards.html#extension-to-other-dedicated-packages"><i class="fa fa-check"></i><b>14.3.1</b> Extension to other dedicated packages</a></li>
<li class="chapter" data-level="14.3.2" data-path="dashboards.html"><a href="dashboards.html#improving-through-css-and-html"><i class="fa fa-check"></i><b>14.3.2</b> Improving through CSS and HTML</a></li>
<li class="chapter" data-level="14.3.3" data-path="dashboards.html"><a href="dashboards.html#interactive-tutorial"><i class="fa fa-check"></i><b>14.3.3</b> Interactive Tutorial</a></li>
<li class="chapter" data-level="14.3.4" data-path="dashboards.html"><a href="dashboards.html#documentation-and-books"><i class="fa fa-check"></i><b>14.3.4</b> Documentation and Books</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="digestifs.html"><a href="digestifs.html"><i class="fa fa-check"></i>Digestifs</a></li>
<li class="chapter" data-level="15" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>15</b> Next Steps</a>
<ul>
<li class="chapter" data-level="15.1" data-path="next-steps.html"><a href="next-steps.html#sensory-analysis-in-r"><i class="fa fa-check"></i><b>15.1</b> Sensory Analysis in R</a></li>
<li class="chapter" data-level="15.2" data-path="next-steps.html"><a href="next-steps.html#other-recommended-resources"><i class="fa fa-check"></i><b>15.2</b> Other Recommended Resources</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="next-steps.html"><a href="next-steps.html#r-for-data-science"><i class="fa fa-check"></i><b>15.2.1</b> R for Data Science</a></li>
<li class="chapter" data-level="15.2.2" data-path="next-steps.html"><a href="next-steps.html#hands-on-machine-learning-with-r"><i class="fa fa-check"></i><b>15.2.2</b> Hands-On Machine Learning with R</a></li>
<li class="chapter" data-level="15.2.3" data-path="next-steps.html"><a href="next-steps.html#factoextra"><i class="fa fa-check"></i><b>15.2.3</b> FactoExtra</a></li>
<li class="chapter" data-level="15.2.4" data-path="next-steps.html"><a href="next-steps.html#r-graphics-cookbook"><i class="fa fa-check"></i><b>15.2.4</b> R Graphics Cookbook</a></li>
<li class="chapter" data-level="15.2.5" data-path="next-steps.html"><a href="next-steps.html#storytelling-with-data"><i class="fa fa-check"></i><b>15.2.5</b> Storytelling with Data</a></li>
<li class="chapter" data-level="15.2.6" data-path="next-steps.html"><a href="next-steps.html#text-mining-wtih-r"><i class="fa fa-check"></i><b>15.2.6</b> Text Mining wtih R</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="next-steps.html"><a href="next-steps.html#databases-graph-and-otherwise"><i class="fa fa-check"></i><b>15.3</b> Databases (Graph and Otherwise)</a></li>
<li class="chapter" data-level="15.4" data-path="next-steps.html"><a href="next-steps.html#python-and-other-languages"><i class="fa fa-check"></i><b>15.4</b> Python and Other Languages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Sensory and Consumer Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-analysis" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Data Analysis</h1>
<p>In this chapter, the different techniques presented in <a href="data-manip.html#data-manip">4</a> will be applied to our biscuit data.
The analyses presented are non-exhaustive, but tackle some well-known analyses often used in sensory and consumer science.</p>
<p>The following sections are divided based on the type of data to consider and their corresponding analysis.</p>
<div id="sensory-data" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Sensory Data</h2>
<!-- Just a note to check the library "here". As I commented before, I guess it worth a note every time a folder(e.g. "data") is assigned, just to make clear that this name may change according to the reader's folder name.  -->
<p>Let’s start with the analysis of our sensory data. If not done already, import the file <em>Sensory Profile.xlsx</em>.
To do so, we need the <code>{here}</code> and <code>{readxl}</code> packages. Since most of the analyses we are going to perform require tools from the <code>{tidyverse}</code>, we also load this group of packages.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="data-analysis.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb127-2"><a href="data-analysis.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb127-3"><a href="data-analysis.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb127-4"><a href="data-analysis.html#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="data-analysis.html#cb127-5" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;Sensory Profile.xlsx&quot;</span>) </span>
<span id="cb127-6"><a href="data-analysis.html#cb127-6" aria-hidden="true" tabindex="-1"></a>p_info <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet =</span> <span class="st">&quot;Product Info&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-7"><a href="data-analysis.html#cb127-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Type)</span>
<span id="cb127-8"><a href="data-analysis.html#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="data-analysis.html#cb127-9" aria-hidden="true" tabindex="-1"></a>sensory <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Data&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-10"><a href="data-analysis.html#cb127-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(p_info, <span class="at">by=</span><span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-11"><a href="data-analysis.html#cb127-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Protein<span class="sc">:</span>Fiber, <span class="at">.after=</span>Product)</span></code></pre></div>
<!-- Would be better to use an attribute other than Shiny. First because it is a less common attribute. Second, there might be some confusion with the shiny package. I'd suggest to use Sweet which is pretty standard -->
<p>Typically, sensory scientists would first seek to determine whether there are differences between samples for the different attributes. This is done through Analysis of Variance (ANOVA) and can be done using the <code>lm()</code> or <code>aov()</code> functions.
If we would want to run the ANOVA for <code>Sweet</code>, the code would look like this (here we consider the 2-way ANOVA evaluating the Product and Assessor effects):</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="data-analysis.html#cb128-1" aria-hidden="true" tabindex="-1"></a>sweet_aov <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sweet <span class="sc">~</span> Product <span class="sc">+</span> Judge, <span class="at">data=</span>sensory)</span>
<span id="cb128-2"><a href="data-analysis.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(sweet_aov)</span></code></pre></div>
<p>We could duplicate this code for each single attribute, but: 1. this would be quite tedious for large number of attributes increase, 2. this code is sensitive to the way the variables are being called, meaning that 3. it would usually not be applicable to other datasets. Instead, we propose two solutions, one using <code>split()</code> combined with <code>map()</code> and one involving <code>nest_by()</code> to run this analysis automatically.</p>
<p>For both these solutions, the dataset should be in the long and short form, which can be obtained using <code>pivot_longer()</code>:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="data-analysis.html#cb129-1" aria-hidden="true" tabindex="-1"></a>senso_aov_data <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="data-analysis.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Shiny<span class="sc">:</span>Melting, <span class="at">names_to=</span><span class="st">&quot;Attribute&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Score&quot;</span>)</span></code></pre></div>
<p>From this structure, the first approach consists in splitting the data by attribute. Once done, we run the ANOVA for each data subset (the model is then defined as <code>Score ~ Product + Judge</code>), and we extract the results of interest using the <code>{broom}</code> package<a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a>
Ultimately, the results can be combined again using <code>enframe()</code> and <code>unnest()</code>.</p>
<!-- I guess it would be helpful to explain a bit about this map () function. -->
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="data-analysis.html#cb130-1" aria-hidden="true" tabindex="-1"></a>senso_aov1 <span class="ot">&lt;-</span> senso_aov_data <span class="sc">%&gt;%</span> </span>
<span id="cb130-2"><a href="data-analysis.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>Attribute) <span class="sc">%&gt;%</span> </span>
<span id="cb130-3"><a href="data-analysis.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="cf">function</span>(data){</span>
<span id="cb130-4"><a href="data-analysis.html#cb130-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-5"><a href="data-analysis.html#cb130-5" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">anova</span>(<span class="fu">lm</span>(Score <span class="sc">~</span> Product <span class="sc">+</span> Judge, <span class="at">data=</span>data)))</span>
<span id="cb130-6"><a href="data-analysis.html#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb130-7"><a href="data-analysis.html#cb130-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-8"><a href="data-analysis.html#cb130-8" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span> </span>
<span id="cb130-9"><a href="data-analysis.html#cb130-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="at">name=</span><span class="st">&quot;Attribute&quot;</span>, <span class="at">value=</span><span class="st">&quot;res&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb130-10"><a href="data-analysis.html#cb130-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res)</span></code></pre></div>
<p>The second approach nests the analysis by attribute (meaning the analysis is done for each attribute separately, a bit like <code>group_by()</code>): in this case, we store the results of the ANOVA in a new variable called <code>mod</code>.
Once the analysis is done, we summarize the info stored in <code>mod</code> by converting it into a tibble using <code>{broom}</code>:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="data-analysis.html#cb131-1" aria-hidden="true" tabindex="-1"></a>senso_aov2 <span class="ot">&lt;-</span> senso_aov_data <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="data-analysis.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(Attribute) <span class="sc">%&gt;%</span> </span>
<span id="cb131-3"><a href="data-analysis.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mod =</span> <span class="fu">list</span>(<span class="fu">lm</span>(Score <span class="sc">~</span> Product <span class="sc">+</span> Judge, <span class="at">data=</span>data))) <span class="sc">%&gt;%</span> </span>
<span id="cb131-4"><a href="data-analysis.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">anova</span>(mod))) <span class="sc">%&gt;%</span> </span>
<span id="cb131-5"><a href="data-analysis.html#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>The two approaches return the exact same results. Let’s dig into the results by checking for which attributes there are no significant differences at 5%. Since the <code>tidy()</code> function from <code>{broom}</code> tidies the data, all the usual data transformation can be performed. Let’s filter only the <code>Product</code> effect under <code>term</code>, and let’s order decreasingly the <code>p.value</code>:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="data-analysis.html#cb132-1" aria-hidden="true" tabindex="-1"></a>senso_aov1 <span class="sc">%&gt;%</span> </span>
<span id="cb132-2"><a href="data-analysis.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb132-3"><a href="data-analysis.html#cb132-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Attribute, statistic, p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb132-4"><a href="data-analysis.html#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(p.value)) <span class="sc">%&gt;%</span> </span>
<span id="cb132-5"><a href="data-analysis.html#cb132-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">round</span>(p.value, <span class="dv">3</span>))</span></code></pre></div>
<p>As can be seen, the products do not show any significant differences at 5% for 4 attributes: <code>Cereal flavor</code> (p=0.294), <code>Roasted odor</code> (p=0.193), <code>Astringent</code> (p=0.116), and <code>Sticky</code> (p=0.101).</p>
<p>Since we ran ANOVAs on multiple attributes, it is useful to visualize the results graphically as a barchart representing the F-value. We recommend to order the attributes based on their decreasing product-wise F-values, and by colour-coding them based on their significance:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="data-analysis.html#cb133-1" aria-hidden="true" tabindex="-1"></a>senso_aov1 <span class="sc">%&gt;%</span> </span>
<span id="cb133-2"><a href="data-analysis.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-3"><a href="data-analysis.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Attribute, statistic, p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb133-4"><a href="data-analysis.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Signif =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>, <span class="st">&quot;Signif.&quot;</span>, <span class="st">&quot;Not Signif.&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-5"><a href="data-analysis.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Signif =</span> <span class="fu">factor</span>(Signif, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Signif.&quot;</span>, <span class="st">&quot;Not Signif.&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb133-6"><a href="data-analysis.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Attribute, statistic), <span class="at">y=</span>statistic, <span class="at">fill=</span>Signif))<span class="sc">+</span></span>
<span id="cb133-7"><a href="data-analysis.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb133-8"><a href="data-analysis.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Signif.&quot;</span><span class="ot">=</span><span class="st">&quot;forestgreen&quot;</span>, <span class="st">&quot;Not Signif.&quot;</span><span class="ot">=</span><span class="st">&quot;orangered2&quot;</span>))<span class="sc">+</span></span>
<span id="cb133-9"><a href="data-analysis.html#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Sensory Attributes&quot;</span>,<span class="st">&quot;(The attributes are sorted according to product-wise F-values)&quot;</span>)<span class="sc">+</span></span>
<span id="cb133-10"><a href="data-analysis.html#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb133-11"><a href="data-analysis.html#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb133-12"><a href="data-analysis.html#cb133-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;F-values&quot;</span>)<span class="sc">+</span></span>
<span id="cb133-13"><a href="data-analysis.html#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<!-- That would be nice to display the resulting chart here -->
<p>It appears that the evaluated biscuits differ the most (top 5) for <code>Initial hardness</code>, <code>Shiny</code>, <code>Dairy flavor</code>, <code>External color intensity</code>, and <code>Thickness</code>.</p>
<p>Note that as an alternative, we could use the <code>decat()</code> function from the <code>{SensoMineR}</code> package. This function performs ANOVA on a set of attributes (presented in subsequent columns), followed by some t-test that highlights which samples are significantly more (or less) intense than average for each attribute.</p>
<p>Once the significant differences have been checked, a follow-up analysis consists in visualizing these differences in a multivariate way. Such visualization is often done through Principal Component Analysis (PCA).</p>
<p>In practice, PCA is performed on the mean table crossing the products in rows, and the sensory attributes in columns. In <a href="data-manip.html#data-manip">4</a>, many different approaches to generate such table have been proposed:</p>
<!-- Maybe this last sentence above could say that one of the many approaches presented on chap 3 would be: ... In the way it is written I had the impression that the many different approaches would be showed -->
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="data-analysis.html#cb134-1" aria-hidden="true" tabindex="-1"></a>senso_mean <span class="ot">&lt;-</span> sensory <span class="sc">%&gt;%</span> </span>
<span id="cb134-2"><a href="data-analysis.html#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Shiny<span class="sc">:</span>Melting, <span class="at">names_to=</span><span class="st">&quot;Attribute&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb134-3"><a href="data-analysis.html#cb134-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Judge) <span class="sc">%&gt;%</span> </span>
<span id="cb134-4"><a href="data-analysis.html#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Attribute, <span class="at">values_from=</span>Score, <span class="at">values_fn=</span>mean)</span></code></pre></div>
<!-- Here, it might be good to briefly mention that several packages or functions can be used to run a PCA (pcrcomp, princomp, PCA). This is important because most students who are not specialized in sensory science would usually go with pcrcomp. They might thus be confused. -->
<p>Such table can be submitted to PCA. To do so, the <code>PCA()</code> function from the <code>{FactoMineR}</code> is used.
<!-- The sentence below sounds odd: shouldn't you rather say: "the function usually applies to (or uses) numerical data only..."? -->
Few important remarks: The <code>PCA()</code> function usually contains only numerical data, the product names being often set as row names in a data frame. This is something that can easily be taken care of through the <code>column_to_rownames()</code> function from the <code>{tibble}</code> package. Additionally, one might notice that we still have two qualitative variables: <code>Protein</code> and <code>Fiber</code>. These 2 variables can either be removed prior to running the analysis, or better, projected as supplementary variables through the <code>quali.sup</code> parameter from <code>PCA()</code>. Last but not least, since <code>POpt</code> is an optimized sample, we are not including it in the analysis: Instead, we project it as supplementary just to illustrate where it would be located on the space if it were.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="data-analysis.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb135-2"><a href="data-analysis.html#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="data-analysis.html#cb135-3" aria-hidden="true" tabindex="-1"></a>senso_pca <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span> </span>
<span id="cb135-4"><a href="data-analysis.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Product) <span class="sc">%&gt;%</span> </span>
<span id="cb135-5"><a href="data-analysis.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb135-6"><a href="data-analysis.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb135-7"><a href="data-analysis.html#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">PCA</span>(., <span class="at">ind.sup=</span><span class="fu">nrow</span>(.), <span class="at">quali.sup=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">graph=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>The <code>PCA()</code> function can generate the plots either in <code>{base}</code> R language, or in <code>{ggplot2}</code>. However, we like to use a complementary package called <code>{factoextra}</code> which re-creates any plot from <code>{FactoMineR}</code> (and more) as a <code>ggplot()</code> object. This comes in very handy as you can benefit from the customizable options and flexibility offered by <code>ggplot()</code>.
The score map (the product map) from <code>PCA()</code> can be hence replotted with <code>fviz_pca_ind()</code>, the representation of variables loadings (attribute correlations) can be managed with <code>fviz_pca_var()</code>, and <code>fviz_pca_biplot()</code> can be used to trace the biplot combining both.
To illustrate how convenient this is, let’s take advantage of the two qualitative variables in our example, by coloring the products based on their protein and fiber content. This can easily be done through the <code>habillage</code> parameter from <code>fviz_pca_ind()</code>, which can either take a numerical value (position) of the name of the qualitative variable.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="data-analysis.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb136-2"><a href="data-analysis.html#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="data-analysis.html#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(senso_pca, <span class="at">habillage=</span><span class="st">&quot;Protein&quot;</span>, <span class="at">repel=</span><span class="cn">TRUE</span>)</span>
<span id="cb136-4"><a href="data-analysis.html#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(senso_pca, <span class="at">habillage=</span><span class="dv">2</span>, <span class="at">repel=</span><span class="cn">TRUE</span>)</span>
<span id="cb136-5"><a href="data-analysis.html#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(senso_pca)</span>
<span id="cb136-6"><a href="data-analysis.html#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(senso_pca)</span></code></pre></div>
<!-- Of course, we will want to see the outcome of the PCA and factoextra plots here. -->
<!-- A few comments/suggestions about PCA: 1) the argument repel could have a short explanation note 2) It would be nice if an example editing the PCA (e.g color) was shown, 3) It was not clear to me how/where P0pt was included as a supplementary analysis, 4) I guess it would be valuable to show how to plot the Scree plot and how to choose the dimension to plot. One may want to plot dim 1 and dim3 and also the contribution plot -->
<p>On the first dimension, <code>P10</code> is opposed to <code>P09</code> and <code>P03</code> as it is more intense for attributes such as <code>Sweet</code>, and <code>Dairy flavor</code> for example, and less intense for attributes such as <code>Dry in mouth</code> and <code>External color intensity</code>. On the second dimension, <code>P08</code>, <code>P06</code>, and <code>POpt</code> are opposed to <code>P02</code> and <code>P07</code> as they score higher for <code>Qty of inclusions</code>, and <code>Initial hardness</code>, and score lower for <code>RawDough flavor</code> and <code>Shiny</code>.</p>
</div>
<div id="demographic-and-questionnaire-data" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Demographic and Questionnaire Data</h2>
<!-- Previous title was 'Demographic and TFEQ Data'. I changed it to make it sound more general -->
<p>The <em>TFEQ.xlsx</em> file contains descriptive (i.e. <em>demographic</em>) information regarding the consumers and their food-related personality traits (i.e. <em>TFEQ</em>) .This file has three tabs denoted as <em>Data</em>, <em>Variables</em>, and <em>Levels</em>:</p>
<ul>
<li><em>Data</em> contains the data, coded;</li>
<li><em>Variables</em> provides information (e.g. name, information) related to the different variables present in Data;</li>
<li><em>Levels</em> provides information about the different levels each variable can take.</li>
</ul>
<p>Let’s start with importing this data set. The importation is done in multiple steps as following:</p>
<!-- "here" should be replace by file.path -->
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="data-analysis.html#cb137-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;TFEQ.xlsx&quot;</span>)</span>
<span id="cb137-2"><a href="data-analysis.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">excel_sheets</span>(file_path)</span>
<span id="cb137-3"><a href="data-analysis.html#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="data-analysis.html#cb137-4" aria-hidden="true" tabindex="-1"></a>demo_var <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Variables&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb137-5"><a href="data-analysis.html#cb137-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Code, Name)</span>
<span id="cb137-6"><a href="data-analysis.html#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="data-analysis.html#cb137-7" aria-hidden="true" tabindex="-1"></a>demo_lev <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Levels&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb137-8"><a href="data-analysis.html#cb137-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Question, Code, Levels) <span class="sc">%&gt;%</span> </span>
<span id="cb137-9"><a href="data-analysis.html#cb137-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(demo_var, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Question&quot;</span><span class="ot">=</span><span class="st">&quot;Code&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb137-10"><a href="data-analysis.html#cb137-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Question)</span>
<span id="cb137-11"><a href="data-analysis.html#cb137-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-12"><a href="data-analysis.html#cb137-12" aria-hidden="true" tabindex="-1"></a>demographic <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Data&quot;</span>, <span class="at">skip=</span><span class="dv">1</span>, <span class="at">col_names=</span><span class="fu">unlist</span>(demo_var<span class="sc">$</span>Name))</span></code></pre></div>
<div id="demographic-data-frequency-and-proportion" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Demographic Data: Frequency and Proportion</h3>
<p>For this demographic data file, we are interested to see the partition of consumers for each of the descriptive variables. More precisely, we would like to know the frequency and proportion (in percentage) attached to each level of <code>Living area</code>, <code>Housing</code>, <code>Income range</code>, and <code>Occupation</code>.</p>
<p>To obtain such a table, let’s start by selecting only the columns corresponding to these variables together with <code>Judge</code>.
Data from surveys and questionnaires are often coded. For example, in this dataset, answer #6 to question Q10 means “Student,” while answer #7 to the same question means “Qualified worker.” Thus, to make these data readable by human beings, we need to decode them using the information stored in <code>demo_lev</code>. For that, we could automatically recode each variable using <code>mutate()</code> and <code>factor()</code>. However, we prefer here to use <code>pivot_longer()</code> to create a long thin tibble, and then to merge this table with <code>demo_lev</code> by <code>Question</code> and <code>Response</code> using <code>inner_join()</code> instead. Once done, we can aggregate the results by <code>Question</code> and <code>Levels</code> (since we want to use the level information, not their code) and compute the frequency (<code>n()</code>) and the proportion (<code>N/sum(N)</code>)<a href="#fn28" class="footnote-ref" id="fnref28"><sup>28</sup></a>.
<!-- JD: I think it's best to avoid saying "we prefer to use..." without explaining why we prefer that (here, pivot_longer()+inner_join()), because it's disturbing for the reader who has to think why  --></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="data-analysis.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formattable)</span>
<span id="cb138-2"><a href="data-analysis.html#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="data-analysis.html#cb138-3" aria-hidden="true" tabindex="-1"></a>demog_reduced <span class="ot">&lt;-</span> demographic <span class="sc">%&gt;%</span> </span>
<span id="cb138-4"><a href="data-analysis.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, <span class="st">`</span><span class="at">Living area</span><span class="st">`</span>, Housing, <span class="st">`</span><span class="at">Income range</span><span class="st">`</span>, <span class="st">`</span><span class="at">Occupation</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb138-5"><a href="data-analysis.html#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Judge, <span class="at">names_to=</span><span class="st">&quot;Question&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Response&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb138-6"><a href="data-analysis.html#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(demo_lev, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Question&quot;</span><span class="ot">=</span><span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Response&quot;</span><span class="ot">=</span><span class="st">&quot;Code&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-7"><a href="data-analysis.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Question, Levels) <span class="sc">%&gt;%</span> </span>
<span id="cb138-8"><a href="data-analysis.html#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb138-9"><a href="data-analysis.html#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pct =</span> <span class="fu">percent</span>(N<span class="sc">/</span><span class="fu">sum</span>(N), <span class="at">digits=</span>1L)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-10"><a href="data-analysis.html#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>Histograms are a nice way to visualize proportions and to compare them over several variables. Such histograms can be obtained by splitting <code>demog_reduced</code> by <code>Question</code> and by creating in each case an histogram using either <code>N</code> or <code>Pct</code> (we are using <code>Pct</code>)<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a>. Of course, we automate this across all questions using <code>map()</code>.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="data-analysis.html#cb139-1" aria-hidden="true" tabindex="-1"></a>demog_reduced <span class="sc">%&gt;%</span> </span>
<span id="cb139-2"><a href="data-analysis.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>Question) <span class="sc">%&gt;%</span> </span>
<span id="cb139-3"><a href="data-analysis.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="cf">function</span>(data){</span>
<span id="cb139-4"><a href="data-analysis.html#cb139-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-5"><a href="data-analysis.html#cb139-5" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">=</span> <span class="fu">as.character</span>(<span class="fu">unlist</span>(data<span class="sc">$</span>Question))</span>
<span id="cb139-6"><a href="data-analysis.html#cb139-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-7"><a href="data-analysis.html#cb139-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Levels, Pct), <span class="at">y=</span>Pct, <span class="at">label=</span>Pct))<span class="sc">+</span></span>
<span id="cb139-8"><a href="data-analysis.html#cb139-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey50&quot;</span>)<span class="sc">+</span></span>
<span id="cb139-9"><a href="data-analysis.html#cb139-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Pct<span class="sc">/</span><span class="dv">2</span>), <span class="at">colour=</span><span class="st">&quot;white&quot;</span>)<span class="sc">+</span></span>
<span id="cb139-10"><a href="data-analysis.html#cb139-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb139-11"><a href="data-analysis.html#cb139-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb139-12"><a href="data-analysis.html#cb139-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(var)<span class="sc">+</span></span>
<span id="cb139-13"><a href="data-analysis.html#cb139-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb139-14"><a href="data-analysis.html#cb139-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_flip</span>()</span>
<span id="cb139-15"><a href="data-analysis.html#cb139-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-16"><a href="data-analysis.html#cb139-16" aria-hidden="true" tabindex="-1"></a>  })</span></code></pre></div>
</div>
<div id="personality-traits-and-eating-behavior-tfeq-data" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Personality traits and eating behavior: TFEQ data</h3>
<!-- TFEQ data are about behavior, but strictly speaking, they are not behavioral data. If we want to focus on truly behavioral data at some point, we can look at how many cookies they eat in each session , or how much they drink. -->
<p>In the same data set, consumers also answered some questions that reflect on their eating behavior and their relation to food (REF REF). These questions can be categorized into three groups relating to three underlying factors, respectively: Disinhibition (variables starting with <code>D</code>), Restriction (variables starting with <code>R</code>), and sensitivity to Hunger (variables starting with <code>H</code>).</p>
<p>In order to analyze these three factors separately, we first need to select the corresponding variables. When variable names are well structured with a recurring pattern (here, they all start with the letters D, R, or H, followed by a number) the use of a <em>regular expression</em> is very powerful.</p>
<p>Note that, instead we could think of using <code>select()</code> combined with <code>starts_with("D")</code>, <code>starts_with("R")</code>, and <code>starts_with("H")</code>, but this solution is not satisfactory because it can also select other variables that would start with any of these letters (e.g. Housing).</p>
<p>In practice, generating a regular expression can be quite complex as it is an abstract concept which follows very specific rules. Fortunately, the package <code>{RVerbalExpression}</code> is a great assistant as it generates the regular expression for you thanks to understandable functions. First, we initiate the regular expression by calling the function <code>rx()</code> to which we add that we first want any variables that start with any of the letter R, D, or H, followed by a number (or more, as values go from 1 to 21). This can be done using the following code:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="data-analysis.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RVerbalExpressions)</span>
<span id="cb140-2"><a href="data-analysis.html#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="data-analysis.html#cb140-3" aria-hidden="true" tabindex="-1"></a>rdh <span class="ot">&lt;-</span> <span class="fu">rx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="data-analysis.html#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rx_either_of</span>(<span class="fu">c</span>(<span class="st">&quot;R&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;H&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb140-5"><a href="data-analysis.html#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rx_digit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb140-6"><a href="data-analysis.html#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rx_one_or_more</span>()</span>
<span id="cb140-7"><a href="data-analysis.html#cb140-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-8"><a href="data-analysis.html#cb140-8" aria-hidden="true" tabindex="-1"></a>rdh</span></code></pre></div>
<p><code>rdh</code> contains the regular expression that we need. We can then <code>dplyr::select()</code> any variable that fits our regular expression by using the function <code>matches()</code>.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="data-analysis.html#cb141-1" aria-hidden="true" tabindex="-1"></a>demographic <span class="sc">%&gt;%</span> </span>
<span id="cb141-2"><a href="data-analysis.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">matches</span>(rdh))</span></code></pre></div>
<p>In order to build a separate frequency table for each of these variables, we create a function called <code>myfreq()</code> which will automatically compute the frequency for each level, and the corresponding percentage.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="data-analysis.html#cb142-1" aria-hidden="true" tabindex="-1"></a>myfreq <span class="ot">&lt;-</span> <span class="cf">function</span>(data, info){</span>
<span id="cb142-2"><a href="data-analysis.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-3"><a href="data-analysis.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">=</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(data<span class="sc">$</span>TFEQ))</span>
<span id="cb142-4"><a href="data-analysis.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  info <span class="ot">&lt;-</span> info <span class="sc">%&gt;%</span> </span>
<span id="cb142-5"><a href="data-analysis.html#cb142-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Name <span class="sc">==</span> var)</span>
<span id="cb142-6"><a href="data-analysis.html#cb142-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-7"><a href="data-analysis.html#cb142-7" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb142-8"><a href="data-analysis.html#cb142-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Response =</span> <span class="fu">factor</span>(Response, <span class="at">levels=</span>info<span class="sc">$</span>Code, <span class="at">labels=</span>info<span class="sc">$</span>Levels)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-9"><a href="data-analysis.html#cb142-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(Response) <span class="sc">%&gt;%</span> </span>
<span id="cb142-10"><a href="data-analysis.html#cb142-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Response) <span class="sc">%&gt;%</span> </span>
<span id="cb142-11"><a href="data-analysis.html#cb142-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb142-12"><a href="data-analysis.html#cb142-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Pct =</span> <span class="fu">percent</span>(N<span class="sc">/</span><span class="fu">sum</span>(N), <span class="at">digits=</span>1L)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-13"><a href="data-analysis.html#cb142-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb142-14"><a href="data-analysis.html#cb142-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-15"><a href="data-analysis.html#cb142-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb142-16"><a href="data-analysis.html#cb142-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We then apply this function to each variable separately using <code>map()</code> after pivoting all these variables of interest (<code>pivot_longer()</code>) and splitting the data by <code>TFEQ</code> question:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="data-analysis.html#cb143-1" aria-hidden="true" tabindex="-1"></a>TFEQ_freq <span class="ot">&lt;-</span> demographic <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="data-analysis.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, <span class="fu">matches</span>(rdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb143-3"><a href="data-analysis.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Judge, <span class="at">names_to=</span><span class="st">&quot;TFEQ&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Response&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-4"><a href="data-analysis.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>TFEQ) <span class="sc">%&gt;%</span></span>
<span id="cb143-5"><a href="data-analysis.html#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(myfreq, <span class="at">info=</span>demo_lev) <span class="sc">%&gt;%</span> </span>
<span id="cb143-6"><a href="data-analysis.html#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="at">name =</span> <span class="st">&quot;TFEQ&quot;</span>, <span class="at">value=</span><span class="st">&quot;res&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-7"><a href="data-analysis.html#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb143-8"><a href="data-analysis.html#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TFEQ =</span> <span class="fu">factor</span>(TFEQ, <span class="at">levels=</span><span class="fu">unique</span>(<span class="fu">str_sort</span>(.<span class="sc">$</span>TFEQ, <span class="at">numeric=</span><span class="cn">TRUE</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb143-9"><a href="data-analysis.html#cb143-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(TFEQ)</span></code></pre></div>
<p>Accordingly, we can create histograms that represent the frequency distribution for each variable. But let’s suppose that we only want to display variables related to Disinhibition. To do so, we first need to generate the corresponding regular expression (only selecting variables starting with “D”) to filter the results before creating the plots:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="data-analysis.html#cb144-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">rx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="data-analysis.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rx_find</span>(<span class="st">&quot;D&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb144-3"><a href="data-analysis.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rx_digit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb144-4"><a href="data-analysis.html#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rx_one_or_more</span>()</span>
<span id="cb144-5"><a href="data-analysis.html#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="data-analysis.html#cb144-6" aria-hidden="true" tabindex="-1"></a>TFEQ_freq <span class="sc">%&gt;%</span> </span>
<span id="cb144-7"><a href="data-analysis.html#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(TFEQ, d)) <span class="sc">%&gt;%</span> </span>
<span id="cb144-8"><a href="data-analysis.html#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Response, <span class="at">y=</span>Pct, <span class="at">label=</span>Pct))<span class="sc">+</span></span>
<span id="cb144-9"><a href="data-analysis.html#cb144-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span> , <span class="at">fill=</span><span class="st">&quot;grey50&quot;</span>)<span class="sc">+</span></span>
<span id="cb144-10"><a href="data-analysis.html#cb144-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Pct<span class="sc">/</span><span class="dv">2</span>), <span class="at">colour=</span><span class="st">&quot;white&quot;</span>)<span class="sc">+</span></span>
<span id="cb144-11"><a href="data-analysis.html#cb144-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb144-12"><a href="data-analysis.html#cb144-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>TFEQ, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<!-- Maybe it is a good idea to mention or add a function to avoid the x-labels overlap. -->
<p>Structured questionnaires such as the TFEQ are very frequent in sensory and consumer science. They are used to measure individual patterns as diverse as personality traits, attitudes, food choice motives, engagement, social desirability bias, etc. Ultimately, the TFEQ questionnaire consists in a set of structured questions whose respective answers combine to provide a TFEQ score (actually, three scores, one for Disinhibition, one for Restriction and one for sensitivity to Hunger). This TFEQ scores translate into certain food behavior tendencies.</p>
<p>However, it appears that the TFEQ scores are not computed by simply adding the scores of all TFEQ questions together. Instead, they follow certain rules that are stored in the <em>Variables</em> sheet in <em>TFEQ.xlsx</em>. For each TFEQ question, the rule to follow is provided by <code>Direction</code> and <code>Value</code>, and works as following: if the condition provided by <code>Direction</code> and <code>Value</code> is met, then the respondent gets a 1, else a 0. Ultimately, the TFEQ is the sum of all these evaluations.</p>
<p>Let’s start by extracting this information (<code>Direction</code> and <code>Value</code>) from the sheet <em>Variables</em> for all the variables involved in the computation of the TFEQ scores. We store this in <code>var_drh</code>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="data-analysis.html#cb145-1" aria-hidden="true" tabindex="-1"></a>var_rdh <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Variables&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="data-analysis.html#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Name, rdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb145-3"><a href="data-analysis.html#cb145-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Name, Direction, Value)</span></code></pre></div>
<p>This information is added to <code>demographic</code>. Since we need to evaluate each assessors’ answer to the TFEQ questions, we create a new variable <code>TFEQValue</code> which takes a 1 if the corresponding condition is met, and a 0 otherwise. Such approach is done through <code>mutate()</code> combined with a succession of intertwined <code>ifelse()</code> functions.<a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a></p>
<p>Ultimately, we compute the TFEQ Score by summing across all <code>TFEQValue</code> per respondent (here, we compute the sum per category first before computing the grand total per respondent).</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="data-analysis.html#cb146-1" aria-hidden="true" tabindex="-1"></a>TFEQ <span class="ot">&lt;-</span> demographic <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="data-analysis.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, <span class="fu">matches</span>(rdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb146-3"><a href="data-analysis.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Judge, <span class="at">names_to=</span><span class="st">&quot;DHR&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb146-4"><a href="data-analysis.html#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(var_rdh, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;DHR&quot;</span><span class="ot">=</span><span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb146-5"><a href="data-analysis.html#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TFEQValue =</span> <span class="fu">ifelse</span>(Direction <span class="sc">==</span> <span class="st">&quot;Equal&quot;</span> <span class="sc">&amp;</span> Score <span class="sc">==</span> Value, <span class="dv">1</span>, </span>
<span id="cb146-6"><a href="data-analysis.html#cb146-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span> (Direction <span class="sc">==</span> <span class="st">&quot;Superior&quot;</span> <span class="sc">&amp;</span> Score <span class="sc">&gt;</span> Value, <span class="dv">1</span>,</span>
<span id="cb146-7"><a href="data-analysis.html#cb146-7" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">ifelse</span>(Direction <span class="sc">==</span> <span class="st">&quot;Inferior&quot;</span> <span class="sc">&amp;</span> Score <span class="sc">&lt;</span> Value, <span class="dv">1</span>, <span class="dv">0</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb146-8"><a href="data-analysis.html#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Factor =</span> <span class="fu">ifelse</span>(<span class="fu">str_starts</span>(.<span class="sc">$</span>DHR, <span class="st">&quot;D&quot;</span>), <span class="st">&quot;Disinhibition&quot;</span>,</span>
<span id="cb146-9"><a href="data-analysis.html#cb146-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(<span class="fu">str_starts</span>(.<span class="sc">$</span>DHR, <span class="st">&quot;H&quot;</span>), <span class="st">&quot;Hunger&quot;</span>, <span class="st">&quot;Restriction&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb146-10"><a href="data-analysis.html#cb146-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Factor =</span> <span class="fu">factor</span>(Factor, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Restriction&quot;</span>,<span class="st">&quot;Disinhibition&quot;</span>,<span class="st">&quot;Hunger&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb146-11"><a href="data-analysis.html#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Judge, Factor) <span class="sc">%&gt;%</span> </span>
<span id="cb146-12"><a href="data-analysis.html#cb146-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">TFEQ =</span> <span class="fu">sum</span>(TFEQValue)) <span class="sc">%&gt;%</span> </span>
<span id="cb146-13"><a href="data-analysis.html#cb146-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Judge =</span> <span class="fu">factor</span>(Judge, <span class="at">levels=</span><span class="fu">unique</span>(<span class="fu">str_sort</span>(.<span class="sc">$</span>Judge, <span class="at">numeric=</span><span class="cn">TRUE</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb146-14"><a href="data-analysis.html#cb146-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Judge) <span class="sc">%&gt;%</span> </span>
<span id="cb146-15"><a href="data-analysis.html#cb146-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Factor, <span class="at">values_from=</span>TFEQ) <span class="sc">%&gt;%</span> </span>
<span id="cb146-16"><a href="data-analysis.html#cb146-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total =</span> <span class="fu">sum</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric))))</span></code></pre></div>
<!-- I though this last part a bit harder to follow, maybe it is a good idea to explain the last code in more detail or break to in a way the reader can clearly understand what is happening in each step... -->
<p>Such results can then be visualized graphically, for instance by representing the distribution of the TFEQ score for the 3 categories of questions (or TFEQ-factor):</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="data-analysis.html#cb147-1" aria-hidden="true" tabindex="-1"></a>TFEQ <span class="sc">%&gt;%</span> </span>
<span id="cb147-2"><a href="data-analysis.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Total) <span class="sc">%&gt;%</span> </span>
<span id="cb147-3"><a href="data-analysis.html#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Judge, <span class="at">names_to=</span><span class="st">&quot;Factor&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Scores&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb147-4"><a href="data-analysis.html#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Scores, <span class="at">colour=</span>Factor))<span class="sc">+</span></span>
<span id="cb147-5"><a href="data-analysis.html#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb147-6"><a href="data-analysis.html#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;TFEQ Score&quot;</span>)<span class="sc">+</span></span>
<span id="cb147-7"><a href="data-analysis.html#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb147-8"><a href="data-analysis.html#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Distribution of the Individual TFEQ-factor Scores&quot;</span>)<span class="sc">+</span></span>
<span id="cb147-9"><a href="data-analysis.html#cb147-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</div>
</div>
<div id="consumer-data" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Consumer Data</h2>
<p>The analysis of consumer data usually involves the same type of analysis as the ones for sensory data (e.g. ANOVA, PCA, etc.), but the way the data is being collected (absence of duplicates) and its underlying nature (affective vs. descriptive) require some adjustments.</p>
<p>Let’s start by importing the consumer data that is stored in <em>Consumer Test.xlsx</em>. Here, we import two sheets, one with the consumption time and number of biscuits (stored in <code>Nbiscuit</code>), and one with different consumer evaluations of the samples (stored in <code>consumer</code>)</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="data-analysis.html#cb148-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;Data&quot;</span>,<span class="st">&quot;Consumer Test.xlsx&quot;</span>)</span>
<span id="cb148-2"><a href="data-analysis.html#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="data-analysis.html#cb148-3" aria-hidden="true" tabindex="-1"></a>Nbiscuit <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Time Consumption&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb148-4"><a href="data-analysis.html#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Product =</span> <span class="fu">str_c</span>(<span class="st">&quot;P&quot;</span>, Product)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-5"><a href="data-analysis.html#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">N =</span> <span class="st">`</span><span class="at">Nb biscuits</span><span class="st">`</span>)</span>
<span id="cb148-6"><a href="data-analysis.html#cb148-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-7"><a href="data-analysis.html#cb148-7" aria-hidden="true" tabindex="-1"></a>consumer <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(file_path, <span class="at">sheet=</span><span class="st">&quot;Biscuits&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb148-8"><a href="data-analysis.html#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Judge=</span>Consumer, <span class="at">Product=</span>Samples) <span class="sc">%&gt;%</span> </span>
<span id="cb148-9"><a href="data-analysis.html#cb148-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Judge =</span> <span class="fu">str_c</span>(<span class="st">&quot;J&quot;</span>, Judge), <span class="at">Product =</span> <span class="fu">str_c</span>(<span class="st">&quot;P&quot;</span>, Product)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-10"><a href="data-analysis.html#cb148-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(Nbiscuit, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Judge&quot;</span>, <span class="st">&quot;Product&quot;</span>))</span></code></pre></div>
<p>Similarly to the sensory data, let’s start with computing the mean liking score per product after the first bite (<code>1stbite_liking</code>) and at the end of the evaluation (<code>after_liking</code>).</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="data-analysis.html#cb149-1" aria-hidden="true" tabindex="-1"></a>consumer <span class="sc">%&gt;%</span> </span>
<span id="cb149-2"><a href="data-analysis.html#cb149-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, <span class="st">`</span><span class="at">1stbite_liking</span><span class="st">`</span>, <span class="st">`</span><span class="at">after_liking</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb149-3"><a href="data-analysis.html#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Product) <span class="sc">%&gt;%</span> </span>
<span id="cb149-4"><a href="data-analysis.html#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean))</span></code></pre></div>
<p>A first glance at the table shows that there are clear differences between the samples (within a liking variable), but little difference between liking variables (within a sample).</p>
<p>Of course, we want to know if differences between samples are significant. We thus need to perform an ANOVA (testing for the product effect) followed up by a paired comparison test (here Tukey’s HSD). To do so, we recommend the <code>{agricolae}</code> package that is simple to use and has all its built-in tests working in the same way.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="data-analysis.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb150-2"><a href="data-analysis.html#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="data-analysis.html#cb150-3" aria-hidden="true" tabindex="-1"></a>liking_start <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">1stbite_liking</span><span class="st">`</span> <span class="sc">~</span> Product <span class="sc">+</span> Judge, <span class="at">data=</span>consumer)</span>
<span id="cb150-4"><a href="data-analysis.html#cb150-4" aria-hidden="true" tabindex="-1"></a>liking_start_hsd <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(liking_start, <span class="st">&quot;Product&quot;</span>)<span class="sc">$</span>groups <span class="sc">%&gt;%</span> </span>
<span id="cb150-5"><a href="data-analysis.html#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;Product&quot;</span>)</span>
<span id="cb150-6"><a href="data-analysis.html#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="data-analysis.html#cb150-7" aria-hidden="true" tabindex="-1"></a>liking_end <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">after_liking</span><span class="st">`</span> <span class="sc">~</span> Product <span class="sc">+</span> Judge, <span class="at">data=</span>consumer)</span>
<span id="cb150-8"><a href="data-analysis.html#cb150-8" aria-hidden="true" tabindex="-1"></a>liking_end_hsd <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(liking_end, <span class="st">&quot;Product&quot;</span>)<span class="sc">$</span>groups <span class="sc">%&gt;%</span> </span>
<span id="cb150-9"><a href="data-analysis.html#cb150-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;Product&quot;</span>)</span></code></pre></div>
<p>Both at the start and at the end of the evaluation, significant differences (at 5%) in liking between samples are observed according to Tukey’s HSD test.</p>
<p>To further compare the liking assessment of the samples after the first bite and at the end of the tasting, the results obtained from <code>liking_start_hsd</code> and <code>liking_end_hsd</code> are combined. We then represent the results in a barchart:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="data-analysis.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">Start =</span> liking_start_hsd <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Liking=</span><span class="st">`</span><span class="at">1stbite_liking</span><span class="st">`</span>), </span>
<span id="cb151-2"><a href="data-analysis.html#cb151-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">End =</span> liking_end_hsd <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Liking=</span><span class="st">`</span><span class="at">after_liking</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb151-3"><a href="data-analysis.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="at">name =</span> <span class="st">&quot;Moment&quot;</span>, <span class="at">value =</span> <span class="st">&quot;res&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-4"><a href="data-analysis.html#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb151-5"><a href="data-analysis.html#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Moment =</span> <span class="fu">factor</span>(Moment, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Start&quot;</span>,<span class="st">&quot;End&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb151-6"><a href="data-analysis.html#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Product, <span class="sc">-</span>Liking), <span class="at">y=</span>Liking, <span class="at">fill=</span>Moment))<span class="sc">+</span></span>
<span id="cb151-7"><a href="data-analysis.html#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="sc">+</span></span>
<span id="cb151-8"><a href="data-analysis.html#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb151-9"><a href="data-analysis.html#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Comparison of the liking scores at the start and at the end of the evaluation&quot;</span>)<span class="sc">+</span></span>
<span id="cb151-10"><a href="data-analysis.html#cb151-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>As can be seen, the pattern of liking scores across samples is indeed very stable across the evaluation, particularly in terms of rank.
At the individual level, such linear relationship is also observed (here for the first 12 consumers):</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="data-analysis.html#cb152-1" aria-hidden="true" tabindex="-1"></a>consumer <span class="sc">%&gt;%</span> </span>
<span id="cb152-2"><a href="data-analysis.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, <span class="at">Start=</span><span class="st">`</span><span class="at">1stbite_liking</span><span class="st">`</span>, <span class="at">End=</span><span class="st">`</span><span class="at">after_liking</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb152-3"><a href="data-analysis.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Judge <span class="sc">%in%</span> <span class="fu">str_c</span>(<span class="st">&quot;J&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb152-4"><a href="data-analysis.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Judge =</span> <span class="fu">factor</span>(Judge, <span class="at">levels=</span><span class="fu">unique</span>(<span class="fu">str_sort</span>(.<span class="sc">$</span>Judge, <span class="at">numeric=</span><span class="cn">TRUE</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb152-5"><a href="data-analysis.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Start, <span class="at">y=</span>End))<span class="sc">+</span></span>
<span id="cb152-6"><a href="data-analysis.html#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb152-7"><a href="data-analysis.html#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">formula=</span><span class="st">&quot;y~x&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb152-8"><a href="data-analysis.html#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb152-9"><a href="data-analysis.html#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Overall Liking&quot;</span>, <span class="st">&quot;(Assessment after first bite vs. end of the tasting)&quot;</span>)<span class="sc">+</span></span>
<span id="cb152-10"><a href="data-analysis.html#cb152-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Judge)</span></code></pre></div>
<!-- Also include comparison between Liking score (9pt) and the continuous scale? Or should we put that as an exercise and make them reflect on the results? We could ask to create the plot including all consumers and then ask specifically for some of them... -->
<p>Another interesting relationship to study involves the liking scores<a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a> and the number of cookies eaten by each consumer. We could follow the same procedure as before, but prefer to add here a filter to only show consumers with a significant regression line at 5%.</p>
<p>Let’s start by creating a function called <code>run_reg()</code> that runs the regression analysis of the number of biscuits (<code>N</code>) in function of the liking score (<code>Liking</code>):</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="data-analysis.html#cb153-1" aria-hidden="true" tabindex="-1"></a>run_reg <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb153-2"><a href="data-analysis.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">lm</span>(N <span class="sc">~</span> Liking, <span class="at">data=</span>df)</span>
<span id="cb153-3"><a href="data-analysis.html#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb153-4"><a href="data-analysis.html#cb153-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>After transforming the data, we apply this function to our data, but we are going to store two sorts of results (as list) in our tibbles:
- <code>lm_obj</code> which corresponds to the results of the linear model
- <code>glance</code> which contains some general results of the model incl. R2, the p-value, etc.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="data-analysis.html#cb154-1" aria-hidden="true" tabindex="-1"></a>N_liking <span class="ot">&lt;-</span> consumer <span class="sc">%&gt;%</span> </span>
<span id="cb154-2"><a href="data-analysis.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, <span class="at">Liking=</span><span class="st">`</span><span class="at">end_liking 9pt</span><span class="st">`</span>, N) <span class="sc">%&gt;%</span> </span>
<span id="cb154-3"><a href="data-analysis.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Liking =</span> <span class="dv">10</span><span class="sc">-</span>Liking) <span class="sc">%&gt;%</span> </span>
<span id="cb154-4"><a href="data-analysis.html#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Judge) <span class="sc">%&gt;%</span></span>
<span id="cb154-5"><a href="data-analysis.html#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb154-6"><a href="data-analysis.html#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb154-7"><a href="data-analysis.html#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lm_obj =</span> <span class="fu">map</span>(data, run_reg)) <span class="sc">%&gt;%</span> </span>
<span id="cb154-8"><a href="data-analysis.html#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">glance =</span> <span class="fu">map</span>(lm_obj, broom<span class="sc">::</span>glance)) <span class="sc">%&gt;%</span> </span>
<span id="cb154-9"><a href="data-analysis.html#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glance) <span class="sc">%&gt;%</span> </span>
<span id="cb154-10"><a href="data-analysis.html#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb154-11"><a href="data-analysis.html#cb154-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb154-12"><a href="data-analysis.html#cb154-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Judge =</span> <span class="fu">fct_reorder</span>(Judge, p.value)) <span class="sc">%&gt;%</span> </span>
<span id="cb154-13"><a href="data-analysis.html#cb154-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span></code></pre></div>
<p>Ultimately, we can represent the relationship in a line chart:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="data-analysis.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(N_liking, <span class="fu">aes</span>(<span class="at">x=</span>Liking, <span class="at">y=</span>N))<span class="sc">+</span></span>
<span id="cb155-2"><a href="data-analysis.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb155-3"><a href="data-analysis.html#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">formula=</span><span class="st">&quot;y~x&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb155-4"><a href="data-analysis.html#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb155-5"><a href="data-analysis.html#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Number of Biscuits vs. Liking&quot;</span>,<span class="st">&quot;(Consumers with a significant (5%) regression model are shown (ordered from the most to the least signif.)&quot;</span>)<span class="sc">+</span></span>
<span id="cb155-6"><a href="data-analysis.html#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Judge, <span class="at">scales=</span><span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
</div>
<div id="combining-sensory-and-consumer-data" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Combining Sensory and Consumer Data</h2>
<div id="internal-preference-mapping" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Internal Preference Mapping</h3>
<p>Now we’ve analyzed the sensory and the consumer data separately, it is time to combine both data sets and analyzed them conjointly. A first analysis that can then be performed is the internal preference mapping, i.e. a PCA on the consumer liking scores in which we project as supplementary variables the sensory attributes.</p>
<p>Such analysis is split in 3 steps:
1. The consumer data is re-organized in a wide format with the samples in rows and the consumers in columns;
2. The sensory mean table is joined to the consumer data (to do so, we need to make sure that the product names perfectly match in the two files);
3. A PCA is performed on the consumer data, the sensory descriptors being projected as supplementary onto that space.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="data-analysis.html#cb156-1" aria-hidden="true" tabindex="-1"></a>consumer_wide <span class="ot">&lt;-</span> consumer <span class="sc">%&gt;%</span> </span>
<span id="cb156-2"><a href="data-analysis.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Product, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;P&quot;</span>, <span class="st">&quot;Number&quot;</span>), <span class="at">sep =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-3"><a href="data-analysis.html#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Number =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(Number) <span class="sc">==</span> <span class="dv">1</span>, <span class="fu">str_c</span>(<span class="st">&quot;0&quot;</span>, Number), Number)) <span class="sc">%&gt;%</span> </span>
<span id="cb156-4"><a href="data-analysis.html#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(Product, P, Number, <span class="at">sep=</span><span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-5"><a href="data-analysis.html#cb156-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, <span class="at">Liking=</span><span class="st">`</span><span class="at">end_liking 9pt</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-6"><a href="data-analysis.html#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Liking =</span> <span class="dv">10</span><span class="sc">-</span>Liking) <span class="sc">%&gt;%</span> </span>
<span id="cb156-7"><a href="data-analysis.html#cb156-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Judge, <span class="at">values_from=</span>Liking)</span>
<span id="cb156-8"><a href="data-analysis.html#cb156-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-9"><a href="data-analysis.html#cb156-9" aria-hidden="true" tabindex="-1"></a>data_mdpref <span class="ot">&lt;-</span> senso_mean <span class="sc">%&gt;%</span> </span>
<span id="cb156-10"><a href="data-analysis.html#cb156-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(consumer_wide, <span class="at">by=</span><span class="st">&quot;Product&quot;</span>)</span>
<span id="cb156-11"><a href="data-analysis.html#cb156-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-12"><a href="data-analysis.html#cb156-12" aria-hidden="true" tabindex="-1"></a>res_mdpref <span class="ot">&lt;-</span> data_mdpref <span class="sc">%&gt;%</span> </span>
<span id="cb156-13"><a href="data-analysis.html#cb156-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb156-14"><a href="data-analysis.html#cb156-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-15"><a href="data-analysis.html#cb156-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">PCA</span>(., <span class="at">quali.sup=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">quanti.sup=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">34</span>, <span class="at">graph=</span><span class="cn">FALSE</span>)</span>
<span id="cb156-16"><a href="data-analysis.html#cb156-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-17"><a href="data-analysis.html#cb156-17" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res_mdpref, <span class="at">habillage=</span><span class="dv">1</span>)</span>
<span id="cb156-18"><a href="data-analysis.html#cb156-18" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res_mdpref, <span class="at">label=</span><span class="st">&quot;quanti.sup&quot;</span>, <span class="at">select.var=</span><span class="fu">list</span>(<span class="at">cos2=</span><span class="fl">0.5</span>), <span class="at">repel=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<!-- I guess it is always good to have some little comments in the line code to clarify things. Like quali.sup, = 1:2, quanti.sup = 3:34, habillage, cos2... This will save time from the reader that may need to stop and search about  those things to fully understand the code -->
<p>As can be seen, the consumers are fairly in agreement as all the consumers (black arrows) are pointed in a similar direction.
In overall, they seem to like biscuits that are sweet, with cereal flavor, and fatty/dairy flavor and odor, and dislike biscuits defined as astringent, dry in mouth, uneven and with dark external color.</p>
</div>
<div id="consumers-clustering" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Consumers Clustering</h3>
<p>Although the data show a fairly good agreement between consumers, let’s cluster them in more homogeneous groups based on liking.
Various solutions for clustering exist, depending on the type of distance (similarity or dissimilarity), the linkage (single, average, Ward, etc.), and of course the algorithm itself (e.g. AHC, k-means, etc.).
Here, we opt for the Agglomerative Hierarchical Clustering (AHC) approach with Euclidean distance (dissimilarity) and Ward criterion.
<!-- Is there a reason why this approach was chose here? -->
Such analysis can be done using <code>stats::hclust()</code> or <code>cluster::agnes()</code>.</p>
<p>Note that before computing the distance between consumers, it is advised to at least center their liking scores (subtracting their mean liking scores to each of their individual scores) as it allows grouping consumers based on similar preferences, rather than on their scale usage (otherwise, consumers who scored high on all samples are be grouped together, and separated from consumers who scored low on all samples, which isn’t so much informative).</p>
<p>Let’s start with computing the euclidean distance between each pair of consumers by using the <code>dist()</code> function.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="data-analysis.html#cb157-1" aria-hidden="true" tabindex="-1"></a>consumer_dist <span class="ot">&lt;-</span> consumer_wide <span class="sc">%&gt;%</span> </span>
<span id="cb157-2"><a href="data-analysis.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb157-3"><a href="data-analysis.html#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb157-4"><a href="data-analysis.html#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>(., <span class="at">center=</span><span class="cn">TRUE</span>, <span class="at">scale=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb157-5"><a href="data-analysis.html#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb157-6"><a href="data-analysis.html#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dist</span>(., <span class="at">method=</span><span class="st">&quot;euclidean&quot;</span>)</span></code></pre></div>
<!-- Same comment before. Some commands may not be very familiar to the reader and it worth a note or comment, like t(.)-->
<p>We then run the AHC using the <code>hclust()</code> function and the <code>method = "ward.D2"</code> parameter, which is the equivalent to the <code>method = "ward"</code> for <code>agnes()</code>. To visualize the dendrogram, we use the <code>factoextra::fviz_dend()</code> function:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="data-analysis.html#cb158-1" aria-hidden="true" tabindex="-1"></a>res_hclust <span class="ot">&lt;-</span> <span class="fu">hclust</span>(consumer_dist, <span class="at">method=</span><span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb158-2"><a href="data-analysis.html#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="data-analysis.html#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(res_hclust, <span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb158-4"><a href="data-analysis.html#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(res_hclust, <span class="at">k=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;phylogenic&quot;</span>)</span></code></pre></div>
<!-- What does the argument k mean? How we define that? -->
<p>Since we are satisfied with the 2 clusters solution, we cut the tree at this level using, hence generating a group of 74 and a group of 33 consumers.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="data-analysis.html#cb159-1" aria-hidden="true" tabindex="-1"></a>res_clust <span class="ot">&lt;-</span> <span class="fu">cutree</span>(res_hclust, <span class="at">k=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb159-2"><a href="data-analysis.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames=</span><span class="st">&quot;Judge&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb159-3"><a href="data-analysis.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Cluster =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb159-4"><a href="data-analysis.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">as.character</span>(Cluster))</span>
<span id="cb159-5"><a href="data-analysis.html#cb159-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-6"><a href="data-analysis.html#cb159-6" aria-hidden="true" tabindex="-1"></a>res_clust <span class="sc">%&gt;%</span> </span>
<span id="cb159-7"><a href="data-analysis.html#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cluster) <span class="sc">%&gt;%</span> </span>
<span id="cb159-8"><a href="data-analysis.html#cb159-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb159-9"><a href="data-analysis.html#cb159-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>Lastly, we compare visually the preference patterns between clusters by representing in a line chart the average liking score for each product provided by each cluster.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="data-analysis.html#cb160-1" aria-hidden="true" tabindex="-1"></a>mean_cluster <span class="ot">&lt;-</span> consumer <span class="sc">%&gt;%</span> </span>
<span id="cb160-2"><a href="data-analysis.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Product, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;P&quot;</span>, <span class="st">&quot;Number&quot;</span>), <span class="at">sep =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-3"><a href="data-analysis.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Number =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(Number) <span class="sc">==</span> <span class="dv">1</span>, <span class="fu">str_c</span>(<span class="st">&quot;0&quot;</span>, Number), Number)) <span class="sc">%&gt;%</span> </span>
<span id="cb160-4"><a href="data-analysis.html#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(Product, P, Number, <span class="at">sep=</span><span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-5"><a href="data-analysis.html#cb160-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Judge, Product, <span class="at">Liking=</span><span class="st">`</span><span class="at">end_liking 9pt</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-6"><a href="data-analysis.html#cb160-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Liking =</span> <span class="dv">10</span><span class="sc">-</span>Liking) <span class="sc">%&gt;%</span> </span>
<span id="cb160-7"><a href="data-analysis.html#cb160-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(res_clust, <span class="at">by=</span><span class="st">&quot;Judge&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-8"><a href="data-analysis.html#cb160-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Product, Cluster) <span class="sc">%&gt;%</span> </span>
<span id="cb160-9"><a href="data-analysis.html#cb160-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Liking =</span> <span class="fu">mean</span>(Liking), <span class="at">N=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb160-10"><a href="data-analysis.html#cb160-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">str_c</span>(Cluster,<span class="st">&quot; (&quot;</span>,N,<span class="st">&quot;)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb160-11"><a href="data-analysis.html#cb160-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb160-12"><a href="data-analysis.html#cb160-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-13"><a href="data-analysis.html#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mean_cluster, <span class="fu">aes</span>(<span class="at">x=</span>Product, <span class="at">y=</span>Liking, <span class="at">colour=</span>Cluster, <span class="at">group=</span>Cluster))<span class="sc">+</span></span>
<span id="cb160-14"><a href="data-analysis.html#cb160-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb160-15"><a href="data-analysis.html#cb160-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>Cluster), <span class="at">lwd=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb160-16"><a href="data-analysis.html#cb160-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb160-17"><a href="data-analysis.html#cb160-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;Average Liking Score&quot;</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>), <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb160-18"><a href="data-analysis.html#cb160-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Cluster differences in the appreciation of the Products (using hclust)&quot;</span>)<span class="sc">+</span></span>
<span id="cb160-19"><a href="data-analysis.html#cb160-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>It appears that cluster 1 (74 consumers) particularly likes P10, P01, and eventually P05, and has a fairly flat liking pattern otherwise. On the other hand, the cluster 2 (33 consumers) expressed strong rejection towards P04 and P08, and like P10 and P01 the most.
The fact that both clusters agree on the best samples (P10 and P01) goes with our original assumption from the Internal Preference Mapping that the panel of conusmers is fairly homogeneous.</p>
<p><em>Remark</em>: In the <code>{FactoMineR}</code> package, the <code>HCPC()</code> function also performs AHC but takes as starting point the results of a multivariate analysis (HCPC stands for Hierarchical Clustering on Principal Components). Although results should be identical in most cases, it can happen that results slightly diverge from <code>agnes()</code> and <code>hclust()</code> as it also depends on the number of dimensions kept in the multivariate analysis and on the treatment of in-between clusters consumers. But more interestingly, <code>HCPC()</code> offers the possibility to <em>consolidate</em> the clusters by performing k-mean on the solution obtained from the AHC (<code>consol=TRUE</code>).</p>
</div>
<div id="drivers-of-liking" class="section level3" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> Drivers of Liking</h3>
<p>It is then relevant to understand which sensory properties of the products drivers consumer’s liking and disliking. Such evaluation can be done at the panel level, at any group level (e.g. clusters, users vs. non-users, gender, etc.), or even at the consumer level.</p>
<div id="correlation" class="section level4" number="10.4.3.1">
<h4><span class="header-section-number">10.4.3.1</span> Correlation</h4>
<p>Let’s start by evaluating the simplest relationship between the sensory attributes and overall liking by looking at the correlation. Here, we are combining the average liking score at the panel level that we link to the sensory profile of the products. The correlations are the computed using the <code>cor()</code> function:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="data-analysis.html#cb161-1" aria-hidden="true" tabindex="-1"></a>data_cor <span class="ot">&lt;-</span> mean_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="data-analysis.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>N) <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="data-analysis.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Cluster, <span class="at">values_from=</span>Liking) <span class="sc">%&gt;%</span> </span>
<span id="cb161-4"><a href="data-analysis.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(senso_mean <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Protein, Fiber)), <span class="at">by=</span><span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb161-5"><a href="data-analysis.html#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb161-6"><a href="data-analysis.html#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;Product&quot;</span>)</span>
<span id="cb161-7"><a href="data-analysis.html#cb161-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-8"><a href="data-analysis.html#cb161-8" aria-hidden="true" tabindex="-1"></a>res_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_cor)</span></code></pre></div>
<p>Various packages can be used to visualize these correlations. We opt here for the function <code>ggcorrplot()</code> from the package <code>{ggcorrplot}</code> as it provides many possibilities and generate the graphic as a ggplot object.</p>
<p>Note that this package also comes with the function <code>cor_pmat()</code> which return the matrix of p-value associated to the correlations. This matrix of p-value can be used to hide correlations that are not significant at the level defined by the parameter <code>sig.level</code></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="data-analysis.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb162-2"><a href="data-analysis.html#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="data-analysis.html#cb162-3" aria-hidden="true" tabindex="-1"></a>res_cor_pmat <span class="ot">&lt;-</span> <span class="fu">cor_pmat</span>(data_cor)</span>
<span id="cb162-4"><a href="data-analysis.html#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="data-analysis.html#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(res_cor, <span class="at">type=</span><span class="st">&quot;full&quot;</span>, <span class="at">p.mat=</span>res_cor_pmat, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">insig=</span><span class="st">&quot;blank&quot;</span>, <span class="at">lab=</span><span class="cn">TRUE</span>, <span class="at">lab_size=</span><span class="dv">2</span>)</span></code></pre></div>
<p>By looking at the correlations, the liking scores for cluster 1 (defined as <code>1 (74)</code>) are positively correlated with <code>Overall odor intensity</code>, <code>Fatty odor</code>, <code>Cereal flavor</code>, <code>Fatty flavor</code>, <code>Dairy flavor</code>, <code>Overall flavor persistence</code>, <code>Salty</code>, <code>Sweet</code>, <code>Warming</code>, <code>Fatty in mouth</code>, and <code>Melting</code>. They are also negatively correlated to <code>External color intensity</code>, <code>Astringent</code>, and <code>Dry in mouth</code>.
Finally, it can be noted that the correlation between clusters is high with a value of 0.72.</p>
</div>
<div id="linear-and-quadratic-regression" class="section level4" number="10.4.3.2">
<h4><span class="header-section-number">10.4.3.2</span> Linear and Quadratic Regression</h4>
<p>Although the correlation provides a first good idea of which attributes are linked to liking, it has two major drawbacks: 1. it only measures linear relationships, and 2. it does not allow for inference.
To overcome this particular limitations, linear and quadratic regressions can be used.</p>
<p>Let’s start by combining the sensory data to the average liking score per product. To simplify the analysis, all the sensory attributes will be structured in the long format alike previous ANOVAs that we have been performed. Also, since the quadratic term can be evaluated by adding into the model an effect in which the sensory scores have been squared up, we create a second variable called <code>Score2</code> that corresponds to <code>Score^2</code>.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="data-analysis.html#cb163-1" aria-hidden="true" tabindex="-1"></a>data_reg <span class="ot">&lt;-</span> mean_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb163-2"><a href="data-analysis.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>N) <span class="sc">%&gt;%</span> </span>
<span id="cb163-3"><a href="data-analysis.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Cluster, <span class="at">values_from=</span>Liking) <span class="sc">%&gt;%</span> </span>
<span id="cb163-4"><a href="data-analysis.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(senso_mean <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Protein, Fiber)), <span class="at">by=</span><span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb163-5"><a href="data-analysis.html#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Shiny<span class="sc">:</span>Melting, <span class="at">names_to=</span><span class="st">&quot;Attribute&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb163-6"><a href="data-analysis.html#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Attribute =</span> <span class="fu">factor</span>(Attribute, <span class="at">levels=</span><span class="fu">colnames</span>(senso_mean)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(senso_mean)])) <span class="sc">%&gt;%</span> </span>
<span id="cb163-7"><a href="data-analysis.html#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Score2 =</span> Score<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>We then run both the linear and quadratic regression simultaneously by attribute for cluster 1 (<code>1 (74)</code>):</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="data-analysis.html#cb164-1" aria-hidden="true" tabindex="-1"></a>res_reg <span class="ot">&lt;-</span> data_reg <span class="sc">%&gt;%</span> </span>
<span id="cb164-2"><a href="data-analysis.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_by</span>(Attribute) <span class="sc">%&gt;%</span> </span>
<span id="cb164-3"><a href="data-analysis.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lin_mod =</span> <span class="fu">list</span>(<span class="fu">lm</span>(<span class="st">`</span><span class="at">1 (74)</span><span class="st">`</span> <span class="sc">~</span> Score, <span class="at">data=</span>data)), <span class="at">quad_mod =</span> <span class="fu">list</span>(<span class="fu">lm</span>(<span class="st">`</span><span class="at">1 (74)</span><span class="st">`</span> <span class="sc">~</span> Score <span class="sc">+</span> Score2, <span class="at">data=</span>data)))</span></code></pre></div>
<p>We can then visualize which attributes are linked to liking by unfolding the results (using <code>broom::tidy()</code>). However, in this example, we propose to extract the attributes that are associated to a significant model at 5%, to then represent them graphically against the liking score.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="data-analysis.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb165-2"><a href="data-analysis.html#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="data-analysis.html#cb165-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data_reg <span class="sc">%&gt;%</span> </span>
<span id="cb165-4"><a href="data-analysis.html#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Attribute <span class="sc">%in%</span> <span class="fu">unique</span>(<span class="fu">c</span>(lin,quad)))</span>
<span id="cb165-5"><a href="data-analysis.html#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="data-analysis.html#cb165-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Score, <span class="at">y=</span><span class="st">`</span><span class="at">1 (74)</span><span class="st">`</span>, <span class="at">label=</span>Product))<span class="sc">+</span></span>
<span id="cb165-7"><a href="data-analysis.html#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb165-8"><a href="data-analysis.html#cb165-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>()<span class="sc">+</span></span>
<span id="cb165-9"><a href="data-analysis.html#cb165-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb165-10"><a href="data-analysis.html#cb165-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Attribute, <span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<!-- I got this error: error: Problem with `filter()` input `..1`.
i Input `..1` is `Attribute %in% unique(c(lin, quad))`.
x object 'lin' not found -->
<p>Let’s now add a regression line to the model. To do so, <code>geom_smooth()</code> is being used, in which <code>method = lm</code> as we are adding a regression line based on a linear model, and <code>formula = 'y ~ x'</code> for a linear relationship, and <code>formula = 'y ~ x + I(x^2)'</code> for a quadratic relationship.</p>
<p>Based on the attribute, let’s decide which of the regression line to add.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="data-analysis.html#cb166-1" aria-hidden="true" tabindex="-1"></a>lm.mod <span class="ot">&lt;-</span> <span class="cf">function</span>(df, quad){</span>
<span id="cb166-2"><a href="data-analysis.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(df<span class="sc">$</span>Attribute <span class="sc">%in%</span> quad, <span class="st">&quot;y~x+I(x^2)&quot;</span>, <span class="st">&quot;y~x&quot;</span>)</span>
<span id="cb166-3"><a href="data-analysis.html#cb166-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We apply this function to our data by applying to each attribute:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="data-analysis.html#cb167-1" aria-hidden="true" tabindex="-1"></a>p_smooth <span class="ot">&lt;-</span> <span class="fu">by</span>(df, df<span class="sc">$</span>Attribute, </span>
<span id="cb167-2"><a href="data-analysis.html#cb167-2" aria-hidden="true" tabindex="-1"></a>               <span class="cf">function</span>(x) <span class="fu">geom_smooth</span>(<span class="at">data=</span>x, <span class="at">method=</span>lm, <span class="at">formula=</span><span class="fu">lm.mod</span>(x, <span class="at">quad=</span>quad)))</span>
<span id="cb167-3"><a href="data-analysis.html#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="data-analysis.html#cb167-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> p_smooth</span></code></pre></div>
<p>All attributes except for <code>Astringent</code> are linearly linked to liking.
For <code>Astringent</code>, the curvature is U-shaped: this does not show an effect of saturation as it would have been represented as an inverted U-shape. Instead, we can notice that although the quadratic effect shows a better fit than the linear effect, having a linear effect would have been a good predictor as well.</p>
</div>
</div>
<div id="external-preference-mapping" class="section level3" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> External Preference Mapping</h3>
<p>Ultimately, one of the goals of combining sensory and consumer data is to find within the sensory space the area that are liked/accepted by consumers. Since this approach is based on modeling and prediction, it may also suggest area of the space with high acceptance potential which are not filled in by products yet. This would open doors to new product development.</p>
<p>To perform such analysis, the External Preference Mapping (PrefMap) could be used amongst other techniques. For more information on the principles of PrefMap, please refer to (ANALYZING SENSORY DATA WITH R or OTHER REFERENCES…).</p>
<p>To run the PrefMap analysis, the <code>carto()</code> function from the <code>{SensoMineR}</code> package is being used. This function mainly takes as parameter the sensory space to consider (stored in <code>senso_pca$ind$coord</code>, here we will consider dimension 1 and dimension 2), the table of hedonic score (<code>consumer_wider</code>), and the model to consider (here we consider the quadratic model, so we use <code>regmod=1</code>). Since <code>carto()</code> uses rownames for the analysis, the data needs to be slightly adapted.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="data-analysis.html#cb168-1" aria-hidden="true" tabindex="-1"></a>senso <span class="ot">&lt;-</span> senso_pca<span class="sc">$</span>ind<span class="sc">$</span>coord[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb168-2"><a href="data-analysis.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames=</span><span class="st">&quot;Product&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb168-3"><a href="data-analysis.html#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Product) <span class="sc">%&gt;%</span> </span>
<span id="cb168-4"><a href="data-analysis.html#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb168-5"><a href="data-analysis.html#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;Product&quot;</span>)</span>
<span id="cb168-6"><a href="data-analysis.html#cb168-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-7"><a href="data-analysis.html#cb168-7" aria-hidden="true" tabindex="-1"></a>consu <span class="ot">&lt;-</span> consumer_wide <span class="sc">%&gt;%</span> </span>
<span id="cb168-8"><a href="data-analysis.html#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb168-9"><a href="data-analysis.html#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var=</span><span class="st">&quot;Product&quot;</span>)</span>
<span id="cb168-10"><a href="data-analysis.html#cb168-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-11"><a href="data-analysis.html#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SensoMineR)</span>
<span id="cb168-12"><a href="data-analysis.html#cb168-12" aria-hidden="true" tabindex="-1"></a>PrefMap <span class="ot">&lt;-</span> <span class="fu">carto</span>(<span class="at">Mat=</span>senso, <span class="at">MatH=</span>consu, <span class="at">regmod=</span><span class="dv">1</span>, <span class="at">graph.tree=</span><span class="cn">FALSE</span>, <span class="at">graph.corr=</span><span class="cn">FALSE</span>, <span class="at">graph.carto=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>From this map, we can see that the optimal area (dark red) would be located on the positive side of dimension 1, between P01, P05, and P10 (as expected by the liking score).</p>
<p>Let’s now re-build this plot using <code>{ggplot2}</code>.
The sensory space is store in <code>senso</code>, whereas the surface response plot is stored in:
- <code>PrefMap$f1</code>: contains the coordinates on dimension 1 in which predictions have be made;
- <code>PrefMap$f2</code>: contains the coordinates on dimension 1 in which predictions have be made;
- <code>PrefMap$depasse</code>: contains the percentage of consumers that accept a product at each point of the space. This matrix is defined in such a way that <code>PrefMap$f1</code> links to the rows of the matrix, and <code>PrefMap$f2</code> links to the columns.</p>
<p>Last but not least, <code>POpt</code> (which coordinates are stored in <code>senso_pca$ind.sup$coord</code>) can be projected on that space in order to see if such sample was well optimized in terms of consumers’ liking/preference.</p>
<p>Let’s start with preparing the data:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="data-analysis.html#cb169-1" aria-hidden="true" tabindex="-1"></a>senso <span class="ot">&lt;-</span> senso <span class="sc">%&gt;%</span> </span>
<span id="cb169-2"><a href="data-analysis.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames=</span><span class="st">&quot;Product&quot;</span>)</span>
<span id="cb169-3"><a href="data-analysis.html#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="data-analysis.html#cb169-4" aria-hidden="true" tabindex="-1"></a>senso_sup <span class="ot">&lt;-</span> senso_pca<span class="sc">$</span>ind.sup<span class="sc">$</span>coord <span class="sc">%&gt;%</span> </span>
<span id="cb169-5"><a href="data-analysis.html#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames=</span><span class="st">&quot;Product&quot;</span>)</span>
<span id="cb169-6"><a href="data-analysis.html#cb169-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-7"><a href="data-analysis.html#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(PrefMap<span class="sc">$</span>nb.depasse) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">round</span>(PrefMap<span class="sc">$</span>f1,<span class="dv">2</span>), <span class="fu">round</span>(PrefMap<span class="sc">$</span>f2,<span class="dv">2</span>))</span>
<span id="cb169-8"><a href="data-analysis.html#cb169-8" aria-hidden="true" tabindex="-1"></a>PrefMap_plot <span class="ot">&lt;-</span> PrefMap<span class="sc">$</span>nb.depasse <span class="sc">%&gt;%</span> </span>
<span id="cb169-9"><a href="data-analysis.html#cb169-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames=</span><span class="st">&quot;Dim1&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb169-10"><a href="data-analysis.html#cb169-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Dim1, <span class="at">names_to=</span><span class="st">&quot;Dim2&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Acceptance (%)&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb169-11"><a href="data-analysis.html#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.numeric))</span></code></pre></div>
<p>To build the plot, we need many layers that will use different source of data (<code>senso</code>, <code>senso_sup</code>, and <code>PrefMap_plot</code> that is). Hence, the initiation of the plot through the <code>ggplot()</code> function will not specify any data. Instead, the data to use at each step are included within the <code>geom_*()</code> functions of interest. In particular, <code>geom_tile()</code> and <code>geom_contour()</code> are used to build the surface plot.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="data-analysis.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb170-2"><a href="data-analysis.html#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>PrefMap_plot, <span class="fu">aes</span>(<span class="at">x=</span>Dim1, <span class="at">y=</span>Dim2, <span class="at">fill=</span><span class="st">`</span><span class="at">Acceptance (%)</span><span class="st">`</span>, <span class="at">color=</span><span class="st">`</span><span class="at">Acceptance (%)</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb170-3"><a href="data-analysis.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data=</span>PrefMap_plot, <span class="fu">aes</span>(<span class="at">x=</span>Dim1, <span class="at">y=</span>Dim2, <span class="at">z=</span><span class="st">`</span><span class="at">Acceptance (%)</span><span class="st">`</span>), <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb170-4"><a href="data-analysis.html#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb170-5"><a href="data-analysis.html#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb170-6"><a href="data-analysis.html#cb170-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>senso, <span class="fu">aes</span>(<span class="at">x=</span>Dim<span class="fl">.1</span>, <span class="at">y=</span>Dim<span class="fl">.2</span>), <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb170-7"><a href="data-analysis.html#cb170-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>senso, <span class="fu">aes</span>(<span class="at">x=</span>Dim<span class="fl">.1</span>, <span class="at">y=</span>Dim<span class="fl">.2</span>, <span class="at">label=</span>Product))<span class="sc">+</span></span>
<span id="cb170-8"><a href="data-analysis.html#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>senso_sup, <span class="fu">aes</span>(<span class="at">x=</span>Dim<span class="fl">.1</span>, <span class="at">y=</span>Dim<span class="fl">.2</span>), <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">cex=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb170-9"><a href="data-analysis.html#cb170-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>senso_sup, <span class="fu">aes</span>(<span class="at">x=</span>Dim<span class="fl">.1</span>, <span class="at">y=</span>Dim<span class="fl">.2</span>, <span class="at">label=</span>Product), <span class="at">col=</span><span class="st">&quot;green&quot;</span>)<span class="sc">+</span></span>
<span id="cb170-10"><a href="data-analysis.html#cb170-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;blue&quot;</span>, <span class="at">mid=</span><span class="st">&quot;white&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>, <span class="at">midpoint=</span><span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb170-11"><a href="data-analysis.html#cb170-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">&quot;blue&quot;</span>, <span class="at">mid=</span><span class="st">&quot;white&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>, <span class="at">midpoint=</span><span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb170-12"><a href="data-analysis.html#cb170-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">str_c</span>(<span class="st">&quot;Dimension 1(&quot;</span>,<span class="fu">round</span>(senso_pca<span class="sc">$</span>eig[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dv">1</span>),<span class="st">&quot;%)&quot;</span>))<span class="sc">+</span></span>
<span id="cb170-13"><a href="data-analysis.html#cb170-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">str_c</span>(<span class="st">&quot;Dimension 2(&quot;</span>,<span class="fu">round</span>(senso_pca<span class="sc">$</span>eig[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dv">1</span>),<span class="st">&quot;%)&quot;</span>))<span class="sc">+</span></span>
<span id="cb170-14"><a href="data-analysis.html#cb170-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;External Preference Mapping applied on the biscuits data&quot;</span>,<span class="st">&quot;(The PrefMap is based on the quadratic model)&quot;</span>)<span class="sc">+</span></span>
<span id="cb170-15"><a href="data-analysis.html#cb170-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>As can be seen, <code>POpt</code> is not so close from the optimal area suggested by the PrefMap, hence suggesting that other prototypes that are closer to P10 should be generated.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="27">
<li id="fn27"><p>The <code>{broom}</code> package is a very useful package that convert statistical objects into tidy tables.<a href="data-analysis.html#fnref27" class="footnote-back">↩︎</a></p></li>
<li id="fn28"><p>We use the package <code>{formattable}</code> to print the results in percentage using one decimal. As an alternative, we could have used <code>percent()</code> from the <code>{scales}</code> package.<a href="data-analysis.html#fnref28" class="footnote-back">↩︎</a></p></li>
<li id="fn29"><p>Here, the histograms are ordered decreasingly (<code>reorder</code>) and are represented horizontally (<code>coord_flip()</code>).<a href="data-analysis.html#fnref29" class="footnote-back">↩︎</a></p></li>
<li id="fn30"><p>The function <code>ifelse()</code> takes three parameters: 1. the condition to test, 2. the value or code to run if the condition is met, and 3. the value or code to run if the condition is not met.<a href="data-analysis.html#fnref30" class="footnote-back">↩︎</a></p></li>
<li id="fn31"><p>We would like to remind the reader that the liking scores measured on the categorical scale was reverted since 1 defined “I like it a lot” and 9 “I dislike it a lot.” To simplify the readability, this scale is reverted so that 1 corresponds to a low liking score, and 9 to a high liking score (in practice, we will take as value 10-score given).<a href="data-analysis.html#fnref31" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-prep.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="value-delivery.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["i2ds4scc_bookdown.pdf", "i2ds4scc_bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
